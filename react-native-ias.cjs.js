function e(e){return e&&'object'==typeof e&&'default'in e?e.default:e}function t(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e)for(var r in e)t[r]=e[r];return t.default=e,t}function r(e){return"function"==typeof e}function s(e){let{storyManager:t}=e,[r,s]=pe.useState(null),[i,o]=pe.useState(!1),[n,a]=pe.useState(!1),l=pe.useRef(null),[d,c]=pe.useState(null);pe.useEffect((()=>{null===r&&null!=t&&(s(t.createWidgetStoryReader(o,a,(e=>{null==e||e.destroyRpcServer(),null==e||e.destructor(),c(null),s(null),o(!1)}))),c(!1)),!1===d&&null!==l.current&&(null==r||r.createRpcServer(l.current),c(!0))}));let[u,h]=pe.useState(!1);return Re.createElement(Re.Fragment,null,r&&i&&Re.createElement(fe.SafeAreaView,{style:{...Ue.container,backgroundColor:"#000"}},Re.createElement(fe.StatusBar,{barStyle:"light-content",backgroundColor:"#000"}),Re.createElement(fe.View,Object.assign({},null==r?void 0:r.containerOptions,{onLayout:e=>{var t;let{nativeEvent:r}=e;null!=r&&null!==(t=r.layout)&&void 0!==t&&t.width?h(!0):h(!1)}}),u&&Re.createElement(Te,Object.assign({},null==r?void 0:r.viewOptions,{ref:l})))),n&&Re.createElement(fe.View,{style:{...Ue.container,backgroundColor:"#000"}},Re.createElement(fe.ActivityIndicator,{size:"large",color:"ios"===fe.Platform.OS?"#999999":"#ffffff"})))}function i(e){let{storyManager:t}=e,[r,s]=pe.useState(null),[i,o]=pe.useState(!1),[n,a]=pe.useState(!1),l=pe.useRef(null),[d,c]=pe.useState(null);pe.useEffect((()=>{null===r&&null!=t&&(s(t.createWidgetStoryFavoriteReader(o,a,(e=>{null==e||e.destroyRpcServer(),null==e||e.destructor(),c(null),s(null),o(!1)}))),c(!1)),!1===d&&null!==l.current&&(null==r||r.createRpcServer(l.current),c(!0))}));let[u,h]=pe.useState(!1);return Re.createElement(Re.Fragment,null,r&&i&&Re.createElement(fe.SafeAreaView,{style:{...$e.container,backgroundColor:"#000"}},Re.createElement(fe.StatusBar,{barStyle:"light-content",backgroundColor:"#000"}),Re.createElement(fe.View,Object.assign({},null==r?void 0:r.containerOptions,{onLayout:e=>{var t;let{nativeEvent:r}=e;null!=r&&null!==(t=r.layout)&&void 0!==t&&t.width?h(!0):h(!1)}}),u&&Re.createElement(Te,Object.assign({},null==r?void 0:r.viewOptions,{ref:l})))),n&&Re.createElement(fe.View,{style:{...$e.container,backgroundColor:"#000"}},Re.createElement(fe.ActivityIndicator,{size:"large",color:fe.Platform.select({ios:"#999999",android:"#ffffff"})})))}function o(){}function n(){n.init.call(this)}function a(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function l(e,t,r){if(t)e.call(r);else for(var s=e.length,i=m(e,s),o=0;o<s;++o)i[o].call(r)}function d(e,t,r,s){if(t)e.call(r,s);else for(var i=e.length,o=m(e,i),n=0;n<i;++n)o[n].call(r,s)}function c(e,t,r,s,i){if(t)e.call(r,s,i);else for(var o=e.length,n=m(e,o),a=0;a<o;++a)n[a].call(r,s,i)}function u(e,t,r,s,i,o){if(t)e.call(r,s,i,o);else for(var n=e.length,a=m(e,n),l=0;l<n;++l)a[l].call(r,s,i,o)}function h(e,t,r,s){if(t)e.apply(r,s);else for(var i=e.length,o=m(e,i),n=0;n<i;++n)o[n].apply(r,s)}function p(e,t,r,s){var i,n,l,d;if('function'!=typeof r)throw new TypeError('"listener" argument must be a function');if((n=e._events)?(n.newListener&&(e.emit('newListener',t,r.listener?r.listener:r),n=e._events),l=n[t]):(n=e._events=new o,e._eventsCount=0),l){if('function'==typeof l?l=n[t]=s?[r,l]:[l,r]:s?l.unshift(r):l.push(r),!l.warned&&(i=a(e))&&i>0&&l.length>i){l.warned=!0;var c=new Error('Possible EventEmitter memory leak detected. '+l.length+' '+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name='MaxListenersExceededWarning',c.emitter=e,c.type=t,c.count=l.length,d=c,'function'==typeof console.warn?console.warn(d):console.log(d)}}else l=n[t]=r,++e._eventsCount;return e}function f(e,t,r){function s(){e.removeListener(t,s),i||(i=!0,r.apply(e,arguments))}var i=!1;return s.listener=r,s}function g(e){var t=this._events;if(t){var r=t[e];if('function'==typeof r)return 1;if(r)return r.length}return 0}function m(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function y(e,t,r,s){(dt(e)||ct(e))&&('family'in e||'graphite'in e)||lt(`${t}: expect ${r} to be a unit (store, event or effect)${s}`)}function v(e,t,r){if(Array.isArray(e))for(let s=0;s<e.length;s++)y(e[s],t,`${s} item of ${r}`,'');else y(e,t,r,' or array of units')}function S({node:e=[],from:t,source:r,parent:s=t||r,to:i,target:o,child:n=i||o,scope:a={},meta:l={},family:d={type:'regular'},regional:c}={}){let u=Kt(s),h=Kt(d.links),p=Kt(d.owners),f=[],g={};for(let t=0;t<e.length;t++){let r=e[t];r&&(f.push(r),Gt(r,g))}let m={id:gt(),seq:f,next:Kt(n),meta:l,scope:a,family:{type:d.type||"crosslink",links:h,owners:p},reg:g};for(let e=0;e<h.length;e++)Pt(h[e]).push(m);for(let e=0;e<p.length;e++)Ft(p[e]).push(m);for(let e=0;e<u.length;e++)u[e].next.push(m);return c&&Ut&&Vt(Ht(Ut),[m]),m}function w(e,t,r){let s=nr,i=null,o=sr;if(e.target&&(t=e.params,r=e.defer,s='page'in e?e.page:s,e.stack&&(i=e.stack),o=Wt(e)||o,e=e.target),o&&sr&&o!==sr&&(sr=null),Array.isArray(e))for(let r=0;r<e.length;r++)Qt('pure',s,xt(e[r]),i,t[r],o);else Qt('pure',s,xt(e),i,t,o);if(r&&!ir)return;let n,a,l,d,c,u,h={isRoot:ir,currentPage:nr,forkPage:sr,isWatch:or};ir=0;e:for(;d=Yt();){let{idx:e,stack:t,type:r}=d;l=t.node,nr=c=t.page,sr=Wt(t),u=(c||l).reg;let s={fail:0,scope:l.scope};n=a=0;for(let i=e;i<l.seq.length&&!n;i++){let o=l.seq[i],d=o.data;switch(o.type){case"barrier":{let s=d.barrierID;c&&(s=`${c.fullID}_${s}`);let o=d.priority;if(i!==e||r!==o){rr.has(s)||(rr.add(s),er(i,t,o,s));continue e}rr.delete(s);break}case'mov':{let e;switch(d.from){case"stack":e=Ht(t);break;case"a":case'b':e=t[d.from];break;case"value":e=d.store;break;case Xe:u[d.store.id]||(t.page=c=dr(c,d.store.id),u=c?c.reg:l.reg),e=Ot(u[d.store.id])}switch(d.to){case"stack":t.value=e;break;case"a":case'b':t[d.to]=e;break;case Xe:cr(c,l,d.target.id).current=e}break}case'check':switch(d.type){case'defined':a=void 0===Ht(t);break;case'changed':a=Ht(t)===Ot(cr(c,l,d.store.id))}break;case"filter":a=!ur(s,d,t);break;case'run':if(i!==e||"effect"!==r){er(i,t,"effect");continue e}case'compute':or='watch'===l.meta.op,t.value=ur(s,d,t),or=h.isWatch}n=s.fail||a}if(!n)for(let e=0;e<l.next.length;e++)Qt('child',c,l.next[e],t,Ht(t),Wt(t))}ir=h.isRoot,nr=h.currentPage,sr=Wt(h)}function L(e,t="combine"){let r=t+'(',s='',i=0;for(let t in e){let o=e[t];if(null!=o&&(r+=s,r+=et(o)?o.compositeName.fullName:o.toString()),i+=1,25===i)break;s=', '}return r+=')',r}function C(e,t){for(let r in e)t(e[r],r)}function b(e,t){let r=(e,...t)=>nr?((e,t,r,s)=>{let i=nr,o=null;if(t)for(o=nr;o&&o.template!==t;)o=jt(o);lr(o);let n=e.create(r,s);return lr(i),n})(r,s,e,t):r.create(e,t);r.graphite=S({meta:Er("event",r,t,e),regional:1}),r.create=e=>(w(sr?sr.find(r):r,e),e),r.watch=mt(kr,r),r.map=e=>{let t,s;dt(e)&&(t=e,s=e.name,e=e.fn);let i=b(pr(r,s),t);return Ar(r,i,Qe,e),i},r.filter=e=>xr(r,"filter",e.fn?e:e.fn,[Rt({fn:At})]),r.filterMap=e=>xr(r,'filterMap',e,[bt({fn:At}),Ct.defined()]),r.prepend=e=>{let t=b('* \u2192 '+r.shortName,{parent:jt(r)}),s=$t();return s&&xt(t).seq.push(s.upward),Ar(t,r,'prepend',e),Or(r,t),t};let s=$t();return r}function R(e,t){function r(e,t){l.off(e),Bt(l).set(e,Cr(Pr(e,l,'on',1,t,c)))}let s=It(e),i=It(e),o=Mr('updates'),n=$t();s.after=[{type:'copy',to:i}],n&&n.plain.push(s,i);let a=s.id,l={subscribers:new Map,updates:o,defaultState:e,stateRef:s,getState(){let e,t=s;if(nr){let t=nr;for(;t&&!t.reg[a];)t=jt(t);t&&(e=t)}return!e&&sr&&sr.reg[a]&&(e=sr),e&&(t=e.reg[a]),Ot(t)},setState(e){let t;sr&&(t=sr.nodeMap[xt(l).id]),t||(t=l),w({target:t,params:e,defer:1})},reset(...e){for(let t of e)l.on(t,(()=>l.defaultState));return l},on(e,t){if(v(e,'.on','first argument'),Array.isArray(e))for(let s of e)r(s,t);else r(e,t);return l},off(e){let t=Bt(l).get(e);return t&&(t(),Bt(l).delete(e)),l},map(e,t){let r,i,o;dt(e)&&(r=e,i=e.name,t=e.firstState,e=e.fn);let n=l.getState(),a=$t();a?o=null:void 0!==n&&(o=e(n,t));let d=R(o,{name:pr(l,i),config:r,strict:0}),c=Pr(l,d,Qe,0,e);return Tt(d).before=[{type:Qe,fn:e,from:s}],a&&(mr(a.plain,s)||mr(c.seq,a.loader)||c.seq.unshift(a.loader)),d},watch(e,t){if(!t||!et(e)){let t=kr(l,e),r=$t();return r?r.watch.push({of:s,fn:e}):e(l.getState()),t}return ct(t)||lt('second argument should be a function'),e.watch((e=>t(l.getState(),e)))}},d=Er(Xe,l,t),c=l.defaultConfig.updateFilter;return l.graphite=S({scope:{state:s},node:[Ct.defined(),Ct.changed({store:i}),c&&Lt({store:i,to:"a"}),c&&Rt({fn:(e,t,{a:r})=>c(e,r)}),_t({store:s}),_t({store:i})],child:o,meta:d,regional:1}),Ir&&void 0===e&&lt("current state can't be undefined, use null instead"),Vt(l,[o]),l}function k(e,t){let r=b(e,t),s=r.defaultConfig.handler||(()=>lt(`no handler used in ${r.getType()}`)),i=xt(r);i.meta.onCopy=['runner'],i.meta.unit=r.kind="effect",r.use=e=>(ct(e)||lt('.use argument should be a function'),s=e,r);let o=r.finally=Mr('finally'),n=r.done=o.filterMap({named:'done',fn({status:e,params:t,result:r}){if('done'===e)return{params:t,result:r}}}),a=r.fail=o.filterMap({named:'fail',fn({status:e,params:t,error:r}){if('fail'===e)return{params:t,error:r}}}),l=r.doneData=n.map({named:'doneData',fn:({result:e})=>e}),d=r.failData=a.map({named:'failData',fn:({error:e})=>e}),c=S({scope:{getHandler:r.use.getCurrent=()=>s,finally:o},node:[kt({fn({params:e,req:t},{finally:r,getHandler:s},i){let o,n=Tr({params:e,req:t,ok:1,anyway:r,stack:i}),a=Tr({params:e,req:t,ok:0,anyway:r,stack:i});try{o=s()(e)}catch(e){return void a(e)}dt(o)&&ct(o.then)?o.then(n,a):n(o)}})],meta:{op:'fx',fx:'runner',onCopy:['finally']}});i.scope.runner=c,i.seq.push(bt({fn:(e,t,r)=>jt(r)?{params:e,req:{rs(e){},rj(e){}}}:e}),kt({fn:(e,{runner:t},r)=>(w({target:t,params:e,defer:1,forkPage:Wt(r)}),e.params)})),r.create=e=>{let t=(()=>{let e={};return e.req=new Promise(((t,r)=>{e.rs=t,e.rj=r})),e.req.catch((()=>{})),e})(),s={params:e,req:t};if(sr){if(!or){let e=sr;t.req.finally((()=>{ar(e)})).catch((()=>{}))}w(sr.find(r),s)}else w(r,s);return t.req};let u=r.inFlight=R(0,{named:'inFlight'}).on(r,(e=>e+1)).on(o,(e=>e-1)),h=r.pending=u.map({fn:e=>e>0,named:'pending'});return Vt(r,[o,n,a,l,d,h,u,c]),r}function _(...e){let[[t,r],s]=gr(e),i={};return C(r,((e,r)=>{let o=i[r]=b(r,{parent:jt(t),config:s});t.on(o,e),Or(t,o)})),i}function I(e,t){let r=new Set,s=new Set,i=new Set,o=new Set,n=S({family:{type:"domain"},regional:1}),a={history:{domains:r,stores:s,effects:i,events:o},graphite:n};n.meta=Er("domain",a,t,e);let[l,d,c,u]=['onEvent','onEffect','onStore','onDomain'].map(Mr);a.hooks={event:l,effect:d,store:c,domain:u},a.onCreateEvent=Dr(l,o,a),a.onCreateEffect=Dr(d,i,a),a.onCreateStore=Dr(c,s,a),a.onCreateDomain=Dr(u,r,a),a.createEvent=a.event=(e,t)=>l(b(e,{parent:a,config:t})),a.createEffect=a.effect=(e,t)=>d(k(e,{parent:a,config:t})),a.createDomain=a.domain=(e,t)=>I({name:e,parent:a,config:t}),a.createStore=a.store=(e,t)=>c(R(e,{parent:a,config:t}));let h=jt(a);return h&&(C(a.hooks,((e,t)=>{Rr({from:e,to:h.hooks[t]})})),h.hooks.domain(a)),a}function O(e,t){let r=b(t||L(e,'merge'));return v(e,'merge','first argument'),Rr({from:e,to:r,meta:{op:'merge'}}),r}function E(e){return Array.isArray(e)}function M(e){let t=typeof e;return null!=e&&('object'===t||'function'===t)}function A(){if(!Yr&&!(Yr='undefined'!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||'undefined'!=typeof msCrypto&&'function'==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');return Yr(Qr)}function x(e){return'string'==typeof e&&es.test(e)}function P(e,t,r){var s=(e=e||{}).random||(e.rng||A)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=s[i];return t}return function(e,t){var r=arguments.length>1&&void 0!==t?t:0,s=(ts[e[r+0]]+ts[e[r+1]]+ts[e[r+2]]+ts[e[r+3]]+'-'+ts[e[r+4]]+ts[e[r+5]]+'-'+ts[e[r+6]]+ts[e[r+7]]+'-'+ts[e[r+8]]+ts[e[r+9]]+'-'+ts[e[r+10]]+ts[e[r+11]]+ts[e[r+12]]+ts[e[r+13]]+ts[e[r+14]]+ts[e[r+15]]).toLowerCase();if(!x(s))throw TypeError('Stringified UUID is invalid');return s}(s)}function F(e,t){return{...e,...t}}function T(e){return e.replace(/^\//,"")}function N(e){let t=e.length;for(let r=e.length-1;r>=0;r--){let s=e.charCodeAt(r);s>127&&s<=2047?t++:s>2047&&s<=65535&&(t+=2),s>=56320&&s<=57343&&r--}return t}function D(e){return[Object,Array].includes((e||{}).constructor)&&!Object.entries(e||{}).length}function H(e){return null!=e&&"string"==typeof e.valueOf()}function B(e){return'number'==typeof e}async function j(){let[e,t]=await Promise.all([fs(),gs()]);return{method:"post",url:"session/open",params:{expand:"cache"},data:ps(e,t)}}function W(e,t,r){void 0===t&&(t=!1);let s={url:`story/${e}`,method:"GET",params:{expand:['slides_html','slides_duration','slides_screenshot_share'].join(',')}};return t||s.params&&(s.params.fields=['id','slides_html','slides_duration','slides_screenshot_share'].join(',')),null!==r&&s.params&&(s.params.session_id=r),s}function V(e,t){let r={url:"story-context",method:"get",params:{id:e.join(',')}};return null!=t&&r.params&&(r.params.session_id=t),r}function U(e,t,r){return String(e).replace(new RegExp((e=>e.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'))(t),'g'),(()=>r))}function $(e,t){let r=new Blob([e],{type:t});return URL.createObjectURL(r)}function q(e,t){return((e,t)=>new ki(e,t))({fxSenderDomain:e.clientFxDomain,fxReceiverDomain:e.serverFxDomain},t)}function K(e){return e&&e.__esModule&&{}.hasOwnProperty.call(e,'default')?e.default:e}function G(e,t,r){var s=(void 0===r?{}:r).last,i=void 0!==s&&s;if('string'!=typeof e)throw new TypeError('expected a string');if(!Array.isArray(t))throw new TypeError('expected a string array of separators');if('boolean'!=typeof i)throw new TypeError('expected a Boolean value for options.last');for(var o=[],n='',a=!1,l=0,d=!1,c=!1,u=0,h=e;u<h.length;u++){var p=h[u];d?c?c=!1:'\\'===p?c=!0:p===d&&(d=!1):'"'===p||'\''===p?d=p:'('===p?l+=1:')'===p?l>0&&(l-=1):0===l&&-1!==t.indexOf(p)&&(a=!0),a?(''!==n&&o.push(n.trim()),n='',a=!1):n+=p}return(i||''!==n)&&o.push(n.trim()),o}function J(e){return!/^(-?\d|--)/.test(e)}function z(e){const t=[];let r="",s="",i=7;for(let o,n=0;o=e.charAt(n);n++)if(/[a-zA-Z\d\xa0-\uffff_-]/.test(o)&&7===i)r+=o;else if("\\"===o&&7===i)i=6;else if(" "===o&&7===i){if(""!==r){if(!J(r))return null;t.push(r),r=""}}else if(6===i)/[0-9a-f]/i.test(o)?(s+=o,i=8):(r+=o,i=7);else{if(8!==i)return null;/[0-9a-f]/i.test(o)&&s.length<6?s+=o:(r+=String.fromCodePoint(parseInt(s,16)),r+=o,s="",i=7)}if(""!==r){if(!J(r))return null;t.push(r)}return t.join(" ")}function Z(e,t){let r=t,s="";const i={"font-family":[]};for(let t,o=0;t=e.charAt(o);o+=1)if(4!==r||'"'!==t&&"'"!==t)if(3===r&&","===t)r=4,s="";else if(4===r&&","===t){const e=z(s);e&&i["font-family"].push(e),s=""}else if(5===r&&" "===t)/^(?:\+|-)?(?:[0-9]*\.)?[0-9]+(?:deg|grad|rad|turn)$/.test(s)?(i["font-style"]+=" "+s,s=""):o-=1,r=1;else if(1!==r||" "!==t&&"/"!==t)2===r&&" "===t?(/^(?:\+|-)?([0-9]*\.)?[0-9]+(?:em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)?$/.test(s)&&(i["line-height"]=s),r=4,s=""):s+=t;else{if(/^(?:(?:xx|x)-large|(?:xx|s)-small|small|large|medium)$/.test(s)||/^(?:larg|small)er$/.test(s)||/^(?:\+|-)?(?:[0-9]*\.)?[0-9]+(?:em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)$/.test(s))r="/"===t?2:4,i["font-size"]=s;else if(/^italic$/.test(s))i["font-style"]=s;else if(/^oblique$/.test(s))i["font-style"]=s,r=5;else if(/^small-caps$/.test(s))i["font-variant"]=s;else if(/^(?:bold(?:er)?|lighter|normal)$/.test(s))i["font-weight"]=s;else if(/^[+-]?(?:[0-9]*\.)?[0-9]+(?:e[+-]?(?:0|[1-9][0-9]*))?$/.test(s)){const e=parseFloat(s);e>=1&&e<=1e3&&(i["font-weight"]=s)}else/^(?:(?:ultra|extra|semi)-)?(?:condensed|expanded)$/.test(s)&&(i["font-stretch"]=s);s=""}else{let n=o+1;do{if(n=e.indexOf(t,n)+1,!n)return null}while("\\"===e.charAt(n-2));i["font-family"].push(e.slice(o+1,n-1).replace(/\\('|")/g,"$1")),o=n-1,r=3,s=""}if(3===r&&!/^\s*$/.test(s))return null;if(4===r){const e=z(s);e&&i["font-family"].push(e)}return i}function X(){Oo&&Mo.setAdjustNothing()}function Y(){Oo&&Mo.setAdjustPan()}function Q(){Oo&&Mo.setAdjustResize()}function ee(){Oo&&Mo.setAdjustUnspecified()}function te(){Oo&&Mo.setAlwaysHidden()}function re(){Oo&&Mo.setAlwaysVisible()}function se(){Oo&&Mo.setVisible()}function ie(){Oo&&Mo.setHidden()}function oe(){Oo&&Mo.setUnchanged()}function ne(e){Oo&&Mo.getSoftInputMode(e)}function ae(e){Oo&&Mo.setSoftInputMode(e)}function le(e,t){return!1!==t.clone&&t.isMergeableObject(e)?he(Array.isArray(e)?[]:{},e,t):e}function de(e,t,r){return e.concat(t).map((e=>le(e,r)))}function ce(e){return Object.keys(e).concat((e=>Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((t=>e.propertyIsEnumerable(t))):[])(e))}function ue(e,t){try{return t in e}catch(e){return!1}}function he(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||de,r.isMergeableObject=r.isMergeableObject||Ho,r.cloneUnlessOtherwiseSpecified=le;var s=Array.isArray(t);return s===Array.isArray(e)?s?r.arrayMerge(e,t,r):((e,t,r)=>{var s={};return r.isMergeableObject(e)&&ce(e).forEach((t=>{s[t]=le(e[t],r)})),ce(t).forEach((i=>{((e,t)=>ue(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t)))(e,i)||(s[i]=ue(e,i)&&r.isMergeableObject(t[i])?((e,t)=>{if(!t.customMerge)return he;var r=t.customMerge(e);return'function'==typeof r?r:he})(i,r)(e[i],t[i],r):le(t[i],r))})),s})(e,t,r):le(t,r)}Object.defineProperty(exports,'__esModule',{value:!0}),require('react-native-get-random-values');var pe=require('react'),fe=require('react-native'),ge=require('react-native-webview'),me=require('./StoriesListClient.js'),ye=require('./StoriesListClient.css.js'),ve=require('react-native-device-info'),Se=require('@react-native-async-storage/async-storage'),we=require('./StoryReaderClient.js'),Le=require('./StoryReaderClient.css.js'),Ce=require('./StoryFavoriteReaderClient.js'),be=require('./StoryFavoriteReaderClient.css.js'),Re=e(pe),ke=t(pe),_e=e(me),Ie=e(ye),Oe=t(ve),Ee=e(Se),Me=e(we),Ae=e(Le),xe=e(Ce),Pe=e(be);const Fe='android'===fe.Platform.OS;let Te=Re.forwardRef(((e,t)=>{let{style:r,...s}=e;return Re.createElement(ge.WebView,Object.assign({nativeConfig:{props:{webContentsDebuggingEnabled:!0,allowsInlineMediaPlayback:!0}},scalesPageToFit:!1,originWhitelist:["*"],automaticallyAdjustContentInsets:!1,keyboardDisplayRequiresUserAction:!1},s,{style:Fe?[r,Ne.opacityHack]:r,ref:t,forceDarkOn:!1,mediaPlaybackRequiresUserAction:!1}))}));const Ne=fe.StyleSheet.create({opacityHack:{opacity:.99}});var De;let He;var Be,je;let We;exports.StoriesListSliderAlign=void 0,(De=exports.StoriesListSliderAlign||(exports.StoriesListSliderAlign={})).CENTER="center",De.LEFT="left",De.RIGHT="right",(e=>{e.CIRCLE="circle",e.QUAD="quad",e.RECTANGLE="rectangle"})(He||(He={})),exports.StoriesListCardTitleTextAlign=void 0,(Be=exports.StoriesListCardTitleTextAlign||(exports.StoriesListCardTitleTextAlign={})).LEFT="left",Be.CENTER="center",Be.RIGHT="right",exports.StoriesListCardTitlePosition=void 0,(je=exports.StoriesListCardTitlePosition||(exports.StoriesListCardTitlePosition={})).CARD_INSIDE_BOTTOM="cardInsideBottom",je.CARD_OUTSIDE_TOP="cardOutsideTop",je.CARD_OUTSIDE_BOTTOM="cardOutsideBottom",(e=>{e.START_LOADER="startLoader",e.END_LOADER="endLoader"})(We||(We={})),exports,exports,exports,exports,exports,exports.StoriesListCardViewVariant=void 0,(e=>{e.CIRCLE="circle",e.QUAD="quad",e.RECTANGLE="rectangle"})(exports.StoriesListCardViewVariant||(exports.StoriesListCardViewVariant={})),exports.StoriesListEvents=void 0,(e=>{e.START_LOADER="startLoad",e.END_LOADER="endLoad"})(exports.StoriesListEvents||(exports.StoriesListEvents={}));const Ve={title:{content:'',color:'#ffffff',font:'normal',marginBottom:20},card:{title:{font:'normal',color:'#ffffff',padding:15,textAlign:exports.StoriesListCardTitleTextAlign.LEFT,position:exports.StoriesListCardTitlePosition.CARD_INSIDE_BOTTOM,display:!0,lineClamp:3},gap:10,height:70,variant:exports.StoriesListCardViewVariant.CIRCLE,border:{radius:0,color:'black',width:2,gap:3},boxShadow:null,dropShadow:null,opacity:null,mask:{color:null},svgMask:null,opened:{border:{radius:null,color:null,width:null,gap:null},boxShadow:null,dropShadow:null,opacity:null,mask:{color:null},svgMask:null}},favoriteCard:{title:{content:'Favorite',font:'normal',color:'#000',padding:15,textAlign:exports.StoriesListCardTitleTextAlign.LEFT,position:exports.StoriesListCardTitlePosition.CARD_INSIDE_BOTTOM,display:!0,lineClamp:3},gap:10,height:70,variant:exports.StoriesListCardViewVariant.CIRCLE,border:{radius:0,color:'black',width:2,gap:3},boxShadow:null,dropShadow:null,opacity:null,mask:{color:null},svgMask:null,opened:{border:{radius:null,color:null,width:null,gap:null},boxShadow:null,dropShadow:null,opacity:null,mask:{color:null},svgMask:null}},sidePadding:20,topPadding:20,bottomPadding:20,bottomMargin:17,layout:{height:0,storiesListInnerHeight:null,backgroundColor:'transparent',sliderAlign:exports.StoriesListSliderAlign.LEFT},navigation:{showControls:!1,controlsSize:48,controlsBackgroundColor:'white',controlsColor:'black'}},Ue=fe.StyleSheet.create({container:{flex:1,justifyContent:"center",alignItems:"center",position:"absolute",width:"100%",height:"100%"}}),$e=fe.StyleSheet.create({container:{flex:1,justifyContent:"center",alignItems:"center",position:"absolute",width:"100%",height:"100%"}});let qe,Ke,Ge,Je,ze;o.prototype=Object.create(null),n.EventEmitter=n,n.usingDomains=!1,n.prototype.domain=void 0,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.init=function(){this.domain=null,n.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new o,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if('number'!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return a(this)},n.prototype.emit=function(e,t,r,s){var i,o,n,a,p,f,g,m='error'===e;if(f=this._events)m=m&&null==f.error;else if(!m)return!1;if(g=this.domain,m){if(i=t,!g){if(i instanceof Error)throw i;var y=new Error('Uncaught, unspecified "error" event. ('+i+')');throw y.context=i,y}return i||(i=new Error('Uncaught, unspecified "error" event')),i.domainEmitter=this,i.domain=g,i.domainThrown=!1,g.emit('error',i),!1}if(!(o=f[e]))return!1;var v='function'==typeof o;switch(n=arguments.length){case 1:l(o,v,this);break;case 2:d(o,v,this,t);break;case 3:c(o,v,this,t,r);break;case 4:u(o,v,this,t,r,s);break;default:for(a=new Array(n-1),p=1;p<n;p++)a[p-1]=arguments[p];h(o,v,this,a)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){return p(this,e,t,!1)},n.prototype.prependListener=function(e,t){return p(this,e,t,!0)},n.prototype.once=function(e,t){if('function'!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,f(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if('function'!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,f(this,e,t)),this},n.prototype.removeListener=function(e,t){var r,s,i,n,a;if('function'!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(s=this._events))return this;if(!(r=s[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new o:(delete s[e],s.removeListener&&this.emit('removeListener',e,r.listener||t));else if('function'!=typeof r){for(i=-1,n=r.length;n-- >0;)if(r[n]===t||r[n].listener&&r[n].listener===t){a=r[n].listener,i=n;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new o,this;delete s[e]}else((e,t)=>{for(var r=t,s=r+1,i=e.length;s<i;r+=1,s+=1)e[r]=e[s];e.pop()})(r,i);s.removeListener&&this.emit('removeListener',e,a||t)}return this},n.prototype.off=function(e,t){return this.removeListener(e,t)},n.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new o,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new o:delete r[e]),this;if(0===arguments.length){for(var s,i=Object.keys(r),n=0;n<i.length;++n)'removeListener'!==(s=i[n])&&this.removeAllListeners(s);return this.removeAllListeners('removeListener'),this._events=new o,this._eventsCount=0,this}if('function'==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},n.prototype.listeners=function(e){var t,r,s=this._events;return r=s&&(t=s[e])?'function'==typeof t?[t.listener||t]:(e=>{for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t})(t):[],r},n.listenerCount=(e,t)=>'function'==typeof e.listenerCount?e.listenerCount(t):g.call(e,t),n.prototype.listenerCount=g,n.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]},(e=>{e.direct="direct",e.onboarding="onboarding",e.list="list",e.favorite="favorite"})(qe||(qe={})),(e=>{e[e.default=0]="default",e[e.favorite=1]="favorite"})(Ke||(Ke={})),(e=>{e[e.default=0]="default",e[e.onboarding=1]="onboarding",e[e.favorite=2]="favorite",e[e.direct=3]="direct"})(Ge||(Ge={})),(e=>{e.list="list",e.favorite="favorite"})(Je||(Je={})),(e=>{e.CLICK_ON_STORY="clickOnStoryLink"})(ze||(ze={}));let Ze='undefined'!=typeof Symbol&&Symbol.observable||'@@observable',Xe='store',Ye='effect',Qe='map',et=e=>(ct(e)||dt(e))&&'kind'in e;const tt=e=>t=>et(t)&&t.kind===e;let rt=tt(Xe),st=tt("event"),ot=tt(Ye),nt=tt("domain");var at={__proto__:null,unit:et,store:rt,event:st,effect:ot,domain:nt};let lt=e=>{throw Error(e)},dt=e=>'object'==typeof e&&null!==e,ct=e=>'function'==typeof e,ut=e=>{dt(e)||ct(e)||lt('expect first argument be an object')};const ht=()=>{let e=0;return()=>(++e).toString(36)};let pt=ht(),ft=ht(),gt=ht(),mt=(e,t)=>e.bind(null,t),yt=(e,t,r)=>e.bind(null,t,r);const vt=(e,t,r)=>({id:ft(),type:e,data:r,hasRef:t});let St=0,wt=({priority:e="barrier"})=>vt("barrier",0,{barrierID:++St,priority:e}),Lt=({from:e=Xe,store:t,target:r,to:s=(r?Xe:"stack")})=>vt('mov',e===Xe,{from:e,store:t,to:s,target:r}),Ct={defined:()=>vt('check',0,{type:'defined'}),changed:({store:e})=>vt('check',1,{type:'changed',store:e})},bt=yt(vt,'compute',0),Rt=yt(vt,"filter",0),kt=yt(vt,'run',0),_t=({store:e})=>Lt({from:"stack",target:e}),It=e=>({id:ft(),current:e}),Ot=({current:e})=>e,Et=(e,{fn:t},{a:r})=>t(e,r),Mt=(e,{fn:t},{a:r})=>t(r,e),At=(e,{fn:t})=>t(e),xt=e=>e.graphite||e,Pt=e=>e.family.owners,Ft=e=>e.family.links,Tt=e=>e.stateRef,Nt=e=>e.config,Dt=e=>e.\u0254,Ht=e=>e.value,Bt=e=>e.subscribers,jt=e=>e.parent,Wt=e=>e.forkPage,Vt=(e,t)=>{let r=xt(e);for(let e=0;e<t.length;e++){let s=xt(t[e]);"domain"!==r.family.type&&(s.family.type="crosslink"),Pt(s).push(r),Ft(r).push(s)}},Ut=null,$t=()=>Ut,qt=e=>(e&&Ut&&Ut.sidRoot&&(e=`${Ut.sidRoot}\u0254${e}`),e);const Kt=(e=[])=>{let t=[];if(Array.isArray(e))for(let r=0;r<e.length;r++)Array.isArray(e[r])?t.push(...e[r]):t.push(e[r]);else t.push(e);return t.map(xt)};let Gt=({hasRef:e,type:t,data:r},s)=>{let i;e&&(i=r.store,s[i.id]=i),'mov'===t&&r.to===Xe&&(i=r.target,s[i.id]=i)},Jt=null;const zt=(e,t)=>{if(!e)return t;if(!t)return e;let r,s=e.v.type===t.v.type;return(s&&e.v.id>t.v.id||!s&&"sampler"===e.v.type)&&(r=e,e=t,t=r),r=zt(e.r,t),e.r=e.l,e.l=r,e},Zt=[];let Xt=0;for(;Xt<5;)Zt.push({first:null,last:null,size:0}),Xt+=1;const Yt=()=>{for(let e=0;e<5;e++){let t=Zt[e];if(t.size>0){if(2===e||3===e){t.size-=1;let e=Jt.v;return Jt=zt(Jt.l,Jt.r),e}1===t.size&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},Qt=(e,t,r,s,i,o)=>er(0,{a:null,b:null,node:r,parent:s,value:i,page:t,forkPage:o},e),er=(e,t,r,s=0)=>{let i=tr(r),o=Zt[i],n={v:{idx:e,stack:t,type:r,id:s},l:0,r:0};2===i||3===i?Jt=zt(Jt,n):(0===o.size?o.first=n:o.last.r=n,o.last=n),o.size+=1},tr=e=>{switch(e){case'child':return 0;case'pure':return 1;case"barrier":return 2;case"sampler":return 3;case Ye:return 4;default:return-1}},rr=new Set;let sr,ir=1,or=0,nr=null,ar=e=>{sr=e},lr=e=>{nr=e};const dr=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=jt(e);if(e)return e}return null},cr=(e,t,r)=>(dr(e,r)||t).reg[r],ur=(e,{fn:t},r)=>{try{return t(Ht(r),e.scope,r)}catch(t){console.error(t),e.fail=1}};let hr=(e,t)=>''+e.shortName+t,pr=(e,t)=>null==t?hr(e,' \u2192 *'):t,fr=(e,t)=>{ut(e),Dt(e)&&t(Nt(e),Dt(e))},gr=e=>{let t;return fr(e[0],((r,s)=>{t=r,e=s})),[e,t]},mr=(e,t)=>e.includes(t),yr=(e,t)=>{let r=e.indexOf(t);-1!==r&&e.splice(r,1)};const vr=(e,t)=>{yr(e.next,t),yr(Pt(e),t),yr(Ft(e),t)},Sr=(e,t,r)=>{let s;e.next.length=0,e.seq.length=0,e.scope=null;let i=Ft(e);for(;s=i.pop();)vr(s,e),(t||r&&!e.meta.sample||"crosslink"===s.family.type)&&Sr(s,t,'on'!==s.meta.op&&r);for(i=Pt(e);s=i.pop();)vr(s,e),r&&"crosslink"===s.family.type&&Sr(s,t,'on'!==s.meta.op&&r)},wr=e=>e.clear();let Lr=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),rt(e))wr(Bt(e));else if(nt(e)){r=1;let t=e.history;wr(t.events),wr(t.effects),wr(t.stores),wr(t.domains)}Sr(xt(e),!!t,r)},Cr=e=>{let t=yt(Lr,e,void 0);return t.unsubscribe=t,t},br=(e,t,{node:r,scope:s,meta:i})=>S({node:r,parent:e,child:t,scope:s,meta:i,family:{owners:[e,t],links:t},regional:1}),Rr=e=>{let t;fr(e,((r,s)=>{t=r,e=s}));let{from:r,to:s,meta:i={op:'forward'}}=e;return v(r,'forward','"from"'),v(s,'forward','"to"'),t&&(i.config=t),Cr(S({parent:r,child:s,meta:i,family:{},regional:1}))},kr=(e,t)=>{if(ct(t)||lt('.watch argument should be a function'),sr){let t=sr.nodeMap[xt(e).id];t&&(e=t)}return Cr(S({scope:{fn:t},node:[kt({fn:At})],parent:e,meta:{op:'watch'},family:{owners:e},regional:1}))};const _r=(e,t)=>(dt(e)&&(_r(Nt(e),t),null!=e.name&&(dt(e.name)?_r(e.name,t):ct(e.name)?t.handler=e.name:t.name=e.name),e.loc&&(t.loc=e.loc),(e.sid||null===e.sid)&&(t.sid=e.sid),e.handler&&(t.handler=e.handler),e.updateFilter&&(t.updateFilter=e.updateFilter),jt(e)&&(t.parent=jt(e)),'strict'in e&&(t.strict=e.strict),e.named&&(t.named=e.named),_r(Dt(e),t)),t);let Ir,Or=(e,t,r="event")=>{jt(e)&&jt(e).hooks[r](t)},Er=(e,t,r,s)=>{let i=_r({name:s,config:r},{}),o="domain"===e,n=pt(),{parent:a=null,sid:l=null,strict:d=1,named:c=null}=i,u=c||i.name||(o?'':n),h=((e,t)=>{let r,s,i,o=e;return t?(i=t.compositeName,0===e.length?(r=i.path,s=i.fullName):(r=i.path.concat([e]),s=0===i.fullName.length?e:i.fullName+'/'+e)):(r=0===e.length?[]:[e],s=e),{shortName:o,fullName:s,path:r}})(u,a),p={unit:t.kind=e,name:t.shortName=u,sid:t.sid=qt(l),named:c,unitId:t.id=n};return t.parent=a,t.compositeName=h,t.defaultConfig=i,t.thru=e=>e(t),t.getType=()=>h.fullName,o||(t.subscribe=e=>(ut(e),t.watch(ct(e)?e:t=>{e.next&&e.next(t)})),t[Ze]=()=>t),Ir=d,p},Mr=e=>b({named:e});const Ar=(e,t,r,s)=>br(e,t,{scope:{fn:s},node:[bt({fn:At})],meta:{op:r}}),xr=(e,t,r,s)=>{let i;dt(r)&&(i=r,r=r.fn);let o=b(hr(e,' \u2192? *'),i);return br(e,o,{scope:{fn:r},node:s,meta:{op:t}}),o},Pr=(e,t,r,s,i,o)=>{let n=Tt(t),a=[Lt({store:n,to:"a"}),bt({fn:s?Mt:Et}),Ct.defined(),Ct.changed({store:n}),o&&Rt({fn:(e,t,{a:r})=>o(e,r)}),_t({store:n})];return br(e,t,{scope:{fn:i},node:a,meta:{op:r}})},Fr=(e,t,r,s)=>{let i=e?e=>e.slice():e=>({...e}),o=e?[]:{},n=i(o),a=It(n),l=It(1);a.type=e?'list':'shape';let d=R(n,{name:r||L(t)});xt(d).meta.isCombine=1;let c=[Ct.defined(),Lt({store:a,to:"a"}),Rt({fn:(e,{key:t},{a:r})=>e!==r[t]}),Lt({store:l,to:'b'}),bt({fn(e,{clone:t,key:r},s){s.b&&(s.a=t(s.a)),s.a[r]=e}}),Lt({from:"a",target:a}),Lt({from:"value",store:0,target:l}),wt({priority:"barrier"}),Lt({from:"value",store:1,target:l}),Lt({store:a}),s&&bt({fn:s}),Ct.changed({store:Tt(d)})],u=a.before=[];return C(t,((e,t)=>{if(!rt(e))return void(n[t]=o[t]=e);o[t]=e.defaultState,n[t]=e.getState(),br(e,d,{scope:{key:t,clone:i},node:c,meta:{op:'combine'}});let r=Tt(e);u.push({type:'field',field:t,from:r})})),d.defaultShape=t,a.after=[s?{type:Qe,to:Tt(d),fn:s}:{type:'copy',to:Tt(d)}],d.defaultState=s?Tt(d).current=s(n):o,d};let Tr=({params:e,req:t,ok:r,anyway:s,stack:i})=>o=>w({target:[s,Nr],params:[r?{status:'done',params:e,result:o}:{status:'fail',params:e,error:o},{fn:r?t.rs:t.rj,value:o}],defer:1,page:i.page,forkPage:Wt(i)}),Nr=S({node:[kt({fn({fn:e,value:t}){e(t)}})],meta:{op:'fx',fx:'sidechain'}});const Dr=(e,t,r)=>(e.create=t=>(w(e,t),t),xt(e).seq.push(bt({fn:(e,t,r)=>(r.forkPage=null,e)})),e.watch((e=>{Vt(r,[e]),t.add(e),e.ownerSet||(e.ownerSet=t),jt(e)||(e.parent=r)})),Vt(r,[e]),r=>(t.forEach(r),e.watch(r))),Hr=['source','clock','target'],Br=R({apiKey:""}),jr=b();Br.on(jr,((e,t)=>t));const Wr=b();Br.on(Wr,((e,t)=>{let{tags:r}=t;return{...e,tags:r}}));const Vr=b();Br.on(Vr,((e,t)=>{let{userId:r}=t;return{...e,userId:r}}));const Ur=b();Br.on(Ur,((e,t)=>{let{placeholders:r}=t;return{...e,placeholders:r}}));const $r=b();Br.on($r,((e,t)=>{let{lang:r}=t;return{...e,lang:r}}));const qr=b();Br.on(qr,((e,t)=>{let{isSandbox:r}=t;return{...e,isSandbox:Boolean(r)}}));const Kr=b();Br.on(Kr,((e,t)=>{let{apiKey:r}=t;return{...e,apiKey:r}}));const Gr=R(''),Jr=b();Rr({from:Jr,to:Gr});const zr=R({default:{},user:{}}),{sdkPlaceholdersChanged:Zr,addDefaultPlaceholders:Xr}=_(zr,{sdkPlaceholdersChanged:(e,t)=>({default:e.default,user:t}),addDefaultPlaceholders:(e,t)=>{let r={default:{},user:e.user};return E(t)&&t.forEach((e=>{M(e)&&void 0!==e.name&&void 0!==e.default_value&&(r.default[e.name]=e.default_value)})),r}});for(var Yr,Qr=new Uint8Array(16),es=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,ts=[],rs=0;rs<256;++rs)ts.push((rs+256).toString(16).substr(1));let ss=e=>null==e;class is{static createFunctionWithTimeout(e,t){function r(){s||(s=!0,e())}let s=!1;return setTimeout(r,t||1e3),r}static convertModelToFormData(e,t,r){t instanceof Object&&Object.keys(t).forEach((s=>{let i=t[s];if(i instanceof Object&&!Array.isArray(i))return this.convertModelToFormData(e,i,s);r&&(s=`${r}[${s}]`),Array.isArray(i)?i.forEach((t=>{e.append(`${s}[]`,t)})):e.append(s,i)}))}}const os={baseUrl:process.env.BASE_URL,apiUrl:"https://api.inappstory.ru",faviconApiUrl:"https://favicon.inappstory.ru"};class ns{constructor(){return this._sdkConfigIsIncorrect=!1,this._userIdByteLimit=255,this._tagsByteLimit=4e3,this.userMessage="",this.tagsMessage="",ns.instance||(ns.instance=this),ns.instance}static getInstance(){return ns.instance?ns.instance:new ns}get sdkConfigIsIncorrect(){return this._sdkConfigIsIncorrect}get sdkConfigErrorsAsArray(){let e=[];return this.userMessage&&e.push(this.userMessage),this.tagsMessage&&e.push(this.tagsMessage),e}checkUserIdLength(e){this.userMessage="",null!=e&&N(String(e))>this._userIdByteLimit&&(console.error(`UserId is bigger then ${this._userIdByteLimit} bytes`),this._sdkConfigIsIncorrect=!0,this.userMessage=`UserId "${String(e)}" is bigger then ${this._userIdByteLimit} bytes`)}checkTagsLength(e){this.tagsMessage="",null!=e&&Array.isArray(e)&&N(e.join(","))>this._tagsByteLimit&&(console.error(`Tags (joined by ',') is bigger then ${this._tagsByteLimit} bytes`),this._sdkConfigIsIncorrect=!0,this.tagsMessage=`Tags (joined by ',') "${e.join(",")}" is bigger then ${this._tagsByteLimit} bytes`)}}ns.instance=void 0;const as=new class{constructor(){this._deviceInfoPromise=null,this._baseHeaders={},this._userInfo={deviceId:null,userId:null},this.requestInterceptors=[],this.interceptors={request:{use:e=>{this.requestInterceptors.push(e)}}}}set deviceInfoPromise(e){this._deviceInfoPromise=e}set baseHeaders(e){this._baseHeaders=e}set deviceId(e){this._userInfo.deviceId=e}set userId(e){let t=null;D(e)||!H(e)&&!B(e)||(t=String(e),0==t.length&&(t=null)),this._userInfo.userId=t}get userKey(){return this._userInfo.userId?this._userInfo.userId:this._userInfo.deviceId?this._userInfo.deviceId:"default"}get baseURL(){return`${os.apiUrl}/v2/`}async request(e){return new Promise(((t,r)=>{this._deviceInfoPromise?this._deviceInfoPromise.finally((async()=>{try{if(M(e.headers)&&null!=e.headers||(e.headers={}),e.headers=F(this._baseHeaders,e.headers),this.requestInterceptors.length)for(let t of this.requestInterceptors)t(e);let r="";!ss(e.params)&&M(e.params)&&(r=new URLSearchParams(Object.entries(e.params)).toString());let s=new URL(`${T(e.url)}${r?"?"+r:""}`,this.baseURL),i="get";ss(e.method)||(i=e.method);let o={};!ss(e.headers)&&M(e.headers)&&(o=e.headers);let n=null;!ss(e.data)&&M(e.data)&&(n=JSON.stringify(e.data),o["Content-Type"]="application/json");try{if(ns.getInstance().sdkConfigIsIncorrect)return void t({data:{name:"SDK config is incorrect",message:ns.getInstance().sdkConfigErrorsAsArray.join(". "),status:400},headersRaw:{},headers:{},status:400,statusText:"SDK config is incorrect",ok:!1})}catch(e){console.error(e)}let a=await fetch(s.toString(),{method:i,body:n,headers:o,credentials:"omit"}),l=await a.json();t({data:l,headersRaw:a.headers,headers:Object.fromEntries([...a.headers]),status:a.status,statusText:a.statusText,ok:a.ok})}catch(e){r(e)}})):r(new Error("Invalid device info Promise"))}))}async post(e,t){return this.request({method:"post",url:e,data:t})}async get(e,t){return this.request({method:"get",url:e,params:t})}};as.interceptors.request.use((e=>{var t,r;return e.headers=F(e.headers,{Authorization:`Bearer ${Br.getState().apiKey}`,"Accept-Language":Br.getState().lang||"en","Auth-Session-Id":null===(t=ls.getState())||void 0===t||null===(r=t.session)||void 0===r?void 0:r.id,"X-User-Id":Br.getState().userId?Br.getState().userId:"","X-Request-Id":P()}),e}));const ls=R({session:{id:'',expire_in:0},server_timestamp:0,content_base_url:'',user_key:'',share:!1,is_allow_profiling:!1,cache:[],placeholders:[]}),ds=k();ls.on(ds.doneData,((e,t)=>t));const cs=b();ls.on(cs,(e=>({...e,session:{id:'',expire_in:0}})));const us=b(),hs=k((e=>{as.post('session/update',e)})).prepend((e=>({data:[[5,0,...e]]})));ds.use((async()=>{let[e,t]=await Promise.all([fs(),gs()]);return(await as.post('session/open?expand=cache',ps(e,t))).data})),Rr({from:us,to:ls});const ps=(e,t)=>{'iOS'===e.os_name?window.isIos=!0:'Android'===e.os_name&&(window.Android=!0);let r=Br.getState();return r&&r.userId&&(e.user_id=r.userId),e.features='animation,data,deeplink,placeholder,resetTimers,gameReader,swipeUpItems',t&&(e.features+=',webp'),e},fs=()=>ei.getInstance().getDeviceInfo(Jr),gs=()=>Promise.resolve(ei.getInstance().isWebPSupported),ms=R({default:[]}),ys=ms.map((e=>e[as.userKey]||[]));let vs;(e=>{e.FEEDS="feeds",e.FAVORITE="favorite"})(vs||(vs={}));const Ss=R({default:{[vs.FEEDS]:{},[vs.FAVORITE]:[]}}),ws=Ss.map((e=>e[as.userKey]||{})),Ls=R({}),Cs=R({}),bs=R([]);Ls.on([ws,ys],(()=>{let e=ws.getState(),t={},r=ys.getState();for(let s in e[vs.FEEDS])if(t[s]=[],e[vs.FEEDS][s]&&Array.isArray(e[vs.FEEDS][s])){let i=e[vs.FEEDS][s];for(let e of i){let i=r.find((t=>t.id===e));i&&t[s].push(i)}}return t})),Cs.on([ws,ys],(()=>{let e=ws.getState(),t={},r=ys.getState();for(let s in e[vs.FEEDS])if("onboarding_"===s.substring(0,"onboarding_".length)){let i=s.substring("onboarding_".length);t[i]=[],e[vs.FEEDS][s]&&Array.isArray(e[vs.FEEDS][s])&&(t[i]=r.filter((t=>-1!==e[vs.FEEDS][s].indexOf(t.id)&&!t.is_opened)))}return t})),bs.on([ws,ys],(()=>{let e=ws.getState();return ys.getState().filter((t=>{var r;return-1!==(null===(r=e[vs.FAVORITE])||void 0===r?void 0:r.indexOf(t.id))}))}));const Rs=k(),ks=e=>e.is_opened,_s=ys.map((e=>e.filter((e=>!e.slidesLoaded)).map((e=>e.id)))),{storyItemFavoriteChanged:Is,storyItemLikeChanged:Os,storyItemIsOpenedChanged:Es}=_(ms,{storyItemFavoriteChanged:(e,t)=>{let{id:r,favorite:s}=t,i=as.userKey,o=(e[i]||[]).slice(0),n=o.find((e=>e.id===r));return void 0!==n&&(n.favorite=s),{...e,[i]:o}},storyItemLikeChanged:(e,t)=>{let{id:r,like:s}=t,i=as.userKey,o=(e[i]||[]).slice(0),n=o.find((e=>e.id===r));return void 0!==n&&(n.like=s),{...e,[i]:o}},storyItemIsOpenedChanged:(e,t)=>{let{id:r}=t,s=as.userKey,i=(e[s]||[]).slice(0),o=i.find((e=>e.id===r));return void 0!==o&&(o.is_opened=!0),{...e,[s]:i}}});Rs.use((async()=>as.get('story',Ms())));const Ms=(e,t,r,s)=>{var i;let o=null===(i=Br.getState())||void 0===i?void 0:i.tags,n={};return o&&E(o)&&o.length>0&&(n.tags=o.join(',')),void 0!==t&&E(t)&&t.length>0&&(n.tags=t.join(',')),null==s||'number'!=typeof s&&!(e=>!isNaN(parseFloat(e))&&isFinite(e))(s)||(n.limit=s),e&&(n.session_id=e),null!=r&&(n.test=r),{params:n}},As=R(null),xs=k(),Ps=b();xs.use((async e=>{let{ids:t}=e;return as.request(V(t))})),Rr({from:xs.done.filterMap((e=>{let t=e.result.data;if(t&&M(t))return{...t,ids:e.params.ids}})),to:As}),Rr({from:Ps,to:As});const Fs=k((async e=>{var t,r;let{defaultList:s,onboardingList:i,favoriteList:o,onboardingTags:n,testKey:a,limit:l}=e,d=[],c=null;D(null===(t=ls.getState())||void 0===t||null===(r=t.session)||void 0===r?void 0:r.id)&&(d.push(Ts(await j(),"session")),c="@{session.session.id}"),!1!==s&&H(s)&&d.push(Ts(((e,t,r,s)=>{let{params:i}=Ms(t,[],s);return{method:"GET",url:`feed/${e}`,params:i}})(s,c,0,a),`storyList_${s}`)),o&&d.push(Ts((e=>{let{params:t}=Ms(e);return{method:"GET",url:"story",params:{...t,favorite:1}}})(c),"storyFavoriteList")),!1!==i&&H(i)&&"string"==typeof i&&d.push(Ts(((e,t,r,s)=>{void 0===e&&(e="onboarding");let{params:i}=Ms(t,r,null,s);return{method:"GET",url:`feed/${e}/onboarding`,params:i}})(i,c,n,l),`storyOnboardingList_${i}`));let u=null;try{let e=await as.post("composite",{compositeRequest:d});if(e.status>=200&&e.status<=299)if(e.data&&e.data.compositeResponse&&Array.isArray(e.data.compositeResponse)){if(e.data.success)return e.data.compositeResponse;for(let t of e.data.compositeResponse){let e=t.status;if(B(e)&&!(e>=200&&e<=299)){u={name:"networkError",networkStatus:e,networkMessage:String(t.body)};break}}}else u=e.data&&M(e.data)&&null!=e.data.name&&null!=e.data.message&&null!=e.data.status?{name:e.data.name,networkStatus:e.data.status,networkMessage:e.data.message}:{name:"networkError",networkStatus:null,networkMessage:"Invalid data in API response, data from response as json: "+JSON.stringify(e.data)};else u=e.data&&M(e.data)&&null!=e.data.name&&null!=e.data.message&&null!=e.data.status?{name:e.data.name,networkStatus:e.data.status,networkMessage:e.data.message}:{name:"networkError",networkStatus:e.status,networkMessage:"Invalid data in API response, data from response as json: "+JSON.stringify(e.data)}}catch(e){try{let t=e;if(t.response&&t.response.status)u={name:"networkError",networkStatus:t.response.status,networkMessage:t.response.statusText};else{let t="";window.navigator&&null!=window.navigator.onLine&&(t=" net::ERR_INTERNET_DISCONNECTED"),u={name:"error",networkStatus:null,networkMessage:e.toString()+t},console.error(e)}}catch(e){u={name:"error",networkStatus:null,networkMessage:e.toString()}}}if(null!==u)throw u;return[]})),Ts=(e,t)=>({path:e.url,qs:e.params,body:e.data,ref:t,method:e.method}),Ns={}.hasOwnProperty,Ds=e=>{let t=zr.getState();for(let r in t.user)Ns.call(t.user,r)&&(e=U(e,`%${r}%`,t.user[r]));for(let r in t.default)Ns.call(t.default,r)&&(e=U(e,`%${r}%`,t.default[r]));return e},Hs=e=>Array.isArray(e)?e.map((e=>({...e,title:e.need_placeholders?Ds(e.title):e.title,slidesLoaded:!1,is_opened:ks(e)}))):[];Rr({from:Fs.doneData.filterMap((e=>{var t;return null===(t=e.find((e=>"session"===e.ref)))||void 0===t?void 0:t.body})),to:ls}),Rr({from:Fs.doneData.filterMap((e=>{var t,r;return null===(t=e.find((e=>"session"===e.ref)))||void 0===t||null===(r=t.body)||void 0===r?void 0:r.placeholders})),to:Xr}),((...e)=>{let t,r,s,i,[[o,n,a],l]=gr(e);void 0===n&&dt(o)&&(e=>{let t=0;return((e,t)=>{Hr.forEach(t)})(0,(r=>{r in e&&(null==e[r]&&lt(`sample: ${r} should be defined`),t=1)})),t})(o)&&(n=o.clock,a=o.fn,i=o.greedy,t=o.target,r=o.name,s=o.sid,o=o.source);let d=1;void 0===o&&(v(n,'sample','clock'),Array.isArray(n)&&(n=O(n)),o=n,d=0),d&&!et(o)&&(o=((...e)=>{let t,r,s;fr(e[0],((t,r)=>{s=t,e=r}));let i,o,n=e[e.length-1];if(ct(n)?(r=e.slice(0,-1),t=n):r=e,1===r.length){let e=r[0];rt(e)||(i=e,o=1)}return o||(i=r,t&&(t=(e=>t=>e(...t))(t))),dt(i)||lt('shape should be an object'),Fr(Array.isArray(i),i,s,t)})(o)),void 0===n&&(n=o),v(n,'sample','clock'),r=l||r||o.shortName;let c=$t(),u=!!t;t||(rt(o)&&rt(n)?t=R(a?a(Ot(Tt(o)),Ot(Tt(n))):Ot(Tt(o)),{name:r,sid:s}):(t=b(r),c&&xt(t).seq.push(c.loader)));let h=u&&et(t)&&xt(t).meta.nativeTemplate;if(rt(o)){let e=Tt(o);Vt(o,[br(n,t,{scope:{fn:a,targetTemplate:h},node:[c&&c.loader,!i&&wt({priority:"sampler"}),Lt({store:e,to:a?"a":"stack"}),a&&bt({fn:Mt}),c&&u&&c.upward],meta:{op:"sample",sample:Xe}})]),c&&(mr(c.plain,e)||mr(c.closure,e)||c.closure.push(e))}else{let e=It(0),r=It(),s=It();c&&c.plain.push(e,r,s),S({parent:o,node:[_t({store:r}),Lt({from:"value",store:1,target:e})],family:{owners:[o,t,n],links:t},meta:{op:"sample",sample:'source'},regional:1}),Vt(o,[br(n,t,{scope:{fn:a,targetTemplate:h},node:[c&&c.loader,_t({store:s}),Lt({store:e}),Rt({fn:e=>e}),!i&&wt({priority:"sampler"}),Lt({store:r}),Lt({store:s,to:"a"}),a&&bt({fn:Et}),c&&u&&c.upward],meta:{op:"sample",sample:'clock'}})])}})({source:ms,clock:ls,fn:e=>{let t={};for(let r in e)Ns.call(e,r)&&(t[r]=e[r].map((e=>({...e,is_opened:ks(e),title:e.need_placeholders?Ds(e.title):e.title}))));return t},target:ms});const{storiesListItemsAdded:Bs}=_(ms,{storiesListItemsAdded:(e,t)=>{let{storyList:r}=t,s=as.userKey;console.log("storiesListItemsAdded",{key:s,storyListLength:r.length});let i=e[s]||[],o=i.map((e=>e.id)),n=[];for(let e of i){let t=r.find((t=>t.id===e.id));n.push(null!=t?t:e)}return{...e,[s]:[...n,...r.filter((e=>-1===o.indexOf(e.id)))]}}}),{storiesListIdsChanged:js}=_(Ss,{storiesListIdsChanged:(e,t)=>{let{storiesIdsUserEntity:r,feedSlug:s,storyList:i}=t,o=as.userKey,n=e[o]||{};return void 0===n[vs.FAVORITE]&&(n[vs.FAVORITE]=[]),void 0===n[vs.FEEDS]&&(n[vs.FEEDS]={}),r===vs.FEEDS&&s&&(n[vs.FEEDS][s]=i.map((e=>e.id))),r===vs.FAVORITE&&(n[vs.FAVORITE]=i.map((e=>e.id))),{...e,[o]:n}}});Rr({from:Fs.doneData.filterMap((e=>{let t=null;for(let s of e)if(s.ref&&H(s.ref)){let e=s.ref.match(/^storyList_(.+)/);if(e&&Array.isArray(e)&&e[1]){var r;let i=Hs(null===(r=s.body)||void 0===r?void 0:r.stories);t={storiesIdsUserEntity:vs.FEEDS,feedSlug:e[1],storyList:i}}}if(t)return t})),to:[Bs,js]}),Rr({from:Fs.doneData.filterMap((e=>{let t=e.find((e=>"storyFavoriteList"===e.ref));if(void 0===t)return;let r=Hs(t.body);return{storiesIdsUserEntity:vs.FAVORITE,feedSlug:null,storyList:r}})),to:[Bs,js]}),Rr({from:Fs.doneData.filterMap((e=>{let t=null;for(let s of e)if(s.ref&&H(s.ref)){let e=s.ref.match(/^storyOnboardingList_(.+)/);if(e&&Array.isArray(e)&&e[1]){var r;let i=Hs(null===(r=s.body)||void 0===r?void 0:r.stories);t={storiesIdsUserEntity:vs.FEEDS,feedSlug:`onboarding_${e[1]}`,storyList:i}}}if(t)return t})),to:[Bs,js]});const Ws=k();Ws.use((async e=>{let t=e.ids.map((e=>Ts(W(e),`storySlides_${e}`))),r=await as.post("composite",{compositeRequest:t});return r.data&&r.data.success&&r.data.compositeResponse&&Array.isArray(r.data.compositeResponse)?r.data.compositeResponse:[]}));const Vs=e=>e&&M(e)&&"id"in e,Us=k();Us.use((async e=>{let{ids:t,id:r}=e,s=[Ts(W(r),"storySlides"),Ts(V(t),"storyContext")],i=await as.post("composite",{compositeRequest:s});return i.data&&i.data.success&&i.data.compositeResponse&&Array.isArray(i.data.compositeResponse)?i.data.compositeResponse:[]})),ms.on([Ws.doneData,Us.doneData],((e,t)=>{if(Array.isArray(t)){let r=as.userKey,s=(e[r]||[]).slice(0).map((e=>{for(let p=0;p<t.length;p++){var r,s,i,o,n,a,l,d,c,u,h;if(Vs(null===(r=t[p])||void 0===r?void 0:r.body)&&(null===(s=t[p])||void 0===s||null===(i=s.body)||void 0===i?void 0:i.id)===e.id)return Object.assign({},e,{slides_html:e.need_placeholders?Array.from(null===(o=t[p])||void 0===o||null===(n=o.body)||void 0===n?void 0:n.slides_html).map((e=>Ds(e))):Array.from(null===(a=t[p])||void 0===a||null===(l=a.body)||void 0===l?void 0:l.slides_html),slides_duration:null===(d=t[p])||void 0===d||null===(c=d.body)||void 0===c?void 0:c.slides_duration,slides_screenshot_share:null===(u=t[p])||void 0===u||null===(h=u.body)||void 0===h?void 0:h.slides_screenshot_share,slidesLoaded:!0,is_opened:ks(e)})}return e}));return{...e,[r]:s}}return e})),Rr({from:Us.done.filterMap((e=>{var t;let r=null===(t=e.result.find((e=>"storyContext"===e.ref)))||void 0===t?void 0:t.body;if(r&&M(r))return{...r,ids:e.params.ids}})),to:As});const $s=k((async e=>{var t,r;let{id:s}=e,i=[],o=null;D(null===(t=ls.getState())||void 0===t||null===(r=t.session)||void 0===r?void 0:r.id)&&(i.push(Ts(await j(),"session")),o="@{session.session.id}"),i.push(Ts(W(s,!0,o),"story")),i.push(Ts(V([s],o),"storyContext"));let n=await as.post("composite",{compositeRequest:i});if(n.data&&n.data.success&&n.data.compositeResponse&&Array.isArray(n.data.compositeResponse))return n.data.compositeResponse;if(n.data&&!n.data.success)throw Error("composite request error:"+JSON.stringify(n.data.compositeResponse));return[]})),qs=e=>!!e;Rr({from:$s.doneData.filterMap((e=>{var t;let r=null===(t=e.find((e=>"session"===e.ref)))||void 0===t?void 0:t.body;if(r&&M(r)&&qs(r))return r})),to:ls}),Rr({from:$s.done.filterMap((e=>{var t;let r=null===(t=e.result.find((e=>"storyContext"===e.ref)))||void 0===t?void 0:t.body;if(r&&M(r))return{...r,ids:[e.params.id]}})),to:As}),ms.on($s.doneData.filterMap((e=>{var t,r;let s=null,i=null===(t=e.find((e=>"session"===e.ref)))||void 0===t?void 0:t.body;i&&M(i)&&qs(i)&&(s=i.user_key);let o=null===(r=e.find((e=>"story"===e.ref)))||void 0===r?void 0:r.body;if(o&&M(o))return{story:o,userKey:s}})),((e,t)=>{if(M(t)&&void 0!==t.story&&Vs(t.story)){let r=as.userKey,s=(e[r]||[]).slice(0),i=t.story,o=s.filter((e=>{var t;return e.id!==(null===(t=i)||void 0===t?void 0:t.id)})).slice(0);return i=Object.assign(i,{slides_html:i.need_placeholders?Array.from(i.slides_html).map((e=>Ds(e))):Array.from(i.slides_html),slides_duration:i.slides_duration,slidesLoaded:!0,is_opened:ks(i)}),o.push(i),{...e,[r]:o}}}));let Ks=!1,Gs=null;const Js=()=>(null!=Gs||(Gs=new Promise((e=>{ls.watch((t=>{let{session:r}=t;!Ks&&null!=r&&Boolean(r.id)&&(Ks=!0,e())}))}))),Gs);let zs;(e=>{e.START_LOADING="startLoad",e.END_LOADING="endLoad",e.CLOSE_STORY_READER="closeStoryReader"})(zs||(zs={}));class Zs{}const Xs=(e,t)=>{switch(e){case Ge.default:return t?Ls.getState()[t]:[];case Ge.favorite:return bs.getState();case Ge.onboarding:return t?Cs.getState()[t]:[]}return[]},Ys=()=>ls.getState().cache.filter((e=>"font-face"===e.type)),Qs=async(e,t,r,s)=>{let i=ys.getState().find((t=>t.id===e||t.string_id===e));if(void 0!==i){await Js(),t.setFonts(Ys());let e={windowReferer:Ke.default,listType:Ge.default,id:i.id,storyContext:As.getState(),storyList:[i],hasShare:ls.getState().share,platform:r,soundOn:s};return t.openReader(e,{listType:Ge.direct,feed:null}),!0}return!1};class ei extends n{get soundOn(){return this._soundOn}set soundOn(e){this._soundOn=e,null!=this.storyReaderInstance&&this.storyReaderInstance.setSoundOn(this._soundOn)}constructor(e,t){return super(),this._soundOn=void 0,this._callbacks={},this.StoriesList=class extends n{constructor(e,t,r){void 0===r&&(r="default"),super(),this.feedSlug=r,this.storyListWidget=void 0,this.appearanceManager=void 0,this._listLoadStatus={feed:"default",defaultListLength:0,favoriteListLength:0,success:!0,error:{name:"",networkStatus:200,networkMessage:""}}}async reload(e){var t;void 0===e&&(e={needLoader:!0});let r=!0;!1===(null===(t=e)||void 0===t?void 0:t.needLoader)&&(r=!1);try{return await ei.instance._loadStoriesList(this.storyListWidget,this.appearanceManager,this,!1,r)}catch(e){throw Error(e)}}},this._appearanceManager=null,this.storyListInstance=null,this._storyReaderInstance=null,this.storyReaderInstancePromise=null,this.storyReaderInstancePromiseResolver=null,this._goodsWidgetInstance=null,this._storyReaderNeedFirstRender=null,this._storyReaderNeedLoaderRender=null,this._storyReaderDetachComponent=null,this._storyReaderWidgetLoaded=async e=>{await Js(),this.completeInitStoryReader(e,Ys()),null!=this.storyReaderInstancePromiseResolver&&this.storyReaderInstancePromiseResolver(e)},this._storyFavoriteReaderInstance=null,this.storyFavoriteReaderInstancePromise=null,this.storyFavoriteReaderInstancePromiseResolver=null,this._storyFavoriteReaderNeedFirstRender=null,this._storyFavoriteReaderNeedLoaderRender=null,this._storyFavoriteReaderDetachComponent=null,this._storyFavoriteReaderWidgetLoaded=async e=>{await Js(),this.completeInitStoryFavoriteReader(e,Ys()),null!=this.storyFavoriteReaderInstancePromiseResolver&&this.storyFavoriteReaderInstancePromiseResolver(e)},this._loadedStoriesLength={defaultListLength:0,favoriteListLength:0},this._listLoadStatus={feed:"default",defaultListLength:0,favoriteListLength:0,success:!0,error:{name:"",networkStatus:200,networkMessage:""}},this._loadStoriesList=async(e,t,r)=>{void 0===r&&(r=!0);let s=!0===t.commonOptions.hasFavorite&&r;try{await Fs({defaultList:e.feedSlug,onboardingList:!1,favoriteList:s,testKey:e.testKey}),await new Promise((e=>setTimeout(e,100))),e.setListLoadStatusField("feed",e.feedSlug),e.setListLoadStatusField("success",!0),e.setListLoadStatusField("error",null)}catch(t){e.setListLoadStatusField("success",!1),e.setListLoadStatusField("error",{name:t.name,networkMessage:t.networkMessage,networkStatus:t.networkStatus})}return e.listLoadStatus},this._loadStoriesListData=async(e,t)=>{e.emit(exports.StoriesListEvents.START_LOADER);let r=await this._loadStoriesList(e,t,!0);return setTimeout((()=>{e.emit(exports.StoriesListEvents.END_LOADER,r)})),r},this.isWebPSupported=!1,this._storiesListWidgetLoaded=async(e,t)=>{this.isWebPSupported=await e.checkWebPSupport(),e.forUnsubscribe.push(Ls.watch((t=>{var r;let s=null!==(r=t[e.feedSlug])&&void 0!==r?r:[];e.setListLoadStatusField("defaultListLength",s.length),e.setStories({listType:Ge.default,storyList:s})}))),t.commonOptions.hasFavorite&&e.forUnsubscribe.push(bs.watch((async t=>{e.setListLoadStatusField("favoriteListLength",t.length),e.setStories({listType:Ge.favorite,storyList:t}),this._storyFavoriteReaderInstance&&this._storyFavoriteReaderInstance.setStories({listType:Ge.favorite,storyList:t})}))),await Js();let s=Ys();return e.setFonts(s),Br.getState(),e.setCallbacks({handleClickOnStoryDeepLink:e=>{((e,t,r)=>{if("sendBeacon"in navigator){var s,i;let n=`${o=as.baseURL,o.replace(/\/$/,"")}/${T(e)}?access_token=${Br.getState().apiKey}&session_id=${null===(s=ls.getState())||void 0===s||null===(i=s.session)||void 0===i?void 0:i.id}`,a=new FormData;Object.keys(t).forEach((e=>{is.convertModelToFormData(a,t[e],e)})),navigator.sendBeacon(n,a),r()}else as.post(e,t).then((()=>r()),(()=>r()));var o})("session/update",{data:[[1,0,e.id,0,0]]},is.createFunctionWithTimeout((()=>{var t,s,i;e.isDeeplink&&e.url&&(null!==(t=storiesListOptions)&&void 0!==t&&t.handleStoryLinkClick&&r(null===(s=storiesListOptions)||void 0===s?void 0:s.handleStoryLinkClick)?null===(i=storiesListOptions)||void 0===i||i.handleStoryLinkClick(e):window.open(e.url,"_self"))})))},handleClickOnStory:t=>{if(0===t.id)this.emit("clickOnFavoriteCell",{feed:e.feedSlug});else{let r={title:null,tags:[],slidesCount:null,feed:null,source:null},s=ys.getState().find((e=>e.id===t.id));s&&(r.title=s.title,r.tags=s.tags,r.slidesCount=s.slides_count),r.feed=e.feedSlug,r.source=qe.list,this.emit("clickOnStory",{...t,...r})}},handleFlushThumbViews:e=>{hs(e)},handleClickOnStoryInternal:t=>this.handleClickOnStoryInternal(t,e.feedSlug)}),e.on("clickOnFavoriteCellInternal",(async t=>{let r;try{this.emit("openStoryFavoriteReader",t),r=await this.getStoryFavoriteReaderInstance(),r.emit("openStoryFavoriteReader",t),this.showStoryFavoriteReaderLoader(!0);let s={...t,storyList:Xs(Ge.favorite),soundOn:this.soundOn};r.openReader(s,{listType:t.listType,feed:e.feedSlug})}catch(e){this.showStoryFavoriteReaderLoader(!1),r&&r.closeReader(),console.log(e)}})),this.storyListInstance=e,{storyListWidget:e,appearanceManager:t}},this._androidDefaultWindowSoftInputMode=null,this._innerAndroidDefaultWindowSoftInputIntegerMode=null,this.SharePage=class extends n{constructor(e,t,r,s){return super(),this.storyReaderWidget=void 0,this.appearanceManager=void 0,this.options={},r&&(this.options=r),ei.instance._showSharePage(e,t,this.options,this).then((e=>{let{storyReaderInstance:t,appearanceManager:r}=e;this.storyReaderWidget=t,this.appearanceManager=r})),this}async closeStoryReader(){this.storyReaderWidget&&(ei.instance.closeGoodsWidget(),this.storyReaderWidget.closeReader())}},this._showSharePage=async(e,t,s,i)=>{setTimeout((()=>{i.emit(zs.START_LOADING),r(s.handleStartLoad)&&s.handleStartLoad()}));let o=!1,n=null;try{await Js(),n=await this.initStoryReader(t,Ys(),{closeOnLastSlideByTimer:!1,recycleStoriesList:!1}),n.on("closeStoryReader",(()=>{if(r(s.handleStoryReaderClose)||i.listenerCount(zs.CLOSE_STORY_READER)>0)try{r(s.handleStoryReaderClose)&&s.handleStoryReaderClose(),i.emit(zs.CLOSE_STORY_READER)}catch(e){console.error(e)}else{let e=window.location!=window.parent.location?window.parent.location:window.location;window.open(`${e.protocol}//${e.host}`,"_parent")}})),o=await Qs(e,n,this.getDevicePlatform(),this.soundOn)}catch(e){}return i.emit(zs.END_LOADING,{result:o}),r(s.handleStopLoad)&&s.handleStopLoad(o),{storyReaderInstance:n,appearanceManager:t,result:o}},ei.instance||(D(e.userId)||(e.userId=String(e.userId)),ns.getInstance().checkUserIdLength(e.userId),ns.getInstance().checkTagsLength(e.tags),null!=e.defaultMuted&&"boolean"==typeof e.defaultMuted||(e.defaultMuted=!0),this._soundOn=!e.defaultMuted,jr(e),e.placeholders&&Zr(e.placeholders),t&&M(t)&&(this._callbacks=t),as.deviceInfoPromise=new Promise((e=>(async(e,t,r)=>{let s=await e();t.baseHeaders={"X-Sdk-Version":s.sdkVersion,"X-App-Package-Id":s.applicationBundleId,"X-User-Agent":s.userAgent,"X-Device-Id":s.deviceId},t.deviceId=s.deviceId,r(!0)})(this.getDeviceInformation,as,e))),as.userId=e.userId,(e=>{let t=(e=>{if(e.length>32)try{let t=(e=>{e=e.replace(new RegExp('-','g'),'+').replace(new RegExp('_','g'),'/'),e=((e,t)=>void 0===t?e:t.length>=e.length?t:(t+e).substring(0,e.length))(new Array(e.length%4).fill("=").join(""),e);try{return(e=>{void 0===e&&(e='');let t=e.replace(/=+$/,''),r='';if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let e,s=0,i=0,o=0;e=t.charAt(o++);~e&&(i=s%4?64*i+e:e,s++%4)?r+=String.fromCharCode(255&i>>(-2*s&6)):0)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e);return r})(e)}catch(e){return""}})(e),r=t.charCodeAt(13);if(r>0){let e=t.substr(14,r);e=e.replace(/\0+$/,'');let s="{QQN{xuV?1Dv16j3",i=s,o=0;for(;i.length<r;)i+=s[o],o++,o===s.length&&(o=0);let n="";for(let t=0;t<r;t++)n+=String.fromCharCode(e.charCodeAt(t)^i.charCodeAt(t));return n}}catch(e){console.error(e)}return null})(e);if(null!=t){let e=t.split(".").slice(1);os.baseUrl=`https://${["sdk",...e].join(".")}`,os.faviconApiUrl=`https://${["favicon",...e].join(".")}`,os.apiUrl=`https://${t}`}})(e.apiKey),ei.instance=this),ei.instance}destructor(){delete ei.instance}set storyLinkClickHandler(e){r(e)&&(this._callbacks.storyLinkClickHandler=e)}set openGoodsWidgetHandler(e){r(e)&&(this._callbacks.openGoodsWidgetHandler=e)}get openGoodsWidgetHandler(){return this._callbacks.openGoodsWidgetHandler}static getInstance(){if(!ei.instance)throw new Error("Error - use new IAS.StoryManager(). For first init - with config");return ei.instance}setTags(e){E(e)&&(ns.getInstance().checkTagsLength(e),Wr({tags:e}))}getTags(){var e;return null!==(e=Br.getState().tags)&&void 0!==e?e:[]}setUserId(e){let t=null;D(e)||!H(e)&&!B(e)||(t=String(e),ns.getInstance().checkUserIdLength(t)),cs(),as.userId=t,Vr({userId:t})}getUserId(){return Br.getState().userId}setLang(e){H(e)&&$r({lang:e})}getLang(){return Br.getState().lang}setPlaceholders(e){M(e)&&Ur({placeholders:e})}getPlaceholders(){return Br.getState().placeholders}setIsSandbox(e){qr({isSandbox:e})}setApiKey(e){Kr({apiKey:e}),cs()}get appearanceManager(){return this._appearanceManager}set appearanceManager(e){this._appearanceManager=e}set storyReaderNeedFirstRender(e){this._storyReaderNeedFirstRender=e}set storyReaderNeedLoaderRender(e){this._storyReaderNeedLoaderRender=e}set storyReaderDetachComponent(e){this._storyReaderDetachComponent=e}get storyReaderInstance(){return this._storyReaderInstance}async getStoryReaderInstance(){return new Promise((e=>{null==this._storyReaderInstance?(null==this.storyReaderInstancePromise&&(null!=this._storyReaderNeedFirstRender&&this._storyReaderNeedFirstRender(!0),this.storyReaderInstancePromise=new Promise((e=>this.storyReaderInstancePromiseResolver=e))),this.storyReaderInstancePromise.then((t=>{this._storyReaderInstance=t,e(t)}))):e(this._storyReaderInstance)}))}showStoryReaderLoader(e){null!=this._storyReaderNeedLoaderRender&&this._storyReaderNeedLoaderRender(e)}set storyFavoriteReaderNeedFirstRender(e){this._storyFavoriteReaderNeedFirstRender=e}set storyFavoriteReaderNeedLoaderRender(e){this._storyFavoriteReaderNeedLoaderRender=e}set storyFavoriteReaderDetachComponent(e){this._storyFavoriteReaderDetachComponent=e}get storyFavoriteReaderInstance(){return this._storyFavoriteReaderInstance}async getStoryFavoriteReaderInstance(){return new Promise((e=>{null==this._storyFavoriteReaderInstance?(null==this.storyFavoriteReaderInstancePromise&&(null!=this._storyFavoriteReaderNeedFirstRender&&this._storyFavoriteReaderNeedFirstRender(!0),this.storyFavoriteReaderInstancePromise=new Promise((e=>this.storyFavoriteReaderInstancePromiseResolver=e))),this.storyFavoriteReaderInstancePromise.then((t=>{this._storyFavoriteReaderInstance=t,e(t)}))):e(this._storyFavoriteReaderInstance)}))}showStoryFavoriteReaderLoader(e){null!=this._storyFavoriteReaderNeedLoaderRender&&this._storyFavoriteReaderNeedLoaderRender(e)}async handleClickOnStoryInternal(e,t){let r;try{this.emit("openStoryReader",e),r=await this.getStoryReaderInstance(),r.emit("openStoryReader",e),this.showStoryReaderLoader(!0);let s=As.getState(),i=null!==s;s&&_s.getState().length>0&&s.ids!==_s.getState()&&(i=!1),i=!1,ys.getState().find((t=>t.id===e.id));let o=Xs(e.listType,t).map((e=>e.id));await Us({ids:o,id:e.id});let n={...e,storyContext:As.getState(),storyList:Xs(e.listType,t),hasShare:ls.getState().share,platform:this.getDevicePlatform(),soundOn:this.soundOn};r.openReader(n,{listType:e.listType,feed:t});let a=_s.getState();a.length>0&&await Ws({ids:a}),r.setStories({listType:e.listType,storyList:Xs(e.listType,t)})}catch(e){this.showStoryReaderLoader(!1),r&&r.closeStoryReaderOrLoader(),console.log(e)}}completeInitStoryReader(e,t,s){return e.setSoundOn(this._soundOn),e.on("changeSoundOnInternal",(e=>{let{value:t}=e;this._soundOn=t})),e.setFonts(t),e.setCallbacks({}),e.on("storyOpenedInternal",(e=>{var t;return null===(t=this.storyListInstance)||void 0===t?void 0:t.onStoryOpened(e)})),e.on("setStoryOpened",(async t=>{if(!D(ls.getState().user_key)){let e=`u/${ls.getState().user_key}/s_opened`,r=await this.localStorageGetArray(e);E(r)||(r=[]),r.push(t.id),r=[...new Set(r)],this.localStorageSetArray(e,r)}Es({id:t.id}),e.rpcCb({requestId:t.__cb.id,success:!0,data:t,err:""})})),e.on("updateStoryFavorite",(async t=>{let r=!1,s={favorite:void 0},i="";try{let e=await as.post(`story-favorite/${t.id}`,{value:t.favorite});void 0!==e.data.favorite?(r=!0,s.favorite=Boolean(e.data.favorite),Is({id:t.id,favorite:s.favorite}),js(!1===s.favorite?{storiesIdsUserEntity:vs.FAVORITE,storyList:bs.getState().filter((e=>e.id!==t.id))}:{storiesIdsUserEntity:vs.FAVORITE,storyList:[...bs.getState(),...ys.getState().filter((e=>e.id===t.id))]})):i="response.data.favorite is undefined"}catch(e){i=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:s,err:i})})),e.on("updateStoryLike",(async t=>{let r=!1,s={like:void 0},i="";try{let e=await as.post(`story-like/${t.id}`,{value:t.like});void 0!==e.data.like?(r=!0,s.like=e.data.like,Os({id:t.id,like:s.like})):i="response.data.like is undefined"}catch(e){i=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:s,err:i})})),e.on("getStorySharePath",(async t=>{let r=!1,s={url:void 0},i="";try{let e=await as.get(`story-share/${t.id}`);void 0!==e.data.url?(r=!0,s.url=e.data.url):i="response.data.url is undefined"}catch(e){i=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:s,err:i})})),e.on("apiRequest",(async t=>{let r=!1,s="",i={url:t.url,method:t.method};-1!==["post","put","path"].indexOf(t.method)?t.data&&(i.data=t.data):i.params=t.params;let o={};try{let e=await as.request(i);o.data=e.data,o.status=e.status,o.headers=e.headers,r=!0}catch(e){o.data=e,o.status=400,o.headers=[{}],s=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:o,err:s})})),e.on("updateStoriesStat",(async t=>{let r=!1,s={},i="";try{let e=await as.post("session/update",t.data);void 0!==e.data?(r=!0,s=e.data):i="response.data is undefined"}catch(e){i=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:s,err:i})})),0===e.listenerCount("clickOnButton")&&e.on("clickOnButton",(e=>{if(r(this._callbacks.storyLinkClickHandler)||this.listenerCount(ze.CLICK_ON_STORY)>0){let t={src:"storyReader",srcRef:"default",data:e};try{r(this._callbacks.storyLinkClickHandler)&&this._callbacks.storyLinkClickHandler(t),this.emit(ze.CLICK_ON_STORY,t)}catch(e){console.error(e)}}else window.open(e.url,"_self")})),e.on("clickOnSwipeUpGoods",(t=>{e&&(this._goodsWidgetInstance=new Zs(this,appearanceManager,e,t),this._goodsWidgetInstance.once("close",(t=>{this._goodsWidgetInstance=null,e&&e.closeGoodsWidget(t)})))})),e.on("openedStoryReader",(()=>{this.showStoryReaderLoader(!1)})),e.on("openStoryReader",(()=>{})),e.on("closeStoryReader",(()=>{var t;null===(t=ei.instance)||void 0===t||t.closeGoodsWidget(),null!=this._storyReaderDetachComponent&&this._storyReaderDetachComponent(e),this.storyReaderInstancePromise=null,this._storyReaderInstance=null,this.showStoryReaderLoader(!1),e.emit("modalClosed")})),["showSlide","showStory","closeStory","clickOnButton","likeStory","dislikeStory","favoriteStory","shareStory","shareStoryWithPath"].forEach((t=>e.on(t,(r=>{let s=e.sourceInfo.listType,i=e.sourceInfo.feed,o={title:null,tags:[],slidesCount:null,feed:null,source:null},n=ys.getState().find((e=>e.id===r.id));if(n&&(o.title=n.title,o.tags=n.tags,o.slidesCount=n.slides_count),o.feed=i,s===Ge.direct?o.source=qe.direct:s===Ge.default?o.source=qe.list:s===Ge.onboarding?o.source=qe.onboarding:s===Ge.favorite&&(o.source=qe.favorite),null!=r.index&&(r.payload=null,n&&n.slides_payload&&Array.isArray(n.slides_payload))){let e=n.slides_payload.find((e=>e.slide_index===r.index));null!=e&&e.payload&&(r.payload=e.payload)}this.emit(t,{...r,...o})})))),e.on("changeSoundOnInternal",(e=>{let{value:t}=e;this.emit("soundOnChangedByUser",{value:t})})),e}completeInitStoryFavoriteReader(e,t){return e.setFonts(t),e.setCallbacks({}),e.on("openedStoryFavoriteReader",(()=>{this.showStoryFavoriteReaderLoader(!1)})),e.on("clickOnStoryInternal",(t=>{let r={title:null,tags:[],slidesCount:null,feed:null,source:null},s=ys.getState().find((e=>e.id===t.id));s&&(r.title=s.title,r.tags=s.tags,r.slidesCount=s.slides_count),r.feed=e.sourceInfo.feed,r.source=qe.favorite,this.emit("clickOnStory",{id:t.id,index:t.index,isDeeplink:t.isDeeplink,...r}),this.handleClickOnStoryInternal(t,e.sourceInfo.feed)})),e.on("closeStoryFavoriteReader",(()=>{null!=this._storyFavoriteReaderDetachComponent&&this._storyFavoriteReaderDetachComponent(e),this.storyFavoriteReaderInstancePromise=null,this._storyFavoriteReaderInstance=null,this.showStoryFavoriteReaderLoader(!1),e.emit("modalClosed")})),e}async showOnboardingStories(e,t){let r="onboarding";t&&t.feed&&H(t.feed)&&(r=t.feed);let s={feed:r,defaultListLength:0,favoriteListLength:0,success:!0,error:{name:"",networkStatus:200,networkMessage:""}};try{await Fs({defaultList:!1,onboardingList:r,favoriteList:!1,onboardingTags:t?t.customTags:void 0,limit:t?t.limit:void 0}),s.feed=r,s.success=!0,s.error=null,s.defaultListLength=Xs(Ge.onboarding,r).length}catch(e){s.feed=r,s.success=!1,s.error={name:e.name,networkMessage:e.networkMessage,networkStatus:e.networkStatus}}let i=Xs(Ge.onboarding,r);if(i.length>0){let e={windowReferer:Ke.default,listType:Ge.onboarding,id:i[0].id};return await this.handleClickOnStoryInternal(e,r),s}return s}async showStory(e,t,r){let s,i=!1;try{this.emit("openStoryReader",{}),this.showStoryReaderLoader(!0),await $s({id:e}),s=await this.getStoryReaderInstance(),s.emit("openStoryReader",{}),i=await Qs(e,s,this.getDevicePlatform(),this.soundOn)}catch(e){i=!1}return i||(this.showStoryReaderLoader(!1),s&&s.closeStoryReaderOrLoader()),{loaded:i}}async closeStoryReader(){if(null===this.storyReaderInstancePromise)return!1;let e=await this.getStoryReaderInstance();this.closeGoodsWidget(),e.closeStoryReaderOrLoader()}closeGoodsWidget(){this._goodsWidgetInstance&&(this._goodsWidgetInstance.close(),this._goodsWidgetInstance=null)}set androidDefaultWindowSoftInputMode(e){this._androidDefaultWindowSoftInputMode=e}get sdkVersionName(){return"0.3.10"}get sdkVersionCode(){return parseInt(310)}}let ti;var ri;ei.instance=void 0,(e=>{e.CSS="text/css",e.JS="text/javascript",e.HTML="text/html"})(ti||(ti={})),(e=>{e.START_LOADER="startLoader",e.END_LOADER="endLoader"})(ri||(ri={}));class si extends n{get loaderContainer(){return this._loaderContainer}setCallbacks(e){this.callbacks=e}constructor(){super(),this.widgetId=void 0,this.callbacks={},this.obj=void 0,this._loaderContainer=null}async init(e,t){}loading(e,t){}startLoader(){let e=(e=>{let t=window.isSecureContext;return void 0===t&&'https:'===window.location.protocol&&(t=!0),t?e:e.replace(/^https:\/\//,'http://')})(`${process.env.BASE_URL}/v0.3.10/dist/images/loader.gif`);this.loaderContainer.style.background=`url("${e}") center center no-repeat transparent`}stopLoader(){this.loaderContainer.style.background='none'}getGeneratedPageURL(e){let{html:t,css:r,js:s}=e,i='',o='';null!==r&&(i=`<link rel="stylesheet" type="text/css" href="${$(r,ti.CSS)}" />`),null!==s&&(o=`<script >${$(s,ti.JS)}</script>`);let n=`\n    <html>\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1">\n        ${i}\n        ${o}\n      </head>\n      <body>\n        ${t||''}\n      </body>\n    </html>\n  `;null!==r&&(i=`<style>${r}</style>`),null!==s&&(o=`<script>${s}</script>`);let a=`\n    <html>\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1">\n        ${i}\n        ${o}\n      </head>\n      <body>\n        ${t||''}\n      </body>\n    </html>\n        `;return{src:$(n,ti.HTML),srcdoc:a}}getWidgetDocument(e){return''}destroy(e,t){var r=si.RPC[e];r||r.destroy(),obj.innerHTML=''}}si.count=0,si.RPC={};class ii{}ii.version='v1',ii.MD5=e=>{var t=(e,t)=>{var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r},r=(e,r,s,i,o,n)=>t(((e,t)=>e<<t|e>>>32-t)(t(t(r,e),t(i,n)),o),s),s=(e,t,s,i,o,n,a)=>r(t&s|~t&i,e,t,o,n,a),i=(e,t,s,i,o,n,a)=>r(t&i|s&~i,e,t,o,n,a),o=(e,t,s,i,o,n,a)=>r(t^s^i,e,t,o,n,a),n=(e,t,s,i,o,n,a)=>r(s^(t|~i),e,t,o,n,a);return(e=>{for(var t,r="0123456789abcdef",s="",i=0,o=e.length;i<o;i++)t=e.charCodeAt(i),s+=r.charAt(t>>>4&15)+r.charAt(15&t);return s})((e=>(e=>{for(var t="",r=0,s=32*e.length;r<s;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t})(((e,r)=>{var a,l,d,c,u=1732584193,h=-271733879,p=-1732584194,f=271733878;e[r>>5]|=128<<r%32,e[14+(r+64>>>9<<4)]=r;for(var g=0,m=e.length;g<m;g+=16)a=u,l=h,d=p,c=f,u=s(u,h,p,f,e[g+0],7,-680876936),f=s(f,u,h,p,e[g+1],12,-389564586),p=s(p,f,u,h,e[g+2],17,606105819),h=s(h,p,f,u,e[g+3],22,-1044525330),u=s(u,h,p,f,e[g+4],7,-176418897),f=s(f,u,h,p,e[g+5],12,1200080426),p=s(p,f,u,h,e[g+6],17,-1473231341),h=s(h,p,f,u,e[g+7],22,-45705983),u=s(u,h,p,f,e[g+8],7,1770035416),f=s(f,u,h,p,e[g+9],12,-1958414417),p=s(p,f,u,h,e[g+10],17,-42063),h=s(h,p,f,u,e[g+11],22,-1990404162),u=s(u,h,p,f,e[g+12],7,1804603682),f=s(f,u,h,p,e[g+13],12,-40341101),p=s(p,f,u,h,e[g+14],17,-1502002290),h=s(h,p,f,u,e[g+15],22,1236535329),u=i(u,h,p,f,e[g+1],5,-165796510),f=i(f,u,h,p,e[g+6],9,-1069501632),p=i(p,f,u,h,e[g+11],14,643717713),h=i(h,p,f,u,e[g+0],20,-373897302),u=i(u,h,p,f,e[g+5],5,-701558691),f=i(f,u,h,p,e[g+10],9,38016083),p=i(p,f,u,h,e[g+15],14,-660478335),h=i(h,p,f,u,e[g+4],20,-405537848),u=i(u,h,p,f,e[g+9],5,568446438),f=i(f,u,h,p,e[g+14],9,-1019803690),p=i(p,f,u,h,e[g+3],14,-187363961),h=i(h,p,f,u,e[g+8],20,1163531501),u=i(u,h,p,f,e[g+13],5,-1444681467),f=i(f,u,h,p,e[g+2],9,-51403784),p=i(p,f,u,h,e[g+7],14,1735328473),h=i(h,p,f,u,e[g+12],20,-1926607734),u=o(u,h,p,f,e[g+5],4,-378558),f=o(f,u,h,p,e[g+8],11,-2022574463),p=o(p,f,u,h,e[g+11],16,1839030562),h=o(h,p,f,u,e[g+14],23,-35309556),u=o(u,h,p,f,e[g+1],4,-1530992060),f=o(f,u,h,p,e[g+4],11,1272893353),p=o(p,f,u,h,e[g+7],16,-155497632),h=o(h,p,f,u,e[g+10],23,-1094730640),u=o(u,h,p,f,e[g+13],4,681279174),f=o(f,u,h,p,e[g+0],11,-358537222),p=o(p,f,u,h,e[g+3],16,-722521979),h=o(h,p,f,u,e[g+6],23,76029189),u=o(u,h,p,f,e[g+9],4,-640364487),f=o(f,u,h,p,e[g+12],11,-421815835),p=o(p,f,u,h,e[g+15],16,530742520),h=o(h,p,f,u,e[g+2],23,-995338651),u=n(u,h,p,f,e[g+0],6,-198630844),f=n(f,u,h,p,e[g+7],10,1126891415),p=n(p,f,u,h,e[g+14],15,-1416354905),h=n(h,p,f,u,e[g+5],21,-57434055),u=n(u,h,p,f,e[g+12],6,1700485571),f=n(f,u,h,p,e[g+3],10,-1894986606),p=n(p,f,u,h,e[g+10],15,-1051523),h=n(h,p,f,u,e[g+1],21,-2054922799),u=n(u,h,p,f,e[g+8],6,1873313359),f=n(f,u,h,p,e[g+15],10,-30611744),p=n(p,f,u,h,e[g+6],15,-1560198380),h=n(h,p,f,u,e[g+13],21,1309151649),u=n(u,h,p,f,e[g+4],6,-145523070),f=n(f,u,h,p,e[g+11],10,-1120210379),p=n(p,f,u,h,e[g+2],15,718787259),h=n(h,p,f,u,e[g+9],21,-343485551),u=t(u,a),h=t(h,l),p=t(p,d),f=t(f,c);return[u,h,p,f]})((e=>{var t,r,s=Array(e.length>>2);for(t=0,r=s.length;t<r;t++)s[t]=0;for(t=0,r=8*e.length;t<r;t+=8)s[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return s})(e),8*e.length)))((e=>{for(var t,r,s="",i=-1,o=e.length;++i<o;)t=e.charCodeAt(i),r=i+1<o?e.charCodeAt(i+1):0,55296<=t&&t<=56319&&56320<=r&&r<=57343&&(t=65536+((1023&t)<<10)+(1023&r),i++),t<=127?s+=String.fromCharCode(t):t<=2047?s+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?s+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(s+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return s})(e)))},ii.extend=(e,t,r)=>{for(let s in t)t.hasOwnProperty(s)&&(r||void 0===e[s])&&(e[s]=t[s]);return e},ii._protocol='https:',ii._base_domain='',ii.Widget=si,ii.xdConnectionCallbacks=void 0,ii.init=void 0,ii._apiKey=void 0,ii.userId=void 0,ii.XDM=void 0,ii._domain=void 0,ii._path=void 0,ii.xdReady=void 0,ii.Observer=void 0,ii._rootId=void 0,ii.Util=void 0,ii.xdConnectionCallbacks?setTimeout((()=>{for(var e;e=ii.xdConnectionCallbacks.pop();)e()}),0):(ii.extend(ii,{version:1,_apiKey:null,_session:null,_domain:{main:ii._protocol+'//sdk-narrator.kiozk.ru/',api:ii._protocol+'//api-narrator.kiozk.ru/'},_path:{login:'authorize',proxy:'fxdm_oauth_proxy.html'},_rootId:'ias_api_transport',_nameTransportPath:'',xdReady:!1}),ii.init=e=>{if(ii._apiKey=null,!e.apiKey)throw Error('IAS_OLD.init() called without an apiKey');return ii._apiKey=e.apiKey,ii.userId=e.userId,!0});const oi="FxDomainWidgetStoriesList",ni=I(`server${oi}`),ai=I(`client${oi}`);let li,di,ci={serverFxDomain:ni,clientFxDomain:ai},ui=ai.effect(oi+"setStories"),hi=ai.effect(oi+"setFonts"),pi=ai.effect(oi+"checkWebPSupport"),fi=ni.effect(oi+"widgetLoaded"),gi=ni.effect(oi+"clickOnStoryInternalEvent"),mi=ni.effect(oi+"clickOnFavoriteCellInternalEvent"),yi=ni.effect(oi+"flushThumbViewsEvent"),vi=ni.effect(oi+"clickOnStoryEvent"),Si=ni.effect(oi+"clickOnStoryDeepLinkEvent"),wi=ni.effect(oi+"debug");(e=>{e[e.REQUEST=0]="REQUEST",e[e.RESPONSE=1]="RESPONSE"})(li||(li={})),(e=>{e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR"})(di||(di={}));let Li=0;class Ci{constructor(){this.id=++Li,this.rs=()=>{},this.rj=()=>{},this.req=void 0,bi.set(this.id,this);let e=new Promise(((e,t)=>{this.rs=e,this.rj=t}));e.finally((()=>{bi.delete(this.id)})).catch((()=>{})),this.req=e}}const bi=new Map,Ri=new Map;class ki{constructor(e,t){this.receiverEffects=[],this.senderEffects=[];let r=b();t.onmessage=r,r.watch((e=>{Object(e)===e&&e.sid&&e.id&&((e=>{if(e.type!==li.RESPONSE)return;let t=bi.get(e.id);if(t)if(e.status===di.SUCCESS)t.rs(e.result);else{if('raw'in e.error)return void t.rj(e.error.raw);let r=Error('');'name'in e.error&&(r.name=e.error.name),'message'in e.error&&(r.message=e.error.message),'stack'in e.error&&(r.stack=e.error.stack),'code'in e.error&&(r.code=e.error.code),t.rj(r)}})(e),(async(e,t)=>{if(e.type!==li.REQUEST)return;let r=Ri.get(e.sid);r?await r(e.params).then((r=>{t.sendMessage({id:e.id,sid:e.sid,type:li.RESPONSE,status:di.SUCCESS,result:r})})).catch((r=>{let s={};r instanceof Error?(s.name=r.name,'code'in r&&(s.code=r.code),'message'in r&&(s.message=r.message),'stack'in r&&(s.stack=r.stack)):s.raw=r,t.sendMessage({id:e.id,sid:e.sid,type:li.RESPONSE,status:di.ERROR,error:s})})):t.sendMessage({id:e.id,sid:e.sid,type:li.RESPONSE,status:di.ERROR,error:{name:'RemoteFXError',message:`Unknown sid "${e.sid}"`}})})(e,t))})),e.fxReceiverDomain.onCreateEffect((e=>{let t=e.sid||e.shortName;Ri.set(t,e),this.receiverEffects.push(t)})),e.fxSenderDomain.onCreateEffect((e=>{e.use((r=>{let s=new Ci;return t.sendMessage({id:s.id,sid:e.sid||e.shortName,type:li.REQUEST,params:r}),s.req})),this.senderEffects.push(e)}))}destructor(){this.receiverEffects.forEach((e=>Ri.delete(e))),this.receiverEffects=[],this.senderEffects.forEach((e=>e.use((e=>e)))),this.senderEffects=[]}}class _i{constructor(e){this.webview=e,this._destructor=void 0,this.onMessageCb=null,this._destructor=()=>{}}createOnMessage(){return e=>{this.messageListener(e)}}destructor(){this._destructor()}messageListener(e){let t={};try{t=JSON.parse(e.nativeEvent.data)}catch(e){console.error(e)}r(this.onMessageCb)&&this.onMessageCb(t)}sendMessage(e){try{this.webview.postMessage(JSON.stringify(e))}catch(e){console.log(e)}}set onmessage(e){this.onMessageCb=e}}var Ii='undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:'undefined'!=typeof global?global:'undefined'!=typeof self?self:{},Oi={exports:{}},Ei={};Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.split=G,Ei.splitBySpaces=e=>G(e,[' ','\n','\t']),Ei.splitByCommas=e=>G(e,[','],{last:!0}),function(e,t){var r=Ii&&Ii.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var i in t=arguments[r])({}).hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};t.__esModule=!0;var s=Ei;t.default=e=>{var t=s.splitBySpaces(e),i=t.lastIndexOf('!important'),o=-1!==i;o&&t.splice(i,1);var n=t.length;if(n<1||n>4)throw new Error("Cannot parse "+n+" sides");var a=t[0],l=t.slice(1);return((e,t,s,i)=>(void 0===t&&(t=e),void 0===s&&(s=e),void 0===i&&(i=t),r({bottom:s,left:i,right:t,top:e},o?{important:o}:{}))).apply(void 0,[a].concat(l))},t.default.default=e.exports=t.default}(Oi,Oi.exports);var Mi=K(Oi.exports);class Ai extends si{get feedSlug(){return this._feedSlug}get testKey(){return this._testKey}get listLoadStatus(){return this._listLoadStatus}setListLoadStatusField(e,t){this._listLoadStatus[e]=t}constructor(e,t,s,i){super(),this.storiesListOptions=void 0,this._listLoadStatus={feed:"default",defaultListLength:0,favoriteListLength:0,success:!0,error:{name:"",networkStatus:200,networkMessage:""}},this._feedSlug=void 0,this._testKey=void 0,this.appearanceManager=void 0,this.storyManager=void 0,this.rpc=void 0,this.frameName='',this.rpcOnMessage=e=>{this.rpcBridge&&this.rpcBridge(e)},this.rpcBridge=null,this.forUnsubscribe=[],this.appearanceManager=t,this.storyManager=e,this._feedSlug=null!=s?s:"default",this._testKey=i,this.storiesListOptions={...this.calculateListHeight(t.storiesListOptions),hasFavorite:t.commonOptions.hasFavorite},this.widgetId=++si.count,fi.use((()=>{this.emit("widgetLoaded")})),gi.use((e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryInternal)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryInternal(e))})),mi.use((e=>{this.emit("clickOnFavoriteCellInternal",e)})),yi.use((e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleFlushThumbViews)&&(null===(s=this.callbacks)||void 0===s||s.handleFlushThumbViews(e))})),vi.use((e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStory)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStory(e))})),Si.use((e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryDeepLink)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryDeepLink(e))})),wi.use((e=>{console.log(e)}))}get widgetSrcFile(){return _e}get widgetEntrypoint(){return`\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, shrink-to-fit=no">\n        <meta name="color-scheme" content="dark light">\n        <style type="text/css">${Ie}</style>\n      </head>\n      <div id="app"><div id="_app"></div></div>\n      <script type="text/javascript">${_e}</script>\n      <script type="text/javascript">\n        window.storiesList = (function () {\n          var self = window.storiesList || {};\n          self._e = self._e || [];\n          self.ready = self.ready || function (f) {self._e.push(f);};\n          return self;\n        }());\n\n        window.storiesList.ready(function () {\n          window.storiesList.init(${JSON.stringify(this.storiesListOptions)});\n        });\n\n      </script>`}async mount(e,t){let r={allowTransparency:!0,overflowTouch:!1,backgroundColor:t.layout.backgroundColor,width:'auto',height:0,pageUrl:'',startHeight:0};r.startHeight=t.layout.height?t.layout.height:t.title?50+t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin:t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin,this.createView(e,r)}createView(e,t){'body'===e||document.querySelector(e)}extend(e,t){for(var r in t)e[r]&&'object'==typeof e[r]?this.extend(e[r],t[r]):e[r]=t[r]}genKey(){for(var e='',t=0;t<5;t++)e+=Math.ceil(15*Math.random()).toString(16);return e}mountView(e,t,r){this.frameName='fXD'+this.genKey();let s=document.createElement('div');s.innerHTML='<iframe name="'+this.frameName+'" '+(r||'')+'></iframe>';let i=s.firstChild,o=this;return setTimeout((()=>{i.frameBorder='0',t&&o.extend(i,t),e.insertBefore(i,e.firstChild)}),0),i}calculateListHeight(e){var t,r;let s={storiesHeight:String((null===(t=e.card)||void 0===t?void 0:t.height)||70),storiesLayoutHeight:String((null===(r=e.layout)||void 0===r?void 0:r.height)||0),storiesListTopPadding:String(null!=e.topPadding?e.topPadding:20),storiesListBottomPadding:String(null!=e.bottomPadding?e.bottomPadding:20),storiesListBottomMargin:String(null!=e.bottomMargin?e.bottomMargin:20)},i=parseFloat(s.storiesHeight),o=i,n=0;if(parseFloat(s.storiesLayoutHeight))n=parseFloat(s.storiesLayoutHeight);else{let t=parseFloat(s.storiesListTopPadding),r=parseFloat(s.storiesListBottomPadding),a=e.card.title;if(n=i+t+r,a.display){let e=a.padding,t={top:0,bottom:0};try{if("number"==typeof e)t.top=e,t.bottom=e;else{let r=Mi(e);t.top=parseFloat(r.top),t.bottom=parseFloat(r.bottom)}}catch(e){console.error(e)}let r=a.lineClamp,s=0;try{let e=(e=>{const t=Z(e,1);return null!==t&&t["font-size"]&&t["font-family"].length?t:null})(a.font);null!=e&&null!=e["line-height"]&&(s=parseFloat(e["line-height"]))}catch(e){console.error(e)}let i=t.top+t.bottom+r*s;n+=i,o+=i}}return null==e.layout.storiesListInnerHeight&&(e.layout.storiesListInnerHeight=o),e.layout.height=n,e}get storiesListDimensions(){return{totalHeight:this.storiesListOptions.layout.height}}get containerOptions(){return{style:{position:'relative',height:parseInt(String(this.storiesListOptions.layout.height)),width:"100%",backgroundColor:"transparent",overflow:"hidden"}}}get viewOptions(){var e,t,r,s;this.frameName||(this.frameName='fXD'+this.genKey());let i={storiesHeight:(null===(e=this.storiesListOptions.card)||void 0===e?void 0:e.height)||70,storiesLayoutHeight:(null===(t=this.storiesListOptions.layout)||void 0===t?void 0:t.height)||0,storiesBackgroundColor:(null===(r=this.storiesListOptions.layout)||void 0===r?void 0:r.backgroundColor)||'transparent',storiesListTopPadding:null!=this.storiesListOptions.topPadding?this.storiesListOptions.topPadding:20,storiesListBottomPadding:null!=this.storiesListOptions.bottomPadding?this.storiesListOptions.bottomPadding:20,storiesListBottomMargin:null!=this.storiesListOptions.bottomMargin?this.storiesListOptions.bottomMargin:20,storiesTitle:(null===(s=this.storiesListOptions.title)||void 0===s?void 0:s.content)||'',extraCss:this.storiesListOptions.extraCss||null,extraJs:null},o={maxWidth:0,startHeight:70,storiesHeight:70,minWidth:150,scrolling:!1,hidden:!1};o.startHeight=i.storiesLayoutHeight?parseFloat(i.storiesLayoutHeight):i.storiesTitle?50+parseFloat(i.storiesHeight||o.storiesHeight)+parseFloat(i.storiesListTopPadding)+parseFloat(i.storiesListBottomPadding)+parseFloat(i.storiesListBottomMargin):parseFloat(i.storiesHeight||o.storiesHeight)+parseFloat(i.storiesListTopPadding)+parseFloat(i.storiesListBottomPadding)+parseFloat(i.storiesListBottomMargin);let n=parseInt(0,10),a=n?Math.max(o.minWidth,Math.min(1e4,n))+'px':'100%';return Boolean(!0).toString(),-1!=a.indexOf('%')||parseInt(a),{style:{width:'100%',height:parseInt(String(this.storiesListOptions.layout.height)),backgroundColor:"transparent"},source:{html:this.widgetEntrypoint,baseUrl:'https://sdk.inappstory.com'},onMessage:this.rpcOnMessage}}createRpcServer(e){let t=new _i(e);this.rpcBridge=t.createOnMessage(),q(ci,t)}async init(e,t){var r,s,i,o;let n={storiesHeight:(null===(r=t.card)||void 0===r?void 0:r.height)||70,storiesLayoutHeight:(null===(s=t.layout)||void 0===s?void 0:s.height)||0,storiesBackgroundColor:(null===(i=t.layout)||void 0===i?void 0:i.backgroundColor)||'transparent',storiesListTopPadding:t.topPadding||20,storiesListBottomPadding:t.bottomPadding||20,storiesListBottomMargin:t.bottomMargin||20,storiesTitle:(null===(o=t.title)||void 0===o?void 0:o.content)||'',extraCss:t.extraCss||null,extraJs:null},a={allowTransparency:!0,overflowTouch:!1};a.backgroundColor=n.storiesBackgroundColor;var l={startHeight:70,minWidth:150,storiesHeight:70};l.startHeight=n.storiesLayoutHeight?parseFloat(n.storiesLayoutHeight):n.storiesTitle?50+parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin):parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin),document.querySelector('body'),document.querySelector('html');let d=this,c={event:(e,t)=>{d.emit(e,t)}};return n.extraJs=null,a.no_finish_loading=!0,this._init(e,a,n,t,c,l,(()=>{}),null,null)}getWidgetDocument(e){let t=`${process.env.BASE_URL}/v0.3.10/dist/js/storiesList.js`;return t=_e,`\n        <script type="text/javascript" src="${t}"></script>\n        <div id="app"><div id="_app"></div></div>\n        <script type="text/javascript">\n          window.storiesList.init(${JSON.stringify(e)});\n        </script>\n`}async _init(e,t,s,i,o,n,a,l,d){o.event=(e,t)=>this.emit(e,t);let c=super._init(e,t,s,i,o,n,((e,t,r)=>{this.rpc=r}),l,d);return this.on('clickOnStoryInternal',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryInternal)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryInternal(e))})),this.on('flushThumbViews',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleFlushThumbViews)&&(null===(s=this.callbacks)||void 0===s||s.handleFlushThumbViews(e))})),this.on('clickOnStory',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStory)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStory(e))})),this.on('clickOnStoryDeepLink',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryDeepLink)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryDeepLink(e))})),this.on('syncStore',(()=>{})),c}onStoryOpened(e){this.rpc.callMethod('onStoryOpened',e)}syncStoreHandle(e){this.rpc.callMethod('onSyncStore',e)}setStories(e){ui(e)}setFonts(e){hi(e)}checkWebPSupport(){return pi()}destructor(){this.forUnsubscribe.map((e=>e())),this.forUnsubscribe=[]}async load(){try{return await this.storyManager.loadStoriesListData(this,this.appearanceManager)}catch(e){throw Error(e)}}async reload(){try{return await this.storyManager.loadStoriesListData(this,this.appearanceManager)}catch(e){throw Error(e)}}}exports.StoryReaderCloseButtonPosition=void 0,(e=>{e.LEFT="left",e.RIGHT="right"})(exports.StoryReaderCloseButtonPosition||(exports.StoryReaderCloseButtonPosition={})),exports.StoryReaderSwipeStyle=void 0,(e=>{e.FLAT="flat",e.COVER="cover",e.CUBE="cube"})(exports.StoryReaderSwipeStyle||(exports.StoryReaderSwipeStyle={}));const xi={closeButtonPosition:exports.StoryReaderCloseButtonPosition.RIGHT,scrollStyle:exports.StoryReaderSwipeStyle.FLAT,loader:{default:{color:null,accentColor:null},custom:null},recycleStoriesList:!1,closeOnLastSlideByTimer:!0,faviconApiUrl:"",slideBorderRadius:0},Pi={hasFavorite:!1,hasLike:!1,hasLikeButton:!0,hasDislikeButton:!0,hasShare:!1},Fi="FxDomainWidgetStory",Ti=I(`server${Fi}`),Ni=I(`client${Fi}`);let Di={serverFxDomain:Ti,clientFxDomain:Ni},Hi=Ni.effect(Fi+"setStories"),Bi=Ni.effect(Fi+"setFonts"),ji=Ni.effect(Fi+"setSoundOn"),Wi=Ni.effect(Fi+"onOpenReader"),Vi=Ni.effect(Fi+"onCloseReader"),Ui=Ni.effect(Fi+"onPauseUI"),$i=Ni.effect(Fi+"onResumeUI"),qi=Ti.effect(Fi+"widgetLoaded"),Ki=Ti.effect(Fi+"onReaderOpened"),Gi=Ti.effect(Fi+"onReaderClosed"),Ji=Ti.effect(Fi+"widgetEvent"),zi=Ni.effect(Fi+"widgetEventCb"),Zi=Ti.effect(Fi+"shareStoryInternal"),Xi=Ti.effect(Fi+"debug");const Yi=fe.StyleSheet.create({emptyOverlay:{backgroundColor:'transparent',height:0,position:'absolute',width:0},fullOverlay:{backgroundColor:'transparent',bottom:0,left:0,position:'absolute',right:0,top:0}});class Qi extends ke.Component{constructor(...e){super(...e),((e,t,r)=>{t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})(this,"state",{fadeAnim:new fe.Animated.Value(0),overlayStyle:Yi.emptyOverlay})}UNSAFE_componentWillReceiveProps(e){return e.visible&&this.setState({overlayStyle:Yi.fullOverlay}),fe.Animated.timing(this.state.fadeAnim,{toValue:e.visible?1:0,duration:300,useNativeDriver:!1}).start(this.onAnimatedEnd.bind(this))}onAnimatedEnd(){this.props.visible||this.setState({overlayStyle:Yi.emptyOverlay})}render(){return ke.createElement(fe.Animated.View,{style:[this.state.overlayStyle,{opacity:this.state.fadeAnim}]},this.props.children)}}class eo extends ke.Component{constructor(...e){super(...e),((e,t,r)=>{t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})(this,"state",{bottom:new fe.Animated.Value(-300)})}UNSAFE_componentWillReceiveProps(e){return fe.Animated.timing(this.state.bottom,{toValue:e.visible?0:-300,duration:300,useNativeDriver:!1}).start()}render(){return ke.createElement(fe.Animated.View,{style:{bottom:this.state.bottom}},this.props.children)}}const to=fe.StyleSheet.create({button:{backgroundColor:'white',flexDirection:'row',height:50,padding:10},buttonText:{color:'#2c2c2c',fontSize:16,fontWeight:'bold',textAlign:'left',textAlignVertical:'center'},icon:{height:28,marginLeft:10,marginRight:30,width:28}}),ro=fe.StyleSheet.create({actionSheetContainer:{backgroundColor:'rgba(0, 0, 0, 0.5)',flex:1,justifyContent:'flex-end',paddingBottom:0,paddingTop:10},buttonContainer:{backgroundColor:'white',overflow:'hidden',paddingBottom:5,paddingTop:5},button:{flex:1}}),so=('string'==typeof fe.Platform.Version?parseInt(fe.Platform.Version,10):fe.Platform.Version)<19,io=async e=>{if((e.url||e.urls)&&'android'===fe.Platform.OS){const t=e.urls||(e.url?[e.url]:[]);try{if(!(await Promise.all(t.map((e=>new Promise(((t,r)=>{fe.NativeModules.RNShare.isBase64File(e,(e=>{r(e)}),(e=>{t(e)}))})))))).includes(!0))return Promise.resolve(!0);if(await fe.PermissionsAndroid.check(fe.PermissionsAndroid.PERMISSIONS.WRITE_EXTERNAL_STORAGE))return Promise.resolve(!0);if(so){if(await fe.PermissionsAndroid.request(fe.PermissionsAndroid.PERMISSIONS.WRITE_EXTERNAL_STORAGE)===fe.PermissionsAndroid.RESULTS.GRANTED)return Promise.resolve(!0);throw new Error('Write Permission not available')}}catch(e){return Promise.reject(e)}}return Promise.resolve(!0)};let oo,no;(e=>{e.Facebook="facebook",e.FacebookStories="facebookstories",e.Pagesmanager="pagesmanager",e.Twitter="twitter",e.Whatsapp="whatsapp",e.Whatsappbusiness="whatsappbusiness",e.Instagram="instagram",e.InstagramStories="instagramstories",e.Googleplus="googleplus",e.Email="email",e.Pinterest="pinterest",e.Linkedin="linkedin",e.Sms="sms",e.Telegram="telegram",e.Snapchat="snapchat",e.Messenger="messenger"})(oo||(oo={})),(e=>{e.BackgroundImage="shareBackgroundImage",e.BackgroundVideo="shareBackgroundVideo",e.StickerImage="shareStickerImage",e.BackgroundAndStickerImage="shareBackgroundAndStickerImage"})(no||(no={}));const ao={Button:({buttonStyle:e,onPress:t,iconSrc:r,textStyle:s,children:i})=>ke.createElement(fe.TouchableOpacity,{activeOpacity:.5,style:[to.button,e],onPress:t},ke.createElement(fe.Image,{style:to.icon,source:r}),ke.createElement(fe.Text,{style:[to.buttonText,s]},i)),ShareSheet:class extends ke.Component{componentDidMount(){this.backButtonHandler=this.backButtonHandler.bind(this),fe.BackHandler.addEventListener('hardwareBackPress',this.backButtonHandler)}componentWillUnmount(){fe.BackHandler.removeEventListener('hardwareBackPress',this.backButtonHandler)}backButtonHandler(){return!!this.props.visible&&(this.props.onCancel(),!0)}render(){const{style:e={},overlayStyle:t={},...r}=this.props;return ke.createElement(Qi,r,ke.createElement(fe.View,{style:[ro.actionSheetContainer,t]},ke.createElement(fe.TouchableOpacity,{style:ro.button,onPress:this.props.onCancel}),ke.createElement(eo,{visible:this.props.visible},ke.createElement(fe.View,{style:[ro.buttonContainer,e]},this.props.children))))}},Overlay:Qi,Sheet:eo,Social:{FACEBOOK:fe.NativeModules.RNShare.FACEBOOK||oo.Facebook,FACEBOOK_STORIES:fe.NativeModules.RNShare.FACEBOOKSTORIES||oo.FacebookStories,PAGESMANAGER:fe.NativeModules.RNShare.PAGESMANAGER||oo.Pagesmanager,TWITTER:fe.NativeModules.RNShare.TWITTER||oo.Twitter,WHATSAPP:fe.NativeModules.RNShare.WHATSAPP||oo.Whatsapp,WHATSAPPBUSINESS:fe.NativeModules.RNShare.WHATSAPPBUSINESS||oo.Whatsappbusiness,INSTAGRAM:fe.NativeModules.RNShare.INSTAGRAM||oo.Instagram,INSTAGRAM_STORIES:fe.NativeModules.RNShare.INSTAGRAMSTORIES||oo.InstagramStories,GOOGLEPLUS:fe.NativeModules.RNShare.GOOGLEPLUS||oo.Googleplus,EMAIL:fe.NativeModules.RNShare.EMAIL||oo.Email,PINTEREST:fe.NativeModules.RNShare.PINTEREST||oo.Pinterest,LINKEDIN:fe.NativeModules.RNShare.LINKEDIN||oo.Linkedin,SMS:fe.NativeModules.RNShare.SMS||oo.Sms,TELEGRAM:fe.NativeModules.RNShare.TELEGRAM||oo.Telegram,MESSENGER:fe.NativeModules.RNShare.MESSENGER||oo.Messenger,SNAPCHAT:fe.NativeModules.RNShare.SNAPCHAT||oo.Snapchat},open:e=>new Promise(((t,r)=>{io(e).then((()=>{if('ios'===fe.Platform.OS&&e.url&&!e.urls){const t=e.url;delete e.url,e.urls=[t],e.filename&&!e.filenames&&(e.filenames=[e.filename],delete e.filename)}fe.NativeModules.RNShare.open(e,(e=>r({error:e})),((s,i)=>s?t({success:s,message:i}):!1===e.failOnCancel?t({dismissedAction:!0,success:s,message:i}):void r(new Error('User did not share'))))})).catch((e=>r(e)))})),shareSingle(e){if('ios'===fe.Platform.OS||'android'===fe.Platform.OS)return new Promise(((t,r)=>{io(e).then((()=>{fe.NativeModules.RNShare.shareSingle(e,(e=>r({error:e})),((e,r)=>t({success:e,message:r})))})).catch((e=>r(e)))}));throw new Error('Not implemented')},isPackageInstalled(e){if('android'===fe.Platform.OS)return new Promise(((t,r)=>{fe.NativeModules.RNShare.isPackageInstalled(e,(e=>r({error:e})),(e=>t({isInstalled:e,message:'Package is Installed'})))}));throw new Error('Not implemented')}};class lo{constructor(){this._isOpen=!1,this._isWidgetConnected=!1}set isOpen(e){this._isOpen=e}get isOpen(){return this._isOpen}set isWidgetConnected(e){this._isWidgetConnected=e}get isWidgetConnected(){return this._isWidgetConnected}modalClosed(){this.isWidgetConnected=!1,this.isOpen=!1}}class co extends si{constructor(e,t){void 0===t&&(t={}),super(),this.appearanceManagerGetter=e,this.overrideStoryReaderOptions=t,this.modalPresentation=void 0,this.openStoryReaderWithOptions={},this.rpc=void 0,this.frameName='',this.rpcOnMessage=e=>{this.rpcBridge&&this.rpcBridge(e)},this.rpcBridge=null,this.rpcServerInstance=null,this._sourceInfo={listType:Ge.default,feed:null},this.modalPresentation=new lo,this.widgetId=++si.count,qi.use((()=>{this.emit("widgetLoaded")})),Ji.use((e=>{let{name:t,payload:r}=e;this.emit(t,r)})),Ki.use((e=>{this.emit('openedStoryReader',e)})),Gi.use((e=>{this.emit('closeStoryReader',e)})),Zi.use((async e=>{let t=!1,r={};Ui(),e.url?r={message:e.text,url:e.url}:e.files&&Array.isArray(e.files)&&(r={urls:e.files});try{let e=await ao.open(r);M(e)&&(!0===(s=e.success)||!1===s)&&(t=e.success)}catch(e){t=!1}finally{$i()}var s})),Ji.use((e=>{let{name:t,payload:r}=e;this.emit(t,r)})),Xi.use((e=>{console.log(e)}));let r=()=>this.closeStoryReaderOrLoader();this.on('openStoryReader',(e=>{this.modalPresentation.isOpen=!0,this.openStoryReaderWithOptions=e,fe.BackHandler.addEventListener("hardwareBackPress",r)})),this.on('openedStoryReader',(()=>{this.modalPresentation.isWidgetConnected=!0})),this.on('modalClosed',(()=>{fe.BackHandler.removeEventListener("hardwareBackPress",r),this.modalPresentation.modalClosed()}))}closeStoryReaderOrLoader(){return this.modalPresentation.isWidgetConnected?(this.closeConnectedReaderWidget(),this.modalPresentation.modalClosed(),!0):!!this.modalPresentation.isOpen&&(this.emit("closeStoryReader",this.openStoryReaderWithOptions),!0)}get storyReaderOptions(){let e=this.appearanceManagerGetter();return null!=e?{...e.storyReaderOptions,appearanceCommon:e.commonOptions,...this.overrideStoryReaderOptions,faviconApiUrl:os.faviconApiUrl}:{...xi,appearanceCommon:Pi,...this.overrideStoryReaderOptions,faviconApiUrl:os.faviconApiUrl}}get widgetSrcFile(){return Me}get widgetEntrypoint(){return`\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, shrink-to-fit=no">\n        <meta name="color-scheme" content="dark light">\n        <style type="text/css">${Ae}</style>\n      </head>\n      <div id="app"><div id="_app"></div></div>\n      <script type="text/javascript">${Me}</script>\n      <script type="text/javascript">\n        window.storiesList = (function () {\n          var self = window.storiesList || {};\n          self._e = self._e || [];\n          self.ready = self.ready || function (f) {self._e.push(f);};\n          return self;\n        }());\n\n        window.storyReader.ready(function () {\n          window.storyReader.init(${JSON.stringify(this.storyReaderOptions)});\n        });\n\n      </script>`}async mount(e,t){let r={allowTransparency:!0,overflowTouch:!1,backgroundColor:t.layout.backgroundColor,width:'auto',height:0,pageUrl:'',startHeight:0};r.startHeight=t.layout.height?t.layout.height:t.title?50+t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin:t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin,this.createView(e,r)}createView(e,t){'body'===e||document.querySelector(e)}extend(e,t){for(var r in t)e[r]&&'object'==typeof e[r]?this.extend(e[r],t[r]):e[r]=t[r]}genKey(){for(var e='',t=0;t<5;t++)e+=Math.ceil(15*Math.random()).toString(16);return e}mountView(e,t,r){this.frameName='fXD'+this.genKey();let s=document.createElement('div');s.innerHTML='<iframe name="'+this.frameName+'" '+(r||'')+'></iframe>';let i=s.firstChild,o=this;return setTimeout((()=>{i.frameBorder='0',t&&o.extend(i,t),e.insertBefore(i,e.firstChild)}),0),i}get containerOptions(){return{style:{backgroundColor:'transparent',position:'relative',height:'100%',width:'100%'}}}get viewOptions(){this.frameName||(this.frameName='fXD'+this.genKey());let e={extraCss:null,extraJs:null},t={maxWidth:0,startHeight:70,storiesHeight:70,minWidth:150,scrolling:!1,hidden:!1};t.startHeight=e.storiesLayoutHeight?parseFloat(e.storiesLayoutHeight):e.storiesTitle?50+parseFloat(e.storiesHeight||t.storiesHeight)+parseFloat(e.storiesListTopPadding)+parseFloat(e.storiesListBottomPadding)+parseFloat(e.storiesListBottomMargin):parseFloat(e.storiesHeight||t.storiesHeight)+parseFloat(e.storiesListTopPadding)+parseFloat(e.storiesListBottomPadding)+parseFloat(e.storiesListBottomMargin);let r=parseInt('100%',10),s=r?Math.max(t.minWidth,Math.min(1e4,r))+'px':'100%';return Boolean(!0).toString(),-1!=s.indexOf('%')||parseInt(s),{style:{backgroundColor:'transparent',position:'absolute',left:0,right:0,top:0,height:"100%",width:'100%'},source:{html:this.widgetEntrypoint,baseUrl:'https://sdk.inappstory.com'},onMessage:this.rpcOnMessage}}createRpcServer(e){let t=new _i(e);this.rpcBridge=t.createOnMessage(),this.rpcServerInstance=q(Di,t)}destroyRpcServer(){this.rpcServerInstance&&this.rpcServerInstance.destructor()}async init(e,t){var r,s,i,o;let n={storiesHeight:(null===(r=t.card)||void 0===r?void 0:r.height)||70,storiesLayoutHeight:(null===(s=t.layout)||void 0===s?void 0:s.height)||0,storiesBackgroundColor:(null===(i=t.layout)||void 0===i?void 0:i.backgroundColor)||'transparent',storiesListTopPadding:t.topPadding||20,storiesListBottomPadding:t.bottomPadding||20,storiesListBottomMargin:t.bottomMargin||20,storiesTitle:(null===(o=t.title)||void 0===o?void 0:o.content)||'',extraCss:t.extraCss||null,extraJs:null},a={allowTransparency:!0,overflowTouch:!1};a.backgroundColor=n.storiesBackgroundColor;var l={startHeight:70,minWidth:150,storiesHeight:70};l.startHeight=n.storiesLayoutHeight?parseFloat(n.storiesLayoutHeight):n.storiesTitle?50+parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin):parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin),document.querySelector('body'),document.querySelector('html');let d=this,c={event:(e,t)=>{d.emit(e,t)}};return n.extraJs=null,a.no_finish_loading=!0,this._init(e,a,n,t,c,l,(()=>{}),null,null)}getWidgetDocument(e){let t=`${process.env.BASE_URL}/v0.3.10/dist/js/storiesList.js`;return t=Me,`\n        <script type="text/javascript" src="${t}"></script>\n        <div id="app"><div id="_app"></div></div>\n        <script type="text/javascript">\n          window.storyReader.init(${JSON.stringify(e)});\n        </script>\n`}async _init(e,t,s,i,o,n,a,l,d){o.event=(e,t)=>this.emit(e,t);let c=super._init(e,t,s,i,o,n,((e,t,r)=>{this.rpc=r}),l,d);return this.on('clickOnStory',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStory)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStory(e))})),this.on('clickOnStoryDeepLink',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryDeepLink)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryDeepLink(e))})),this.on('syncStore',(()=>{})),c}onStoryOpened(e){this.rpc.callMethod('onStoryOpened',e)}syncStoreHandle(e){this.rpc.callMethod('onSyncStore',e)}get sourceInfo(){return this._sourceInfo}openReader(e,t){this._sourceInfo=t,Wi(e)}closeConnectedReaderWidget(){Vi()}setStories(e){Hi(e)}setFonts(e){Bi(e)}rpcCb(e){zi(e)}setSoundOn(e){ji(e)}destructor(){}}const uo={title:{content:'Favorite',font:'1.4rem/1.2 InternalPrimaryFont',color:"white"}},ho="FxDomainWidgetStoryFavorite",po=I(`server${ho}`),fo=I(`client${ho}`);let go={serverFxDomain:po,clientFxDomain:fo},mo=fo.effect(ho+"setStories"),yo=fo.effect(ho+"setFonts"),vo=fo.effect(ho+"onOpenReader"),So=fo.effect(ho+"onCloseReader"),wo=po.effect(ho+"widgetLoaded"),Lo=po.effect(ho+"onReaderOpened"),Co=po.effect(ho+"onReaderClosed"),bo=po.effect(ho+"widgetEvent"),Ro=fo.effect(ho+"widgetEventCb"),ko=po.effect(ho+"clickOnStoryInternalEvent"),_o=po.effect(ho+"debug");class Io extends si{constructor(e){super(),this.appearanceManagerGetter=e,this.modalPresentation=void 0,this.openStoryFavoriteReaderWithOptions={},this.rpc=void 0,this.frameName='',this.rpcOnMessage=e=>{this.rpcBridge&&this.rpcBridge(e)},this.rpcBridge=null,this.rpcServerInstance=null,this._sourceInfo={listType:Ge.default,feed:null},this.modalPresentation=new lo,this.widgetId=++si.count,wo.use((()=>{this.emit("widgetLoaded")})),bo.use((e=>{let{name:t,payload:r}=e;this.emit(t,r)})),Lo.use((e=>{this.emit('openedStoryFavoriteReader',e)})),Co.use((e=>{this.emit('closeStoryFavoriteReader',e)})),ko.use((e=>{this.emit('clickOnStoryInternal',e)})),bo.use((e=>{let{name:t,payload:r}=e;this.emit(t,r)})),_o.use((e=>{console.log(e)}));let t=()=>this.modalPresentation.isWidgetConnected?(this.closeConnectedReaderWidget(),this.modalPresentation.modalClosed(),!0):!!this.modalPresentation.isOpen&&(this.emit("closeStoryFavoriteReader",this.openStoryFavoriteReaderWithOptions),!0);this.on('openStoryFavoriteReader',(e=>{this.modalPresentation.isOpen=!0,fe.BackHandler.addEventListener("hardwareBackPress",t),this.openStoryFavoriteReaderWithOptions=e})),this.on('openedStoryFavoriteReader',(()=>{this.modalPresentation.isWidgetConnected=!0})),this.on('modalClosed',(()=>{fe.BackHandler.removeEventListener("hardwareBackPress",t),this.modalPresentation.modalClosed()}))}get storyFavoriteReaderOptions(){let e=this.appearanceManagerGetter();return null!=e?{options:e.storyFavoriteReaderOptions,storiesListOptions:e.storiesListOptions}:{options:uo,storiesListOptions:Ve}}get widgetSrcFile(){return xe}get widgetEntrypoint(){return`\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, shrink-to-fit=no">\n        <meta name="color-scheme" content="dark light">\n        <style type="text/css">${Pe}</style>\n      </head>\n      <div id="app"><div id="_app"></div></div>\n      <script type="text/javascript">${xe}</script>\n      <script type="text/javascript">\n        window.storiesList = (function () {\n          var self = window.storiesList || {};\n          self._e = self._e || [];\n          self.ready = self.ready || function (f) {self._e.push(f);};\n          return self;\n        }());\n\n        window.storyFavoriteReader.ready(function () {\n          window.storyFavoriteReader.init(${JSON.stringify(this.storyFavoriteReaderOptions)});\n          // options\n        });\n\n      </script>`}async mount(e,t){let r={allowTransparency:!0,overflowTouch:!1,backgroundColor:t.layout.backgroundColor,width:'auto',height:0,pageUrl:'',startHeight:0};r.startHeight=t.layout.height?t.layout.height:t.title?50+t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin:t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin,this.createView(e,r)}createView(e,t){'body'===e||document.querySelector(e)}extend(e,t){for(var r in t)e[r]&&'object'==typeof e[r]?this.extend(e[r],t[r]):e[r]=t[r]}genKey(){for(var e='',t=0;t<5;t++)e+=Math.ceil(15*Math.random()).toString(16);return e}mountView(e,t,r){this.frameName='fXD'+this.genKey();let s=document.createElement('div');s.innerHTML='<iframe name="'+this.frameName+'" '+(r||'')+'></iframe>';let i=s.firstChild,o=this;return setTimeout((()=>{i.frameBorder='0',t&&o.extend(i,t),e.insertBefore(i,e.firstChild)}),0),i}get containerOptions(){return{style:{backgroundColor:'transparent',position:'relative',height:'100%',width:'100%'}}}get viewOptions(){this.frameName||(this.frameName='fXD'+this.genKey());let e={extraCss:null,extraJs:null},t={maxWidth:0,startHeight:70,storiesHeight:70,minWidth:150,scrolling:!1,hidden:!1};t.startHeight=e.storiesLayoutHeight?parseFloat(e.storiesLayoutHeight):e.storiesTitle?50+parseFloat(e.storiesHeight||t.storiesHeight)+parseFloat(e.storiesListTopPadding)+parseFloat(e.storiesListBottomPadding)+parseFloat(e.storiesListBottomMargin):parseFloat(e.storiesHeight||t.storiesHeight)+parseFloat(e.storiesListTopPadding)+parseFloat(e.storiesListBottomPadding)+parseFloat(e.storiesListBottomMargin);let r=parseInt('100%',10),s=r?Math.max(t.minWidth,Math.min(1e4,r))+'px':'100%';return Boolean(!0).toString(),-1!=s.indexOf('%')||parseInt(s),{style:{backgroundColor:'transparent',position:'absolute',left:0,right:0,top:0,height:"100%",width:'100%'},source:{html:this.widgetEntrypoint,baseUrl:'https://sdk.inappstory.com'},onMessage:this.rpcOnMessage}}createRpcServer(e){let t=new _i(e);this.rpcBridge=t.createOnMessage(),this.rpcServerInstance=q(go,t)}destroyRpcServer(){this.rpcServerInstance&&this.rpcServerInstance.destructor()}async init(e,t){var r,s,i,o;let n={storiesHeight:(null===(r=t.card)||void 0===r?void 0:r.height)||70,storiesLayoutHeight:(null===(s=t.layout)||void 0===s?void 0:s.height)||0,storiesBackgroundColor:(null===(i=t.layout)||void 0===i?void 0:i.backgroundColor)||'transparent',storiesListTopPadding:t.topPadding||20,storiesListBottomPadding:t.bottomPadding||20,storiesListBottomMargin:t.bottomMargin||20,storiesTitle:(null===(o=t.title)||void 0===o?void 0:o.content)||'',extraCss:t.extraCss||null,extraJs:null},a={allowTransparency:!0,overflowTouch:!1};a.backgroundColor=n.storiesBackgroundColor;var l={startHeight:70,minWidth:150,storiesHeight:70};l.startHeight=n.storiesLayoutHeight?parseFloat(n.storiesLayoutHeight):n.storiesTitle?50+parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin):parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin),document.querySelector('body'),document.querySelector('html');let d=this,c={event:(e,t)=>{d.emit(e,t)}};return n.extraJs=null,a.no_finish_loading=!0,this._init(e,a,n,t,c,l,(()=>{}),null,null)}getWidgetDocument(e){let t=`${process.env.BASE_URL}/v0.3.10/dist/js/storiesList.js`;return t=xe,`\n        <script type="text/javascript" src="${t}"></script>\n        <div id="app"><div id="_app"></div></div>\n        <script type="text/javascript">\n          window.storyFavoriteReader.init(${JSON.stringify(e)});\n        </script>\n`}async _init(e,t,s,i,o,n,a,l,d){o.event=(e,t)=>this.emit(e,t);let c=super._init(e,t,s,i,o,n,((e,t,r)=>{this.rpc=r}),l,d);return this.on('clickOnStory',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStory)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStory(e))})),this.on('clickOnStoryDeepLink',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryDeepLink)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryDeepLink(e))})),this.on('syncStore',(()=>{})),c}onStoryOpened(e){this.rpc.callMethod('onStoryOpened',e)}syncStoreHandle(e){this.rpc.callMethod('onSyncStore',e)}get sourceInfo(){return this._sourceInfo}openReader(e,t){this._sourceInfo=t,vo(e)}closeConnectedReaderWidget(){So()}setStories(e){mo(e)}setFonts(e){yo(e)}rpcCb(e){Ro(e)}destructor(){}}const Oo='android'===fe.Platform.OS,Eo="The package 'rn-android-keyboard-adjust' doesn't seem to be linked. Make sure: \n\n"+fe.Platform.select({default:''})+"- You rebuilt the app after installing the package\n- You are not using Expo Go\n",Mo=fe.NativeModules.RnAndroidKeyboardAdjust?fe.NativeModules.RnAndroidKeyboardAdjust:new Proxy({},{get(){throw new Error(Eo)}});var Ao={__proto__:null,setAdjustNothing:X,setAdjustPan:Y,setAdjustResize:Q,setAdjustUnspecified:ee,setAlwaysHidden:te,setAlwaysVisible:re,setVisible:se,setHidden:ie,setUnchanged:oe,getSoftInputMode:ne,setSoftInputMode:ae,default:{setAdjustNothing:X,setAdjustPan:Y,setAdjustResize:Q,setAdjustUnspecified:ee,setAlwaysHidden:te,setAlwaysVisible:re,setVisible:se,setHidden:ie,setUnchanged:oe,getSoftInputMode:ne,setSoftInputMode:ae}};let xo,Po;(e=>{e.LEFT="left",e.RIGHT="right"})(xo||(xo={})),(e=>{e.FLAT="flat",e.COVER="cover",e.CUBE="cube"})(Po||(Po={}));const Fo={closeButtonPosition:xo.RIGHT,scrollStyle:Po.FLAT,loader:{default:{color:"transparent",accentColor:"white"},custom:null},slideBorderRadius:0,recycleStoriesList:!1,closeOnLastSlideByTimer:!0,faviconApiUrl:"",closeButton:{svgSrc:{baseState:"<svg width=\"15\" height=\"15\" viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M6.96425 7.4645L0.142822 0.650209L0.649965 0.143066L7.46425 6.9645L14.2857 0.143066L14.7928 0.650209L7.97139 7.4645L14.7928 14.2859L14.2857 14.7931L7.46425 7.97164L0.649965 14.7931L0.142822 14.2859L6.96425 7.4645Z\" fill=\"white\"/>\n</svg>"}},likeButton:{svgSrc:{baseState:"<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M24.6527 13.0592C24.4045 13.5792 24.109 13.8392 23.7427 13.851C23.9402 14.0899 24.085 14.3678 24.1681 14.6664C24.2754 14.9702 24.3315 15.2897 24.3336 15.6119C24.3348 15.9936 24.2566 16.3714 24.1041 16.7214C23.9515 17.0713 23.7278 17.3858 23.4472 17.6446C23.6473 18.006 23.7492 18.4135 23.7427 18.8264C23.742 19.2612 23.6408 19.6899 23.4472 20.0792C23.2852 20.4586 23.0029 20.7743 22.6436 20.9773C22.6984 21.2896 22.7261 21.6058 22.7263 21.9228C22.7263 23.8255 21.6509 24.771 19.4763 24.771H17.4318C15.451 24.6867 13.4962 24.2878 11.6409 23.5892L11.1563 23.4001L10.5536 23.1873L9.96267 22.9864L9.31267 22.7973L8.75722 22.691C8.58024 22.6764 8.40238 22.6764 8.2254 22.691H7.68176V11.6764H8.27267C8.46193 11.6776 8.64992 11.6456 8.82813 11.5819C9.05683 11.4341 9.2671 11.2595 9.45449 11.0619C9.69085 10.861 9.90358 10.6483 10.1045 10.4592C10.3422 10.2191 10.5671 9.9666 10.7781 9.7028L11.369 8.98189L11.9009 8.28462L12.2909 7.76462C12.9054 6.99644 13.3427 6.47644 13.5909 6.21644C14.0779 5.68876 14.4234 5.04639 14.5954 4.34917C14.8081 3.5928 14.9854 2.88371 15.1154 2.21008C15.1935 1.67828 15.4185 1.17889 15.7654 0.768253C16.1631 0.714621 16.5679 0.758694 16.9447 0.896661C17.3215 1.03463 17.659 1.26233 17.9281 1.56008C18.3401 2.31941 18.5286 3.17988 18.4718 4.04189C18.4115 4.993 18.1581 5.92186 17.7272 6.77189C17.272 7.61247 16.9944 8.5377 16.9118 9.49008H22.8209C23.3921 9.51353 23.9334 9.75175 24.3365 10.1571C24.7398 10.5625 24.9751 11.1051 24.9954 11.6764C24.9759 12.1558 24.8593 12.6261 24.6527 13.0592Z\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n<path d=\"M5.90904 11.8184H1.18176V22.4547H5.90904V11.8184Z\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n</svg>",activeState:"<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M24.6527 13.0592C24.4045 13.5792 24.109 13.8392 23.7427 13.851C23.9402 14.0899 24.085 14.3678 24.1681 14.6664C24.2754 14.9702 24.3315 15.2897 24.3336 15.6119C24.3348 15.9936 24.2566 16.3714 24.1041 16.7214C23.9515 17.0713 23.7278 17.3858 23.4472 17.6446C23.6473 18.006 23.7492 18.4135 23.7427 18.8264C23.742 19.2612 23.6408 19.6899 23.4472 20.0792C23.2852 20.4586 23.0029 20.7743 22.6436 20.9773C22.6984 21.2896 22.7261 21.6058 22.7263 21.9228C22.7263 23.8255 21.6509 24.771 19.4763 24.771H17.4318C15.451 24.6867 13.4962 24.2878 11.6409 23.5892L11.1563 23.4001L10.5536 23.1873L9.96267 22.9864L9.31267 22.7973L8.75722 22.691C8.58024 22.6764 8.40238 22.6764 8.2254 22.691H7.68176V11.6764H8.27267C8.46193 11.6776 8.64992 11.6456 8.82813 11.5819C9.05683 11.4341 9.2671 11.2595 9.45449 11.0619C9.69085 10.861 9.90358 10.6483 10.1045 10.4592C10.3422 10.2191 10.5671 9.9666 10.7781 9.7028L11.369 8.98189L11.9009 8.28462L12.2909 7.76462C12.9054 6.99644 13.3427 6.47644 13.5909 6.21644C14.0779 5.68876 14.4234 5.04639 14.5954 4.34917C14.8081 3.5928 14.9854 2.88371 15.1154 2.21008C15.1935 1.67828 15.4185 1.17889 15.7654 0.768253C16.1631 0.714621 16.5679 0.758694 16.9447 0.896661C17.3215 1.03463 17.659 1.26233 17.9281 1.56008C18.3401 2.31941 18.5286 3.17988 18.4718 4.04189C18.4115 4.993 18.1581 5.92186 17.7272 6.77189C17.272 7.61247 16.9944 8.5377 16.9118 9.49008H22.8209C23.3921 9.51353 23.9334 9.75175 24.3365 10.1571C24.7398 10.5625 24.9751 11.1051 24.9954 11.6764C24.9759 12.1558 24.8593 12.6261 24.6527 13.0592Z\" fill=\"white\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n<path d=\"M5.90904 11.8184H1.18176V22.4547H5.90904V11.8184Z\" fill=\"white\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n</svg>"}},dislikeButton:{svgSrc:{baseState:"<svg width=\"27\" height=\"26\" viewBox=\"0 0 27 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M1.95728 12.9407C2.20547 12.4207 2.50092 12.1607 2.86728 12.1489C2.67612 11.9058 2.53186 11.6293 2.44183 11.3334C2.34019 11.0282 2.28443 10.7096 2.27637 10.388C2.27385 10.0067 2.35266 9.62916 2.50754 9.28068C2.66242 8.9322 2.88981 8.62075 3.17456 8.36709C2.96718 8.00817 2.86098 7.59974 2.86728 7.18527C2.86805 6.75051 2.96916 6.32181 3.16274 5.93254C3.31795 5.55004 3.59121 5.22709 3.94274 5.01072C3.91641 4.70402 3.91641 4.39561 3.94274 4.0889C3.94274 2.18618 5.01819 1.24072 7.19274 1.24072H9.17819C11.159 1.32494 13.1138 1.72386 14.9691 2.42254L15.4655 2.59981L16.0564 2.81254L16.6591 3.01345L17.2973 3.20254L17.8527 3.3089C18.0297 3.32349 18.2075 3.32349 18.3846 3.3089H18.9282V14.2171H18.3846C18.1756 14.2289 17.9709 14.281 17.7818 14.3707C17.5397 14.497 17.3136 14.6517 17.1082 14.8316L16.4582 15.4344C16.2205 15.6744 15.9956 15.927 15.7846 16.1907L15.1937 16.9116L14.6618 17.6089L14.2718 18.1289C13.6573 18.8971 13.22 19.4171 12.9718 19.6771C12.4848 20.2048 12.1392 20.8471 11.9673 21.5444C11.7546 22.3007 11.5773 23.0098 11.4473 23.6835C11.3757 24.2149 11.1544 24.715 10.8091 25.1253C10.4238 25.1872 10.0292 25.1575 9.65757 25.0384C9.28589 24.9193 8.94755 24.7142 8.67001 24.4398C8.25902 23.6844 8.07052 22.8279 8.12637 21.9698C8.19097 21 8.4566 20.0542 8.90637 19.1926C9.36165 18.3519 9.63922 17.4267 9.72183 16.4744H3.81274C3.5291 16.4711 3.24901 16.4108 2.98914 16.2971C2.72926 16.1834 2.4949 16.0187 2.30001 15.8126C2.08491 15.6264 1.91004 15.3983 1.78609 15.1423C1.66213 14.8862 1.5917 14.6076 1.5791 14.3235C1.6097 13.8416 1.73839 13.371 1.95728 12.9407Z\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n<path d=\"M25.4282 3.54541H20.7009V14.1818H25.4282V3.54541Z\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n</svg>",activeState:"<svg width=\"27\" height=\"26\" viewBox=\"0 0 27 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M1.95728 12.9407C2.20547 12.4207 2.50092 12.1607 2.86728 12.1489C2.67612 11.9058 2.53186 11.6293 2.44183 11.3334C2.34019 11.0282 2.28443 10.7096 2.27637 10.388C2.27385 10.0067 2.35266 9.62916 2.50754 9.28068C2.66242 8.9322 2.88981 8.62075 3.17456 8.36709C2.96718 8.00817 2.86098 7.59974 2.86728 7.18527C2.86805 6.75051 2.96916 6.32181 3.16274 5.93254C3.31795 5.55004 3.59121 5.22709 3.94274 5.01072C3.91641 4.70402 3.91641 4.39561 3.94274 4.0889C3.94274 2.18618 5.01819 1.24072 7.19274 1.24072H9.17819C11.159 1.32494 13.1138 1.72386 14.9691 2.42254L15.4655 2.59981L16.0564 2.81254L16.6591 3.01345L17.2973 3.20254L17.8527 3.3089C18.0297 3.32349 18.2075 3.32349 18.3846 3.3089H18.9282V14.2171H18.3846C18.1756 14.2289 17.9709 14.281 17.7818 14.3707C17.5397 14.497 17.3136 14.6517 17.1082 14.8316L16.4582 15.4344C16.2205 15.6744 15.9956 15.927 15.7846 16.1907L15.1937 16.9116L14.6618 17.6089L14.2718 18.1289C13.6573 18.8971 13.22 19.4171 12.9718 19.6771C12.4848 20.2048 12.1392 20.8471 11.9673 21.5444C11.7546 22.3007 11.5773 23.0098 11.4473 23.6835C11.3757 24.2149 11.1544 24.715 10.8091 25.1253C10.4238 25.1872 10.0292 25.1575 9.65757 25.0384C9.28589 24.9193 8.94755 24.7142 8.67001 24.4398C8.25902 23.6844 8.07052 22.8279 8.12637 21.9698C8.19097 21 8.4566 20.0542 8.90637 19.1926C9.36165 18.3519 9.63922 17.4267 9.72183 16.4744H3.81274C3.5291 16.4711 3.24901 16.4108 2.98914 16.2971C2.72926 16.1834 2.4949 16.0187 2.30001 15.8126C2.08491 15.6264 1.91004 15.3983 1.78609 15.1423C1.66213 14.8862 1.5917 14.6076 1.5791 14.3235C1.6097 13.8416 1.73839 13.371 1.95728 12.9407Z\" fill=\"white\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n<path d=\"M25.4282 3.54541H20.7009V14.1818H25.4282V3.54541Z\" fill=\"white\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n</svg>"}},favoriteButton:{svgSrc:{baseState:"<svg width=\"22\" height=\"26\" viewBox=\"0 0 22 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M17.66 3.81982H4.81116C4.25887 3.81982 3.81116 4.26754 3.81116 4.81982V21.2171C3.81116 22.062 4.83134 22.4865 5.4307 21.8911L11.24 16.1198L17.0401 21.8888C17.6393 22.4847 18.66 22.0603 18.66 21.2152L18.66 4.81983C18.66 4.26754 18.2123 3.81982 17.66 3.81982Z\" stroke=\"white\"/></svg>",activeState:"<svg width=\"22\" height=\"26\" viewBox=\"0 0 22 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M17.66 3.81982H4.81116C4.25887 3.81982 3.81116 4.26754 3.81116 4.81982V21.2171C3.81116 22.062 4.83134 22.4865 5.4307 21.8911L11.24 16.1198L17.0401 21.8888C17.6393 22.4847 18.66 22.0603 18.66 21.2152L18.66 4.81983C18.66 4.26754 18.2123 3.81982 17.66 3.81982Z\" fill=\"white\" stroke=\"white\"/></svg>"}},muteButton:{svgSrc:{baseState:"<svg width=\"22\" height=\"26\" viewBox=\"0 0 22 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M14.2206 22.3918C14.0256 22.3451 12.4651 21.4429 10.7096 20.3773L7.54973 18.456H5.50554H3.46136L3.2429 18.2693L3.02444 18.0827L3.00883 12.8401C2.98543 7.36426 2.98542 7.35648 3.31312 7.14646C3.43015 7.07646 3.55499 7.16202 4.09334 7.7065C4.69411 8.29764 4.72532 8.34431 4.52246 8.34431H4.3118V12.739V17.1337H5.67719H7.04258V13.8902V10.6389L11.8878 15.4614L16.733 20.2839L16.6939 20.6806C16.5769 21.8707 15.3598 22.7107 14.2206 22.3918Z\" fill=\"white\"/>\n<path d=\"M11.1933 13.3847C5.39627 7.59765 3.89824 6.07312 3.82802 5.83977C3.65637 5.2564 4.24934 4.60303 4.86571 4.7197C5.09198 4.75859 6.23891 5.87088 12.4495 12.0624L19.7602 19.3506V19.7317C19.7602 20.0507 19.7212 20.144 19.4949 20.3696C19.2686 20.5951 19.175 20.634 18.8551 20.634H18.4728L11.1933 13.3847Z\" fill=\"white\"/>\n<path d=\"M12.5196 10.6545L8.35327 6.50095L9.00866 6.11204C9.36756 5.90203 10.6471 5.1242 11.8564 4.40083C13.6587 3.30409 14.1191 3.06297 14.4468 3.0163C15.2894 2.89962 16.2101 3.42077 16.5534 4.21415C16.7172 4.60306 16.7172 4.63417 16.7016 9.70559L16.6782 14.8003L12.5196 10.6545Z\" fill=\"white\"/>\n</svg>",activeState:"<svg width=\"22\" height=\"26\" viewBox=\"0 0 22 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M12.0512 22.4247C11.886 22.3646 10.1891 21.4561 8.28942 20.3974L4.83549 18.4677H2.59795H0.367918L0.187713 18.28L0 18.0998V12.7687V7.44518L0.232764 7.24996L0.465529 7.05474H2.67304H4.88805L8.13174 5.23767C9.91877 4.24655 11.5556 3.34552 11.7809 3.24041C12.8246 2.75986 14.1311 3.19535 14.6567 4.19399L14.8669 4.59194V12.7612C14.8669 21.8616 14.9044 21.1858 14.3338 21.809C13.8082 22.3796 12.772 22.6575 12.0512 22.4247ZM13.0874 21.0807C13.4478 20.893 13.4328 21.2233 13.4403 12.7762V4.78716L13.215 4.56191C12.8171 4.16395 12.7195 4.2015 9.07031 6.23631L5.78908 8.06839L5.78157 12.7687V17.4616L9.10034 19.3162C12.5242 21.2308 12.6819 21.2984 13.0874 21.0807ZM4.35495 12.7612V8.33119H2.89078H1.42662V12.7612V17.1912H2.89078H4.35495V12.7612Z\" fill=\"white\"/>\n<path d=\"M19.3045 16.5456C18.9516 16.2528 18.9891 15.9975 19.4471 15.4794C20.1304 14.7135 20.4683 13.9552 20.5434 13.0241C20.626 12.018 20.2355 10.9443 19.4847 10.1333C19.0116 9.61525 18.9591 9.36747 19.2519 9.02958C19.4021 8.85689 19.4922 8.81934 19.785 8.81934C20.1304 8.81934 20.1604 8.84187 20.626 9.33743C21.2041 9.96064 21.7222 10.9593 21.8949 11.7852C22.2328 13.3845 21.6321 15.2767 20.4382 16.3879C19.9727 16.8159 19.6724 16.8535 19.3045 16.5456Z\" fill=\"white\"/>\n<path d=\"M17.2246 14.6384C17.0218 14.5558 16.8191 14.278 16.8191 14.0753C16.8191 13.9927 16.9317 13.7599 17.0744 13.5647C17.5174 12.9415 17.5174 12.5285 17.0744 12.0029C16.9317 11.8377 16.8191 11.635 16.8191 11.5599C16.8191 11.0869 17.3071 10.734 17.7577 10.8841C18.0655 10.9817 18.4334 11.3872 18.6512 11.8527C18.8914 12.3859 18.8689 13.1968 18.5986 13.7524C18.2232 14.5108 17.7201 14.8411 17.2246 14.6384Z\" fill=\"white\"/>\n</svg>"}},shareButton:{svgSrc:{baseState:"<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M14.7727 4.84545C14.7727 5.43636 14.8909 6.02727 15.0091 6.5L8.98182 9.92727C8.03636 8.86364 6.61818 8.15455 5.08182 8.15455C2.36364 8.03636 0 10.2818 0 13C0 15.7182 2.24545 17.8455 5.08182 17.8455C6.61818 17.8455 8.03636 17.1364 8.98182 16.0727L15.0091 19.3818C14.7727 19.8545 14.7727 20.4455 14.7727 21.0364C14.7727 23.7545 17.0182 25.8818 19.8545 25.8818C22.6909 25.8818 24.9364 23.6364 24.9364 21.0364C24.9364 18.3182 22.6909 16.0727 19.8545 16.0727C18.3182 16.0727 16.9 16.7818 15.9545 17.8455L9.92727 14.5364C10.0455 14.1818 10.1636 13.5909 10.1636 13C10.1636 12.4091 10.0455 11.8182 9.92727 11.3455L15.9545 8.03636C16.9 9.1 18.3182 9.80909 19.8545 9.80909C22.6909 9.80909 24.9364 7.56364 24.9364 4.84545C24.9364 2.12727 22.6909 0 19.8545 0C17.0182 0 14.7727 2.24545 14.7727 4.84545ZM5.08182 16.1909C3.30909 16.1909 1.77273 14.7727 1.77273 13C1.77273 11.2273 3.30909 9.80909 5.08182 9.80909C6.85455 9.80909 8.39091 11.2273 8.39091 13C8.39091 14.7727 6.97273 16.1909 5.08182 16.1909ZM19.8545 17.8455C21.6273 17.8455 23.1636 19.2636 23.1636 21.0364C23.1636 22.8091 21.6273 24.2273 19.8545 24.2273C18.0818 24.2273 16.5455 22.8091 16.5455 21.0364C16.5455 19.3818 18.0818 17.8455 19.8545 17.8455ZM19.8545 1.77273C21.6273 1.77273 23.1636 3.19091 23.1636 4.96364C23.1636 6.73636 21.6273 8.15455 19.8545 8.15455C18.0818 8.15455 16.5455 6.73636 16.5455 4.96364C16.5455 3.19091 18.0818 1.77273 19.8545 1.77273Z\" fill=\"white\"/>\n</svg>"}}},To={title:{content:'\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u0438'}};let No;(e=>{e.DEFAULT="default",e.CUSTOM_CARD="customCard",e.CUSTOM_WIDGET="customWidget"})(No||(No={}));const Do={goodsWidgetRenderingType:No.DEFAULT,loader:{default:{color:null,accentColor:null},custom:null}};var Ho=e=>(e=>!!e&&'object'==typeof e)(e)&&!(e=>{var t={}.toString.call(e);return'[object RegExp]'===t||'[object Date]'===t||(e=>e.$$typeof===Bo)(e)})(e),Bo='function'==typeof Symbol&&Symbol.for?Symbol.for('react.element'):60103;he.all=(e,t)=>{if(!Array.isArray(e))throw new Error('first argument should be an array');return e.reduce(((e,r)=>he(e,r,t)),{})};var jo=he;let Wo='undefined'!=typeof window?Re.useLayoutEffect:Re.useEffect;const Vo=b(),Uo=R({storyManager:null,appearanceManager:null}).on(Vo,((e,t)=>t));var $o;exports.AndroidWindowSoftInputMode=void 0,($o=exports.AndroidWindowSoftInputMode||(exports.AndroidWindowSoftInputMode={})).AdjustNothing="AdjustNothing",$o.AdjustPan="AdjustPan",$o.AdjustResize="AdjustResize",$o.AdjustUnspecified="AdjustUnspecified",$o.AlwaysHidden="AlwaysHidden",$o.AlwaysVisible="AlwaysVisible",$o.Visible="Visible",$o.Hidden="Hidden",$o.Unchanged="Unchanged",exports.AppearanceManager=class{constructor(){this._commonOptions=Pi,this._storiesListOptions=Ve,this._storyReaderOptions=Fo,this._storyFavoriteReaderOptions=To,this._goodsWidgetOptions=Do}setCommonOptions(e){return this._commonOptions=jo(this._commonOptions,e),this}get commonOptions(){return this._commonOptions}setStoriesListOptions(e){return this._storiesListOptions=jo(this._storiesListOptions,e),this}get storiesListOptions(){return this._storiesListOptions}setStoryReaderOptions(e){return this._storyReaderOptions=jo(this._storyReaderOptions,e),this}get storyReaderOptions(){return this._storyReaderOptions}setStoryFavoriteReaderOptions(e){return this._storyFavoriteReaderOptions=jo(this._storyFavoriteReaderOptions,e),this}get storyFavoriteReaderOptions(){return this._storyFavoriteReaderOptions}setGoodsWidgetOptions(e){return this._goodsWidgetOptions=jo(this._goodsWidgetOptions,e),this}get goodsWidgetOptions(){return this._goodsWidgetOptions}},exports.StoriesList=e=>{let{storyManager:t,appearanceManager:s,feed:i,onLoadStart:o,onLoadEnd:n,testKey:a,viewModelExporter:l}=e,[d,c]=pe.useState(null);pe.useEffect((()=>{if(null!=t&&null!=s){let{widget:e,widgetLoadedPromise:d}=t.createWidgetStoriesList(s,i,a);e.on(exports.StoriesListEvents.START_LOADER,(()=>{o&&r(o)&&o()})),e.on(exports.StoriesListEvents.END_LOADER,(e=>{n&&r(n)&&n(e)})),c(e),null!=l&&r(l)&&l(e),d.then((()=>{t.loadStoriesListData(e,s)}))}return()=>{d&&d.destructor()}}),[]);let u=pe.useCallback((e=>{null!=e&&null!=d&&(null==d||d.createRpcServer(e))}),[d]),[h,p]=pe.useState(!1),f=pe.useRef({dx:0,dy:0}).current,g=pe.useRef(fe.PanResponder.create({onPanResponderTerminationRequest:()=>!0,onPanResponderReject(){f.dx=f.dy=0},onPanResponderRelease(){f.dx=f.dy=0},onPanResponderTerminate(){f.dx=f.dy=0},onPanResponderEnd(){f.dx=f.dy=0},onMoveShouldSetPanResponder:(e,t)=>{if(Math.abs(t.dx)>Math.abs(t.dy)&&Math.abs(t.vx)>Math.abs(t.vy))return f.dx=f.dy=0,!0;f.dx=f.dx+Math.abs(t.dx),f.dy=f.dy+Math.abs(t.dy);let r=f.dx>=15||f.dy>=15,s=Math.abs(f.dx)>=Math.abs(f.dy)&&r;return!s&&r&&(f.dx=f.dy=0),s},onShouldBlockNativeResponder:()=>!0})).current;return Re.createElement(Re.Fragment,null,d&&Re.createElement(fe.View,Object.assign({},null==d?void 0:d.containerOptions,{onLayout:e=>{var t;let{nativeEvent:r}=e;null!=r&&null!==(t=r.layout)&&void 0!==t&&t.width?p(!0):p(!1)}}),h&&Re.createElement(Te,Object.assign({scrollEnabled:!1,bounces:!1,showsVerticalScrollIndicator:!1,showsHorizontalScrollIndicator:!1,overScrollMode:"never",nestedScrollEnabled:!1},null==d?void 0:d.viewOptions,{ref:u},'android'===fe.Platform.OS?g.panHandlers:{}))))},exports.StoryManager=class extends ei{constructor(e,t){super(e,t),this.on("openStoryReader",(()=>{fe.StatusBar.setHidden(!0),"android"===this.getDevicePlatform()&&ne((e=>{this._innerAndroidDefaultWindowSoftInputIntegerMode=e,X()}))})),this.on("openStoryFavoriteReader",(()=>{fe.StatusBar.setHidden(!0)}))}createWidgetStoriesList(e,t,r){let s=new Ai(this,e,t,r);this.appearanceManager=e;let i=new Promise((t=>{s.on("widgetLoaded",(()=>{this._storiesListWidgetLoaded(s,e),t()}))}));return{widget:s,widgetLoadedPromise:i}}loadStoriesListData(e,t){return this._loadStoriesListData(e,t)}createWidgetStoryReader(e,t,r){let s=new co((()=>this.appearanceManager));return this.storyReaderNeedFirstRender=e,this.storyReaderNeedLoaderRender=t,this.storyReaderDetachComponent=r,s.on("widgetLoaded",(()=>{this._storyReaderWidgetLoaded(s)})),s}createWidgetStoryFavoriteReader(e,t,r){let s=new Io((()=>this.appearanceManager));return this.storyFavoriteReaderNeedFirstRender=e,this.storyFavoriteReaderNeedLoaderRender=t,this.storyFavoriteReaderDetachComponent=r,s.on("widgetLoaded",(()=>{this._storyFavoriteReaderWidgetLoaded(s)})),s}getDeviceInfo(e){return new Promise((async e=>{let t=Promise.resolve(Oe.getUniqueId());e({device_id:await t,platform:this.getDevicePlatform()})}))}getDevicePlatform(){return"Android"===Oe.getSystemName()?"android":"ios"}getDeviceInformation(){return new Promise((async e=>{let t={sdkVersion:"",applicationBundleId:"",deviceId:"",applicationVersion:"",applicationVersionCode:"",userAgent:""},r=Promise.resolve(Oe.getUniqueId());t.sdkVersion="0.3.10",t.applicationBundleId=Oe.getBundleId(),t.deviceId=await r,t.applicationVersion=Oe.getVersion(),t.applicationVersionCode=Oe.getBuildNumber(),Oe.getUserAgent().then((r=>{t.userAgent=`InAppStoryRNSDK/310 ${r} Application/${t.applicationVersionCode} (${t.applicationBundleId} ${t.applicationVersion})`,e(t)}))}))}async localStorageGet(e){try{let t=await Ee.getItem(e);return null!=t?JSON.parse(t):null}catch(e){return console.error(e),null}}async localStorageSet(e,t){try{return void await Ee.setItem(e,JSON.stringify(t))}catch(e){return void console.error(e)}}async localStorageGetArray(e){return this.localStorageGet(e)}async localStorageSetArray(e,t){return this.localStorageSet(e,t)}completeInitStoryReader(e,t,s){return void 0===s&&(s={}),e.on('clickOnButton',(e=>{if(r(this._callbacks.storyLinkClickHandler)||this.listenerCount(ze.CLICK_ON_STORY)>0){let t={src:'storyReader',srcRef:'default',data:e};try{r(this._callbacks.storyLinkClickHandler)&&this._callbacks.storyLinkClickHandler(t),this.emit(ze.CLICK_ON_STORY,t)}catch(e){console.error(e)}}else fe.Linking.openURL(e.url)})),e.on('closeStoryReader',(e=>{fe.InteractionManager.runAfterInteractions((()=>{"android"===this.getDevicePlatform()&&(null!=this._androidDefaultWindowSoftInputMode&&null!=Ao[`set${this._androidDefaultWindowSoftInputMode}`]?Ao[`set${this._androidDefaultWindowSoftInputMode}`]():null!=this._innerAndroidDefaultWindowSoftInputIntegerMode&&ae(this._innerAndroidDefaultWindowSoftInputIntegerMode))})),e.windowReferer!==Ke.favorite&&fe.InteractionManager.runAfterInteractions((()=>{fe.StatusBar.setHidden(!1)}))})),super.completeInitStoryReader(e,t,s)}completeInitStoryFavoriteReader(e,t){return e.on('closeStoryFavoriteReader',(()=>{fe.InteractionManager.runAfterInteractions((()=>{fe.StatusBar.setHidden(!1)}))})),super.completeInitStoryFavoriteReader(e,t)}},exports.StoryReader=e=>{let{storyManager:t}=e;return Re.createElement(Re.Fragment,null,Re.createElement(i,{storyManager:t}),Re.createElement(s,{storyManager:t}))},exports.useIas=(e,t)=>{let r=(e=>{at.store(e)||(()=>{throw Error('expect useStore argument to be a store')})();let t=e.getState(),r=Re.useReducer((e=>e+1),0)[1],s=Re.useRef({store:e,value:t,pending:0});return Wo((()=>{let t=e.updates.watch((e=>{let t=s.current;t.pending||(t.value=e,t.pending=1,r(),t.pending=0)})),i=e.getState(),o=s.current;return o.store===e&&o.value!==i&&(o.value=i,o.pending=1,r(),o.pending=0),o.store=e,t}),[e]),t})(Uo);return(()=>{let s=pe.useRef(!0);s.current&&(null!=r.storyManager&&null!=r.appearanceManager||Vo({storyManager:e(),appearanceManager:t()}),s.current=!1)})(),r};
//# sourceMappingURL=react-native-ias.cjs.js.map
