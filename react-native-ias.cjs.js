function e(e){return e&&'object'==typeof e&&'default'in e?e.default:e}function t(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e)for(var r in e)t[r]=e[r];return t.default=e,t}function r(e){return"function"==typeof e}function s(e){let{storyManager:t}=e,[r,s]=ae.useState(null),[i,o]=ae.useState(!1),[n,a]=ae.useState(!1),l=ae.useRef(null),[d,c]=ae.useState(null);ae.useEffect((()=>{null===r&&null!=t&&(s(t.createWidgetStoryReader(o,a,(e=>{null==e||e.destroyRpcServer(),null==e||e.destructor(),c(null),s(null),o(!1)}))),c(!1)),!1===d&&null!==l.current&&(null==r||r.createRpcServer(l.current),c(!0))}));let[u,h]=ae.useState(!1);return ve.createElement(ve.Fragment,null,r&&i&&ve.createElement(le.SafeAreaView,{style:{...Ne.container,backgroundColor:"#000"}},ve.createElement(le.StatusBar,{barStyle:"light-content",backgroundColor:"#000"}),ve.createElement(le.View,Object.assign({},null==r?void 0:r.containerOptions,{onLayout:e=>{var t;let{nativeEvent:r}=e;null!=r&&null!==(t=r.layout)&&void 0!==t&&t.width?h(!0):h(!1)}}),u&&ve.createElement(Ie,Object.assign({},null==r?void 0:r.viewOptions,{ref:l})))),n&&ve.createElement(le.View,{style:{...Ne.container,backgroundColor:"#000"}},ve.createElement(le.ActivityIndicator,{size:"large",color:"ios"===le.Platform.OS?"#999999":"#ffffff"})))}function i(e){let{storyManager:t}=e,[r,s]=ae.useState(null),[i,o]=ae.useState(!1),[n,a]=ae.useState(!1),l=ae.useRef(null),[d,c]=ae.useState(null);ae.useEffect((()=>{null===r&&null!=t&&(s(t.createWidgetStoryFavoriteReader(o,a,(e=>{null==e||e.destroyRpcServer(),null==e||e.destructor(),c(null),s(null),o(!1)}))),c(!1)),!1===d&&null!==l.current&&(null==r||r.createRpcServer(l.current),c(!0))}));let[u,h]=ae.useState(!1);return ve.createElement(ve.Fragment,null,r&&i&&ve.createElement(le.SafeAreaView,{style:{...De.container,backgroundColor:"#000"}},ve.createElement(le.StatusBar,{barStyle:"light-content",backgroundColor:"#000"}),ve.createElement(le.View,Object.assign({},null==r?void 0:r.containerOptions,{onLayout:e=>{var t;let{nativeEvent:r}=e;null!=r&&null!==(t=r.layout)&&void 0!==t&&t.width?h(!0):h(!1)}}),u&&ve.createElement(Ie,Object.assign({},null==r?void 0:r.viewOptions,{ref:l})))),n&&ve.createElement(le.View,{style:{...De.container,backgroundColor:"#000"}},ve.createElement(le.ActivityIndicator,{size:"large",color:le.Platform.select({ios:"#999999",android:"#ffffff"})})))}function o(){}function n(){n.init.call(this)}function a(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function l(e,t,r){if(t)e.call(r);else for(var s=e.length,i=m(e,s),o=0;o<s;++o)i[o].call(r)}function d(e,t,r,s){if(t)e.call(r,s);else for(var i=e.length,o=m(e,i),n=0;n<i;++n)o[n].call(r,s)}function c(e,t,r,s,i){if(t)e.call(r,s,i);else for(var o=e.length,n=m(e,o),a=0;a<o;++a)n[a].call(r,s,i)}function u(e,t,r,s,i,o){if(t)e.call(r,s,i,o);else for(var n=e.length,a=m(e,n),l=0;l<n;++l)a[l].call(r,s,i,o)}function h(e,t,r,s){if(t)e.apply(r,s);else for(var i=e.length,o=m(e,i),n=0;n<i;++n)o[n].apply(r,s)}function p(e,t,r,s){var i,n,l,d;if('function'!=typeof r)throw new TypeError('"listener" argument must be a function');if((n=e._events)?(n.newListener&&(e.emit('newListener',t,r.listener?r.listener:r),n=e._events),l=n[t]):(n=e._events=new o,e._eventsCount=0),l){if('function'==typeof l?l=n[t]=s?[r,l]:[l,r]:s?l.unshift(r):l.push(r),!l.warned&&(i=a(e))&&i>0&&l.length>i){l.warned=!0;var c=new Error('Possible EventEmitter memory leak detected. '+l.length+' '+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name='MaxListenersExceededWarning',c.emitter=e,c.type=t,c.count=l.length,d=c,'function'==typeof console.warn?console.warn(d):console.log(d)}}else l=n[t]=r,++e._eventsCount;return e}function f(e,t,r){function s(){e.removeListener(t,s),i||(i=!0,r.apply(e,arguments))}var i=!1;return s.listener=r,s}function g(e){var t=this._events;if(t){var r=t[e];if('function'==typeof r)return 1;if(r)return r.length}return 0}function m(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function y(e,t,r,s){(rt(e)||st(e))&&('family'in e||'graphite'in e)||tt(`${t}: expect ${r} to be a unit (store, event or effect)${s}`)}function v(e,t,r){if(Array.isArray(e))for(let s=0;s<e.length;s++)y(e[s],t,`${s} item of ${r}`,'');else y(e,t,r,' or array of units')}function S({node:e=[],from:t,source:r,parent:s=t||r,to:i,target:o,child:n=i||o,scope:a={},meta:l={},family:d={type:'regular'},regional:c}={}){let u=Wt(s),h=Wt(d.links),p=Wt(d.owners),f=[],g={};for(let t=0;t<e.length;t++){let r=e[t];r&&(f.push(r),jt(r,g))}let m={id:dt(),seq:f,next:Wt(n),meta:l,scope:a,family:{type:d.type||"crosslink",links:h,owners:p},reg:g};for(let e=0;e<h.length;e++)Ot(h[e]).push(m);for(let e=0;e<p.length;e++)Et(p[e]).push(m);for(let e=0;e<u.length;e++)u[e].next.push(m);return c&&Nt&&Ht(Mt(Nt),[m]),m}function w(e,t,r){let s=er,i=null,o=Xt;if(e.target&&(t=e.params,r=e.defer,s='page'in e?e.page:s,e.stack&&(i=e.stack),o=Tt(e)||o,e=e.target),o&&Xt&&o!==Xt&&(Xt=null),Array.isArray(e))for(let r=0;r<e.length;r++)Kt('pure',s,_t(e[r]),i,t[r],o);else Kt('pure',s,_t(e),i,t,o);if(r&&!Yt)return;let n,a,l,d,c,u,h={isRoot:Yt,currentPage:er,forkPage:Xt,isWatch:Qt};Yt=0;e:for(;d=Gt();){let{idx:e,stack:t,type:r}=d;l=t.node,er=c=t.page,Xt=Tt(t),u=(c||l).reg;let s={fail:0,scope:l.scope};n=a=0;for(let i=e;i<l.seq.length&&!n;i++){let o=l.seq[i],d=o.data;switch(o.type){case"barrier":{let s=d.barrierID;c&&(s=`${c.fullID}_${s}`);let o=d.priority;if(i!==e||r!==o){zt.has(s)||(zt.add(s),Jt(i,t,o,s));continue e}zt.delete(s);break}case'mov':{let e;switch(d.from){case"stack":e=Mt(t);break;case"a":case'b':e=t[d.from];break;case"value":e=d.store;break;case qe:u[d.store.id]||(t.page=c=sr(c,d.store.id),u=c?c.reg:l.reg),e=Ct(u[d.store.id])}switch(d.to){case"stack":t.value=e;break;case"a":case'b':t[d.to]=e;break;case qe:ir(c,l,d.target.id).current=e}break}case'check':switch(d.type){case'defined':a=void 0===Mt(t);break;case'changed':a=Mt(t)===Ct(ir(c,l,d.store.id))}break;case"filter":a=!or(s,d,t);break;case'run':if(i!==e||"effect"!==r){Jt(i,t,"effect");continue e}case'compute':Qt='watch'===l.meta.op,t.value=or(s,d,t),Qt=h.isWatch}n=s.fail||a}if(!n)for(let e=0;e<l.next.length;e++)Kt('child',c,l.next[e],t,Mt(t),Tt(t))}Yt=h.isRoot,er=h.currentPage,Xt=Tt(h)}function L(e,t="combine"){let r=t+'(',s='',i=0;for(let t in e){let o=e[t];if(null!=o&&(r+=s,r+=Je(o)?o.compositeName.fullName:o.toString()),i+=1,25===i)break;s=', '}return r+=')',r}function C(e,t){for(let r in e)t(e[r],r)}function b(e,t){let r=(e,...t)=>er?((e,t,r,s)=>{let i=er,o=null;if(t)for(o=er;o&&o.template!==t;)o=xt(o);rr(o);let n=e.create(r,s);return rr(i),n})(r,s,e,t):r.create(e,t);r.graphite=S({meta:br("event",r,t,e),regional:1}),r.create=e=>(w(Xt?Xt.find(r):r,e),e),r.watch=ct(Sr,r),r.map=e=>{let t,s;rt(e)&&(t=e,s=e.name,e=e.fn);let i=b(ar(r,s),t);return kr(r,i,Ke,e),i},r.filter=e=>_r(r,"filter",e.fn?e:e.fn,[vt({fn:kt})]),r.filterMap=e=>_r(r,'filterMap',e,[yt({fn:kt}),mt.defined()]),r.prepend=e=>{let t=b('* \u2192 '+r.shortName,{parent:xt(r)}),s=Dt();return s&&_t(t).seq.push(s.upward),kr(t,r,'prepend',e),Cr(r,t),t};let s=Dt();return r}function R(e,t){function r(e,t){l.off(e),Ft(l).set(e,mr(Or(e,l,'on',1,t,c)))}let s=Lt(e),i=Lt(e),o=Rr('updates'),n=Dt();s.after=[{type:'copy',to:i}],n&&n.plain.push(s,i);let a=s.id,l={subscribers:new Map,updates:o,defaultState:e,stateRef:s,getState(){let e,t=s;if(er){let t=er;for(;t&&!t.reg[a];)t=xt(t);t&&(e=t)}return!e&&Xt&&Xt.reg[a]&&(e=Xt),e&&(t=e.reg[a]),Ct(t)},setState(e){let t;Xt&&(t=Xt.nodeMap[_t(l).id]),t||(t=l),w({target:t,params:e,defer:1})},reset(...e){for(let t of e)l.on(t,(()=>l.defaultState));return l},on(e,t){if(v(e,'.on','first argument'),Array.isArray(e))for(let s of e)r(s,t);else r(e,t);return l},off(e){let t=Ft(l).get(e);return t&&(t(),Ft(l).delete(e)),l},map(e,t){let r,i,o;rt(e)&&(r=e,i=e.name,t=e.firstState,e=e.fn);let n=l.getState(),a=Dt();a?o=null:void 0!==n&&(o=e(n,t));let d=R(o,{name:ar(l,i),config:r,strict:0}),c=Or(l,d,Ke,0,e);return It(d).before=[{type:Ke,fn:e,from:s}],a&&(cr(a.plain,s)||cr(c.seq,a.loader)||c.seq.unshift(a.loader)),d},watch(e,t){if(!t||!Je(e)){let t=Sr(l,e),r=Dt();return r?r.watch.push({of:s,fn:e}):e(l.getState()),t}return st(t)||tt('second argument should be a function'),e.watch((e=>t(l.getState(),e)))}},d=br(qe,l,t),c=l.defaultConfig.updateFilter;return l.graphite=S({scope:{state:s},node:[mt.defined(),mt.changed({store:i}),c&&gt({store:i,to:"a"}),c&&vt({fn:(e,t,{a:r})=>c(e,r)}),wt({store:s}),wt({store:i})],child:o,meta:d,regional:1}),Lr&&void 0===e&&tt("current state can't be undefined, use null instead"),Ht(l,[o]),l}function k(e,t){let r=b(e,t),s=r.defaultConfig.handler||(()=>tt(`no handler used in ${r.getType()}`)),i=_t(r);i.meta.onCopy=['runner'],i.meta.unit=r.kind="effect",r.use=e=>(st(e)||tt('.use argument should be a function'),s=e,r);let o=r.finally=Rr('finally'),n=r.done=o.filterMap({named:'done',fn({status:e,params:t,result:r}){if('done'===e)return{params:t,result:r}}}),a=r.fail=o.filterMap({named:'fail',fn({status:e,params:t,error:r}){if('fail'===e)return{params:t,error:r}}}),l=r.doneData=n.map({named:'doneData',fn:({result:e})=>e}),d=r.failData=a.map({named:'failData',fn:({error:e})=>e}),c=S({scope:{getHandler:r.use.getCurrent=()=>s,finally:o},node:[St({fn({params:e,req:t},{finally:r,getHandler:s},i){let o,n=Ir({params:e,req:t,ok:1,anyway:r,stack:i}),a=Ir({params:e,req:t,ok:0,anyway:r,stack:i});try{o=s()(e)}catch(e){return void a(e)}rt(o)&&st(o.then)?o.then(n,a):n(o)}})],meta:{op:'fx',fx:'runner',onCopy:['finally']}});i.scope.runner=c,i.seq.push(yt({fn:(e,t,r)=>xt(r)?{params:e,req:{rs(e){},rj(e){}}}:e}),St({fn:(e,{runner:t},r)=>(w({target:t,params:e,defer:1,forkPage:Tt(r)}),e.params)})),r.create=e=>{let t=(()=>{let e={};return e.req=new Promise(((t,r)=>{e.rs=t,e.rj=r})),e.req.catch((()=>{})),e})(),s={params:e,req:t};if(Xt){if(!Qt){let e=Xt;t.req.finally((()=>{tr(e)})).catch((()=>{}))}w(Xt.find(r),s)}else w(r,s);return t.req};let u=r.inFlight=R(0,{named:'inFlight'}).on(r,(e=>e+1)).on(o,(e=>e-1)),h=r.pending=u.map({fn:e=>e>0,named:'pending'});return Ht(r,[o,n,a,l,d,h,u,c]),r}function _(...e){let[[t,r],s]=dr(e),i={};return C(r,((e,r)=>{let o=i[r]=b(r,{parent:xt(t),config:s});t.on(o,e),Cr(t,o)})),i}function O(e,t){let r=new Set,s=new Set,i=new Set,o=new Set,n=S({family:{type:"domain"},regional:1}),a={history:{domains:r,stores:s,effects:i,events:o},graphite:n};n.meta=br("domain",a,t,e);let[l,d,c,u]=['onEvent','onEffect','onStore','onDomain'].map(Rr);a.hooks={event:l,effect:d,store:c,domain:u},a.onCreateEvent=Ar(l,o,a),a.onCreateEffect=Ar(d,i,a),a.onCreateStore=Ar(c,s,a),a.onCreateDomain=Ar(u,r,a),a.createEvent=a.event=(e,t)=>l(b(e,{parent:a,config:t})),a.createEffect=a.effect=(e,t)=>d(k(e,{parent:a,config:t})),a.createDomain=a.domain=(e,t)=>O({name:e,parent:a,config:t}),a.createStore=a.store=(e,t)=>c(R(e,{parent:a,config:t}));let h=xt(a);return h&&(C(a.hooks,((e,t)=>{vr({from:e,to:h.hooks[t]})})),h.hooks.domain(a)),a}function E(e,t){let r=b(t||L(e,'merge'));return v(e,'merge','first argument'),vr({from:e,to:r,meta:{op:'merge'}}),r}function I(e){return Array.isArray(e)}function P(e){let t=typeof e;return null!=e&&('object'===t||'function'===t)}function A(){if(!Gr&&!(Gr='undefined'!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||'undefined'!=typeof msCrypto&&'function'==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');return Gr(Kr)}function M(e){return'string'==typeof e&&Jr.test(e)}function F(e,t,r){var s=(e=e||{}).random||(e.rng||A)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=s[i];return t}return function(e,t){var r=arguments.length>1&&void 0!==t?t:0,s=(Zr[e[r+0]]+Zr[e[r+1]]+Zr[e[r+2]]+Zr[e[r+3]]+'-'+Zr[e[r+4]]+Zr[e[r+5]]+'-'+Zr[e[r+6]]+Zr[e[r+7]]+'-'+Zr[e[r+8]]+Zr[e[r+9]]+'-'+Zr[e[r+10]]+Zr[e[r+11]]+Zr[e[r+12]]+Zr[e[r+13]]+Zr[e[r+14]]+Zr[e[r+15]]).toLowerCase();if(!M(s))throw TypeError('Stringified UUID is invalid');return s}(s)}function x(e,t){return{...e,...t}}function T(e){return e.replace(/^\//,"")}async function H(){let[e,t]=await Promise.all([as(),ls()]);return{method:"post",url:"session/open",params:{expand:"cache"},data:ns(e,t)}}function N(e,t,r){void 0===t&&(t=!1);let s={url:`story/${e}`,method:"GET",params:{expand:['slides_html','slides_duration','slides_screenshot_share'].join(',')}};return t||s.params&&(s.params.fields=['id','slides_html','slides_duration','slides_screenshot_share'].join(',')),null!==r&&s.params&&(s.params.session_id=r),s}function D(e,t){let r={url:"story-context",method:"get",params:{id:e.join(',')}};return null!=t&&r.params&&(r.params.session_id=t),r}function B(e,t,r){return String(e).replace(new RegExp((e=>e.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'))(t),'g'),(()=>r))}function W(e){return[Object,Array].includes((e||{}).constructor)&&!Object.entries(e||{}).length}function j(e){return null!=e&&"string"==typeof e.valueOf()}function V(e){return'number'==typeof e}function U(e,t){let r=new Blob([e],{type:t});return URL.createObjectURL(r)}function $(e,t){return((e,t)=>new yi(e,t))({fxSenderDomain:e.clientFxDomain,fxReceiverDomain:e.serverFxDomain},t)}function q(){go&&yo.setAdjustNothing()}function G(){go&&yo.setAdjustPan()}function K(){go&&yo.setAdjustResize()}function J(){go&&yo.setAdjustUnspecified()}function Z(){go&&yo.setAlwaysHidden()}function z(){go&&yo.setAlwaysVisible()}function X(){go&&yo.setVisible()}function Y(){go&&yo.setHidden()}function Q(){go&&yo.setUnchanged()}function ee(e){go&&yo.getSoftInputMode(e)}function te(e){go&&yo.setSoftInputMode(e)}function re(e,t){return!1!==t.clone&&t.isMergeableObject(e)?ne(Array.isArray(e)?[]:{},e,t):e}function se(e,t,r){return e.concat(t).map((e=>re(e,r)))}function ie(e){return Object.keys(e).concat((e=>Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((t=>e.propertyIsEnumerable(t))):[])(e))}function oe(e,t){try{return t in e}catch(e){return!1}}function ne(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||se,r.isMergeableObject=r.isMergeableObject||ko,r.cloneUnlessOtherwiseSpecified=re;var s=Array.isArray(t);return s===Array.isArray(e)?s?r.arrayMerge(e,t,r):((e,t,r)=>{var s={};return r.isMergeableObject(e)&&ie(e).forEach((t=>{s[t]=re(e[t],r)})),ie(t).forEach((i=>{((e,t)=>oe(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t)))(e,i)||(s[i]=oe(e,i)&&r.isMergeableObject(t[i])?((e,t)=>{if(!t.customMerge)return ne;var r=t.customMerge(e);return'function'==typeof r?r:ne})(i,r)(e[i],t[i],r):re(t[i],r))})),s})(e,t,r):re(t,r)}Object.defineProperty(exports,'__esModule',{value:!0}),require('react-native-get-random-values');var ae=require('react'),le=require('react-native'),de=require('react-native-webview'),ce=require('./StoriesListClient.js'),ue=require('./StoriesListClient.css.js'),he=require('react-native-device-info'),pe=require('@react-native-async-storage/async-storage'),fe=require('./StoryReaderClient.js'),ge=require('./StoryReaderClient.css.js'),me=require('./StoryFavoriteReaderClient.js'),ye=require('./StoryFavoriteReaderClient.css.js'),ve=e(ae),Se=t(ae),we=e(ce),Le=e(ue),Ce=t(he),be=e(pe),Re=e(fe),ke=e(ge),_e=e(me),Oe=e(ye);const Ee='android'===le.Platform.OS;let Ie=ve.forwardRef(((e,t)=>{let{style:r,...s}=e;return ve.createElement(de.WebView,Object.assign({nativeConfig:{props:{webContentsDebuggingEnabled:!0,allowsInlineMediaPlayback:!0}},scalesPageToFit:!1,originWhitelist:["*"],automaticallyAdjustContentInsets:!1,keyboardDisplayRequiresUserAction:!1},s,{style:Ee?[r,Pe.opacityHack]:r,ref:t,forceDarkOn:!1}))}));const Pe=le.StyleSheet.create({opacityHack:{opacity:.99}});var Ae;let Me;var Fe,xe;let Te;exports.StoriesListSliderAlign=void 0,(Ae=exports.StoriesListSliderAlign||(exports.StoriesListSliderAlign={})).CENTER="center",Ae.LEFT="left",Ae.RIGHT="right",(e=>{e.CIRCLE="circle",e.QUAD="quad",e.RECTANGLE="rectangle"})(Me||(Me={})),exports.StoriesListCardTitleTextAlign=void 0,(Fe=exports.StoriesListCardTitleTextAlign||(exports.StoriesListCardTitleTextAlign={})).LEFT="left",Fe.CENTER="center",Fe.RIGHT="right",exports.StoriesListCardTitlePosition=void 0,(xe=exports.StoriesListCardTitlePosition||(exports.StoriesListCardTitlePosition={})).CARD_INSIDE_BOTTOM="cardInsideBottom",xe.CARD_OUTSIDE_TOP="cardOutsideTop",xe.CARD_OUTSIDE_BOTTOM="cardOutsideBottom",(e=>{e.START_LOADER="startLoader",e.END_LOADER="endLoader"})(Te||(Te={})),exports,exports,exports,exports,exports,exports.StoriesListCardViewVariant=void 0,(e=>{e.CIRCLE="circle",e.QUAD="quad",e.RECTANGLE="rectangle"})(exports.StoriesListCardViewVariant||(exports.StoriesListCardViewVariant={})),exports.StoriesListEvents=void 0,(e=>{e.START_LOADER="startLoad",e.END_LOADER="endLoad"})(exports.StoriesListEvents||(exports.StoriesListEvents={}));const He={title:{content:'',color:'#ffffff',font:'normal',marginBottom:20},card:{title:{font:'normal',color:'#ffffff',padding:15,textAlign:exports.StoriesListCardTitleTextAlign.LEFT,position:exports.StoriesListCardTitlePosition.CARD_INSIDE_BOTTOM,display:!0,lineClamp:3},gap:10,height:70,variant:exports.StoriesListCardViewVariant.CIRCLE,border:{radius:0,color:'black',width:2,gap:3},boxShadow:null,dropShadow:null,opacity:null,mask:{color:null},svgMask:null,opened:{border:{radius:null,color:null,width:null,gap:null},boxShadow:null,dropShadow:null,opacity:null,mask:{color:null},svgMask:null}},favoriteCard:{title:{content:'Favorite',font:'normal',color:'#000',padding:15,textAlign:exports.StoriesListCardTitleTextAlign.LEFT,position:exports.StoriesListCardTitlePosition.CARD_INSIDE_BOTTOM,display:!0,lineClamp:3},gap:10,height:70,variant:exports.StoriesListCardViewVariant.CIRCLE,border:{radius:0,color:'black',width:2,gap:3},boxShadow:null,dropShadow:null,opacity:null,mask:{color:null},svgMask:null,opened:{border:{radius:null,color:null,width:null,gap:null},boxShadow:null,dropShadow:null,opacity:null,mask:{color:null},svgMask:null}},sidePadding:20,topPadding:20,bottomPadding:20,bottomMargin:17,layout:{height:0,backgroundColor:'transparent',sliderAlign:exports.StoriesListSliderAlign.LEFT},navigation:{showControls:!1,controlsSize:48,controlsBackgroundColor:'white',controlsColor:'black'}},Ne=le.StyleSheet.create({container:{flex:1,justifyContent:"center",alignItems:"center",position:"absolute",width:"100%",height:"100%"}}),De=le.StyleSheet.create({container:{flex:1,justifyContent:"center",alignItems:"center",position:"absolute",width:"100%",height:"100%"}});let Be,We,je,Ve,Ue;o.prototype=Object.create(null),n.EventEmitter=n,n.usingDomains=!1,n.prototype.domain=void 0,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.init=function(){this.domain=null,n.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new o,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if('number'!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return a(this)},n.prototype.emit=function(e,t,r,s){var i,o,n,a,p,f,g,m='error'===e;if(f=this._events)m=m&&null==f.error;else if(!m)return!1;if(g=this.domain,m){if(i=t,!g){if(i instanceof Error)throw i;var y=new Error('Uncaught, unspecified "error" event. ('+i+')');throw y.context=i,y}return i||(i=new Error('Uncaught, unspecified "error" event')),i.domainEmitter=this,i.domain=g,i.domainThrown=!1,g.emit('error',i),!1}if(!(o=f[e]))return!1;var v='function'==typeof o;switch(n=arguments.length){case 1:l(o,v,this);break;case 2:d(o,v,this,t);break;case 3:c(o,v,this,t,r);break;case 4:u(o,v,this,t,r,s);break;default:for(a=new Array(n-1),p=1;p<n;p++)a[p-1]=arguments[p];h(o,v,this,a)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){return p(this,e,t,!1)},n.prototype.prependListener=function(e,t){return p(this,e,t,!0)},n.prototype.once=function(e,t){if('function'!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,f(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if('function'!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,f(this,e,t)),this},n.prototype.removeListener=function(e,t){var r,s,i,n,a;if('function'!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(s=this._events))return this;if(!(r=s[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new o:(delete s[e],s.removeListener&&this.emit('removeListener',e,r.listener||t));else if('function'!=typeof r){for(i=-1,n=r.length;n-- >0;)if(r[n]===t||r[n].listener&&r[n].listener===t){a=r[n].listener,i=n;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new o,this;delete s[e]}else((e,t)=>{for(var r=t,s=r+1,i=e.length;s<i;r+=1,s+=1)e[r]=e[s];e.pop()})(r,i);s.removeListener&&this.emit('removeListener',e,a||t)}return this},n.prototype.off=function(e,t){return this.removeListener(e,t)},n.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new o,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new o:delete r[e]),this;if(0===arguments.length){for(var s,i=Object.keys(r),n=0;n<i.length;++n)'removeListener'!==(s=i[n])&&this.removeAllListeners(s);return this.removeAllListeners('removeListener'),this._events=new o,this._eventsCount=0,this}if('function'==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},n.prototype.listeners=function(e){var t,r,s=this._events;return r=s&&(t=s[e])?'function'==typeof t?[t.listener||t]:(e=>{for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t})(t):[],r},n.listenerCount=(e,t)=>'function'==typeof e.listenerCount?e.listenerCount(t):g.call(e,t),n.prototype.listenerCount=g,n.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]},(e=>{e.direct="direct",e.onboarding="onboarding",e.list="list",e.favorite="favorite"})(Be||(Be={})),(e=>{e[e.default=0]="default",e[e.favorite=1]="favorite"})(We||(We={})),(e=>{e[e.default=0]="default",e[e.onboarding=1]="onboarding",e[e.favorite=2]="favorite",e[e.direct=3]="direct"})(je||(je={})),(e=>{e.list="list",e.favorite="favorite"})(Ve||(Ve={})),(e=>{e.CLICK_ON_STORY="clickOnStoryLink"})(Ue||(Ue={}));let $e='undefined'!=typeof Symbol&&Symbol.observable||'@@observable',qe='store',Ge='effect',Ke='map',Je=e=>(st(e)||rt(e))&&'kind'in e;const Ze=e=>t=>Je(t)&&t.kind===e;let ze=Ze(qe),Xe=Ze("event"),Ye=Ze(Ge),Qe=Ze("domain");var et={__proto__:null,unit:Je,store:ze,event:Xe,effect:Ye,domain:Qe};let tt=e=>{throw Error(e)},rt=e=>'object'==typeof e&&null!==e,st=e=>'function'==typeof e,ot=e=>{rt(e)||st(e)||tt('expect first argument be an object')};const nt=()=>{let e=0;return()=>(++e).toString(36)};let at=nt(),lt=nt(),dt=nt(),ct=(e,t)=>e.bind(null,t),ut=(e,t,r)=>e.bind(null,t,r);const ht=(e,t,r)=>({id:lt(),type:e,data:r,hasRef:t});let pt=0,ft=({priority:e="barrier"})=>ht("barrier",0,{barrierID:++pt,priority:e}),gt=({from:e=qe,store:t,target:r,to:s=(r?qe:"stack")})=>ht('mov',e===qe,{from:e,store:t,to:s,target:r}),mt={defined:()=>ht('check',0,{type:'defined'}),changed:({store:e})=>ht('check',1,{type:'changed',store:e})},yt=ut(ht,'compute',0),vt=ut(ht,"filter",0),St=ut(ht,'run',0),wt=({store:e})=>gt({from:"stack",target:e}),Lt=e=>({id:lt(),current:e}),Ct=({current:e})=>e,bt=(e,{fn:t},{a:r})=>t(e,r),Rt=(e,{fn:t},{a:r})=>t(r,e),kt=(e,{fn:t})=>t(e),_t=e=>e.graphite||e,Ot=e=>e.family.owners,Et=e=>e.family.links,It=e=>e.stateRef,Pt=e=>e.config,At=e=>e.\u0254,Mt=e=>e.value,Ft=e=>e.subscribers,xt=e=>e.parent,Tt=e=>e.forkPage,Ht=(e,t)=>{let r=_t(e);for(let e=0;e<t.length;e++){let s=_t(t[e]);"domain"!==r.family.type&&(s.family.type="crosslink"),Ot(s).push(r),Et(r).push(s)}},Nt=null,Dt=()=>Nt,Bt=e=>(e&&Nt&&Nt.sidRoot&&(e=`${Nt.sidRoot}\u0254${e}`),e);const Wt=(e=[])=>{let t=[];if(Array.isArray(e))for(let r=0;r<e.length;r++)Array.isArray(e[r])?t.push(...e[r]):t.push(e[r]);else t.push(e);return t.map(_t)};let jt=({hasRef:e,type:t,data:r},s)=>{let i;e&&(i=r.store,s[i.id]=i),'mov'===t&&r.to===qe&&(i=r.target,s[i.id]=i)},Vt=null;const Ut=(e,t)=>{if(!e)return t;if(!t)return e;let r,s=e.v.type===t.v.type;return(s&&e.v.id>t.v.id||!s&&"sampler"===e.v.type)&&(r=e,e=t,t=r),r=Ut(e.r,t),e.r=e.l,e.l=r,e},$t=[];let qt=0;for(;qt<5;)$t.push({first:null,last:null,size:0}),qt+=1;const Gt=()=>{for(let e=0;e<5;e++){let t=$t[e];if(t.size>0){if(2===e||3===e){t.size-=1;let e=Vt.v;return Vt=Ut(Vt.l,Vt.r),e}1===t.size&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},Kt=(e,t,r,s,i,o)=>Jt(0,{a:null,b:null,node:r,parent:s,value:i,page:t,forkPage:o},e),Jt=(e,t,r,s=0)=>{let i=Zt(r),o=$t[i],n={v:{idx:e,stack:t,type:r,id:s},l:0,r:0};2===i||3===i?Vt=Ut(Vt,n):(0===o.size?o.first=n:o.last.r=n,o.last=n),o.size+=1},Zt=e=>{switch(e){case'child':return 0;case'pure':return 1;case"barrier":return 2;case"sampler":return 3;case Ge:return 4;default:return-1}},zt=new Set;let Xt,Yt=1,Qt=0,er=null,tr=e=>{Xt=e},rr=e=>{er=e};const sr=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=xt(e);if(e)return e}return null},ir=(e,t,r)=>(sr(e,r)||t).reg[r],or=(e,{fn:t},r)=>{try{return t(Mt(r),e.scope,r)}catch(t){console.error(t),e.fail=1}};let nr=(e,t)=>''+e.shortName+t,ar=(e,t)=>null==t?nr(e,' \u2192 *'):t,lr=(e,t)=>{ot(e),At(e)&&t(Pt(e),At(e))},dr=e=>{let t;return lr(e[0],((r,s)=>{t=r,e=s})),[e,t]},cr=(e,t)=>e.includes(t),ur=(e,t)=>{let r=e.indexOf(t);-1!==r&&e.splice(r,1)};const hr=(e,t)=>{ur(e.next,t),ur(Ot(e),t),ur(Et(e),t)},pr=(e,t,r)=>{let s;e.next.length=0,e.seq.length=0,e.scope=null;let i=Et(e);for(;s=i.pop();)hr(s,e),(t||r&&!e.meta.sample||"crosslink"===s.family.type)&&pr(s,t,'on'!==s.meta.op&&r);for(i=Ot(e);s=i.pop();)hr(s,e),r&&"crosslink"===s.family.type&&pr(s,t,'on'!==s.meta.op&&r)},fr=e=>e.clear();let gr=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),ze(e))fr(Ft(e));else if(Qe(e)){r=1;let t=e.history;fr(t.events),fr(t.effects),fr(t.stores),fr(t.domains)}pr(_t(e),!!t,r)},mr=e=>{let t=ut(gr,e,void 0);return t.unsubscribe=t,t},yr=(e,t,{node:r,scope:s,meta:i})=>S({node:r,parent:e,child:t,scope:s,meta:i,family:{owners:[e,t],links:t},regional:1}),vr=e=>{let t;lr(e,((r,s)=>{t=r,e=s}));let{from:r,to:s,meta:i={op:'forward'}}=e;return v(r,'forward','"from"'),v(s,'forward','"to"'),t&&(i.config=t),mr(S({parent:r,child:s,meta:i,family:{},regional:1}))},Sr=(e,t)=>{if(st(t)||tt('.watch argument should be a function'),Xt){let t=Xt.nodeMap[_t(e).id];t&&(e=t)}return mr(S({scope:{fn:t},node:[St({fn:kt})],parent:e,meta:{op:'watch'},family:{owners:e},regional:1}))};const wr=(e,t)=>(rt(e)&&(wr(Pt(e),t),null!=e.name&&(rt(e.name)?wr(e.name,t):st(e.name)?t.handler=e.name:t.name=e.name),e.loc&&(t.loc=e.loc),(e.sid||null===e.sid)&&(t.sid=e.sid),e.handler&&(t.handler=e.handler),e.updateFilter&&(t.updateFilter=e.updateFilter),xt(e)&&(t.parent=xt(e)),'strict'in e&&(t.strict=e.strict),e.named&&(t.named=e.named),wr(At(e),t)),t);let Lr,Cr=(e,t,r="event")=>{xt(e)&&xt(e).hooks[r](t)},br=(e,t,r,s)=>{let i=wr({name:s,config:r},{}),o="domain"===e,n=at(),{parent:a=null,sid:l=null,strict:d=1,named:c=null}=i,u=c||i.name||(o?'':n),h=((e,t)=>{let r,s,i,o=e;return t?(i=t.compositeName,0===e.length?(r=i.path,s=i.fullName):(r=i.path.concat([e]),s=0===i.fullName.length?e:i.fullName+'/'+e)):(r=0===e.length?[]:[e],s=e),{shortName:o,fullName:s,path:r}})(u,a),p={unit:t.kind=e,name:t.shortName=u,sid:t.sid=Bt(l),named:c,unitId:t.id=n};return t.parent=a,t.compositeName=h,t.defaultConfig=i,t.thru=e=>e(t),t.getType=()=>h.fullName,o||(t.subscribe=e=>(ot(e),t.watch(st(e)?e:t=>{e.next&&e.next(t)})),t[$e]=()=>t),Lr=d,p},Rr=e=>b({named:e});const kr=(e,t,r,s)=>yr(e,t,{scope:{fn:s},node:[yt({fn:kt})],meta:{op:r}}),_r=(e,t,r,s)=>{let i;rt(r)&&(i=r,r=r.fn);let o=b(nr(e,' \u2192? *'),i);return yr(e,o,{scope:{fn:r},node:s,meta:{op:t}}),o},Or=(e,t,r,s,i,o)=>{let n=It(t),a=[gt({store:n,to:"a"}),yt({fn:s?Rt:bt}),mt.defined(),mt.changed({store:n}),o&&vt({fn:(e,t,{a:r})=>o(e,r)}),wt({store:n})];return yr(e,t,{scope:{fn:i},node:a,meta:{op:r}})},Er=(e,t,r,s)=>{let i=e?e=>e.slice():e=>({...e}),o=e?[]:{},n=i(o),a=Lt(n),l=Lt(1);a.type=e?'list':'shape';let d=R(n,{name:r||L(t)});_t(d).meta.isCombine=1;let c=[mt.defined(),gt({store:a,to:"a"}),vt({fn:(e,{key:t},{a:r})=>e!==r[t]}),gt({store:l,to:'b'}),yt({fn(e,{clone:t,key:r},s){s.b&&(s.a=t(s.a)),s.a[r]=e}}),gt({from:"a",target:a}),gt({from:"value",store:0,target:l}),ft({priority:"barrier"}),gt({from:"value",store:1,target:l}),gt({store:a}),s&&yt({fn:s}),mt.changed({store:It(d)})],u=a.before=[];return C(t,((e,t)=>{if(!ze(e))return void(n[t]=o[t]=e);o[t]=e.defaultState,n[t]=e.getState(),yr(e,d,{scope:{key:t,clone:i},node:c,meta:{op:'combine'}});let r=It(e);u.push({type:'field',field:t,from:r})})),d.defaultShape=t,a.after=[s?{type:Ke,to:It(d),fn:s}:{type:'copy',to:It(d)}],d.defaultState=s?It(d).current=s(n):o,d};let Ir=({params:e,req:t,ok:r,anyway:s,stack:i})=>o=>w({target:[s,Pr],params:[r?{status:'done',params:e,result:o}:{status:'fail',params:e,error:o},{fn:r?t.rs:t.rj,value:o}],defer:1,page:i.page,forkPage:Tt(i)}),Pr=S({node:[St({fn({fn:e,value:t}){e(t)}})],meta:{op:'fx',fx:'sidechain'}});const Ar=(e,t,r)=>(e.create=t=>(w(e,t),t),_t(e).seq.push(yt({fn:(e,t,r)=>(r.forkPage=null,e)})),e.watch((e=>{Ht(r,[e]),t.add(e),e.ownerSet||(e.ownerSet=t),xt(e)||(e.parent=r)})),Ht(r,[e]),r=>(t.forEach(r),e.watch(r))),Mr=['source','clock','target'],Fr=R({apiKey:""}),xr=b();Fr.on(xr,((e,t)=>t));const Tr=b();Fr.on(Tr,((e,t)=>{let{tags:r}=t;return{...e,tags:r}}));const Hr=b();Fr.on(Hr,((e,t)=>{let{userId:r}=t;return{...e,userId:r}}));const Nr=b();Fr.on(Nr,((e,t)=>{let{placeholders:r}=t;return{...e,placeholders:r}}));const Dr=b();Fr.on(Dr,((e,t)=>{let{lang:r}=t;return{...e,lang:r}}));const Br=b();Fr.on(Br,((e,t)=>{let{isSandbox:r}=t;return{...e,isSandbox:Boolean(r)}}));const Wr=b();Fr.on(Wr,((e,t)=>{let{apiKey:r}=t;return{...e,apiKey:r}}));const jr=R(''),Vr=b();vr({from:Vr,to:jr});const Ur=R({default:{},user:{}}),{sdkPlaceholdersChanged:$r,addDefaultPlaceholders:qr}=_(Ur,{sdkPlaceholdersChanged:(e,t)=>({default:e.default,user:t}),addDefaultPlaceholders:(e,t)=>{let r={default:{},user:e.user};return I(t)&&t.forEach((e=>{P(e)&&void 0!==e.name&&void 0!==e.default_value&&(r.default[e.name]=e.default_value)})),r}});for(var Gr,Kr=new Uint8Array(16),Jr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Zr=[],zr=0;zr<256;++zr)Zr.push((zr+256).toString(16).substr(1));let Xr=e=>null==e;class Yr{static createFunctionWithTimeout(e,t){function r(){s||(s=!0,e())}let s=!1;return setTimeout(r,t||1e3),r}static convertModelToFormData(e,t,r){t instanceof Object&&Object.keys(t).forEach((s=>{let i=t[s];if(i instanceof Object&&!Array.isArray(i))return this.convertModelToFormData(e,i,s);r&&(s=`${r}[${s}]`),Array.isArray(i)?i.forEach((t=>{e.append(`${s}[]`,t)})):e.append(s,i)}))}}const Qr={baseUrl:process.env.BASE_URL,apiUrl:"https://api.inappstory.ru",faviconApiUrl:"https://favicon.inappstory.ru"},es=new class{constructor(){this._deviceInfoPromise=null,this._baseHeaders={},this.requestInterceptors=[],this.interceptors={request:{use:e=>{this.requestInterceptors.push(e)}}}}set deviceInfoPromise(e){this._deviceInfoPromise=e}set baseHeaders(e){this._baseHeaders=e}get baseURL(){return`${Qr.apiUrl}/v2/`}async request(e){return new Promise(((t,r)=>{this._deviceInfoPromise?this._deviceInfoPromise.finally((async()=>{try{if(P(e.headers)&&null!=e.headers||(e.headers={}),e.headers=x(this._baseHeaders,e.headers),this.requestInterceptors.length)for(let t of this.requestInterceptors)t(e);let r="";!Xr(e.params)&&P(e.params)&&(r=new URLSearchParams(Object.entries(e.params)).toString());let s=new URL(`${T(e.url)}${r?"?"+r:""}`,this.baseURL),i="get";Xr(e.method)||(i=e.method);let o={};!Xr(e.headers)&&P(e.headers)&&(o=e.headers);let n=null;!Xr(e.data)&&P(e.data)&&(n=JSON.stringify(e.data),o["Content-Type"]="application/json");let a=await fetch(s.toString(),{method:i,body:n,headers:o,credentials:"omit"}),l=await a.json();t({data:l,headersRaw:a.headers,headers:Object.fromEntries([...a.headers]),status:a.status,statusText:a.statusText,ok:a.ok})}catch(e){r(e)}})):r(new Error("Invalid device info Promise"))}))}async post(e,t){return this.request({method:"post",url:e,data:t})}async get(e,t){return this.request({method:"get",url:e,params:t})}};es.interceptors.request.use((e=>{var t,r;return e.headers=x(e.headers,{Authorization:`Bearer ${Fr.getState().apiKey}`,"Accept-Language":Fr.getState().lang||"en","Auth-Session-Id":null===(t=ts.getState())||void 0===t||null===(r=t.session)||void 0===r?void 0:r.id,"X-User-Id":Fr.getState().userId?Fr.getState().userId:"","X-Request-Id":F()}),e}));const ts=R({session:{id:'',expire_in:0},server_timestamp:0,content_base_url:'',user_key:'',share:!1,is_allow_profiling:!1,cache:[],placeholders:[]}),rs=k();ts.on(rs.doneData,((e,t)=>t));const ss=b();ts.on(ss,(e=>({...e,session:{id:'',expire_in:0}})));const is=b(),os=k((e=>{es.post('session/update',e)})).prepend((e=>({data:[[5,0,...e]]})));rs.use((async()=>{let[e,t]=await Promise.all([as(),ls()]);return(await es.post('session/open?expand=cache',ns(e,t))).data})),vr({from:is,to:ts});const ns=(e,t)=>{'iOS'===e.os_name?window.isIos=!0:'Android'===e.os_name&&(window.Android=!0);let r=Fr.getState();return r&&r.userId&&(e.user_id=r.userId),e.features='animation,data,deeplink,placeholder,resetTimers,gameReader,swipeUpItems',t&&(e.features+=',webp'),e},as=()=>Gs.getInstance().getDeviceInfo(Vr),ls=()=>Gs.getInstance().waitCheckIsWebPSupported(),ds=R({default:[]}),cs=ds.map((e=>e[ts.getState().user_key||"default"]||[]));let us;(e=>{e.FEEDS="feeds",e.FAVORITE="favorite"})(us||(us={}));const hs=R({default:{[us.FEEDS]:{},[us.FAVORITE]:[]}}),ps=hs.map((e=>e[ts.getState().user_key||"default"]||{})),fs=R({}),gs=R({}),ms=R([]);fs.on([ps,cs],(()=>{let e=ps.getState(),t={},r=cs.getState();for(let s in e[us.FEEDS])t[s]=[],e[us.FEEDS][s]&&Array.isArray(e[us.FEEDS][s])&&(t[s]=r.filter((t=>-1!==e[us.FEEDS][s].indexOf(t.id))));return t})),gs.on([ps,cs],(()=>{let e=ps.getState(),t={},r=cs.getState();for(let s in e[us.FEEDS])if("onboarding_"===s.substring(0,"onboarding_".length)){let i=s.substring("onboarding_".length);t[i]=[],e[us.FEEDS][s]&&Array.isArray(e[us.FEEDS][s])&&(t[i]=r.filter((t=>-1!==e[us.FEEDS][s].indexOf(t.id)&&!t.is_opened)))}return t})),ms.on([ps,cs],(()=>{let e=ps.getState();return cs.getState().filter((t=>{var r;return-1!==(null===(r=e[us.FAVORITE])||void 0===r?void 0:r.indexOf(t.id))}))}));const ys=k(),vs=e=>e.is_opened,Ss=cs.map((e=>e.filter((e=>!e.slidesLoaded)).map((e=>e.id)))),{storyItemFavoriteChanged:ws,storyItemIsOpenedChanged:Ls}=_(ds,{storyItemFavoriteChanged:(e,t)=>{let{id:r,favorite:s}=t,i=ts.getState().user_key||"default",o=(e[i]||[]).slice(0),n=o.find((e=>e.id===r));return void 0!==n&&(n.favorite=s),{...e,[i]:o}},storyItemLikeChanged:(e,t)=>{let{id:r,like:s}=t,i=ts.getState().user_key||"default",o=(e[i]||[]).slice(0),n=o.find((e=>e.id===r));return void 0!==n&&(n.like=s),{...e,[i]:o}},storyItemIsOpenedChanged:(e,t)=>{let{id:r}=t,s=ts.getState().user_key||"default",i=(e[s]||[]).slice(0),o=i.find((e=>e.id===r));return void 0!==o&&(o.is_opened=!0),{...e,[s]:i}}});ys.use((async()=>es.get('story',Cs())));const Cs=(e,t,r,s)=>{var i;let o=null===(i=Fr.getState())||void 0===i?void 0:i.tags,n={};return o&&I(o)&&o.length>0&&(n.tags=o.join(',')),void 0!==t&&I(t)&&t.length>0&&(n.tags=t.join(',')),null==s||'number'!=typeof s&&!(e=>!isNaN(parseFloat(e))&&isFinite(e))(s)||(n.limit=s),e&&(n.session_id=e),null!=r&&(n.test=r),{params:n}},bs=R(null),Rs=k(),ks=b();Rs.use((async e=>{let{ids:t}=e;return es.request(D(t))})),vr({from:Rs.done.filterMap((e=>{let t=e.result.data;if(t&&P(t))return{...t,ids:e.params.ids}})),to:bs}),vr({from:ks,to:bs});const _s=k((async e=>{var t,r;let{defaultList:s,onboardingList:i,favoriteList:o,onboardingTags:n,testKey:a,limit:l}=e,d=[],c=null;W(null===(t=ts.getState())||void 0===t||null===(r=t.session)||void 0===r?void 0:r.id)&&(d.push(Os(await H(),"session")),c="@{session.session.id}"),!1!==s&&j(s)&&d.push(Os(((e,t,r,s)=>{let{params:i}=Cs(t,[],s);return{method:"GET",url:`feed/${e}`,params:i}})(s,c,0,a),`storyList_${s}`)),o&&d.push(Os((e=>{let{params:t}=Cs(e);return{method:"GET",url:"story",params:{...t,favorite:1}}})(c),"storyFavoriteList")),!1!==i&&j(i)&&"string"==typeof i&&d.push(Os(((e,t,r,s)=>{void 0===e&&(e="onboarding");let{params:i}=Cs(t,r,null,s);return{method:"GET",url:`feed/${e}/onboarding`,params:i}})(i,c,n,l),`storyOnboardingList_${i}`));let u=null;try{let e=await es.post('composite',{compositeRequest:d});if(e.status>=200&&e.status<=299)if(e.data&&e.data.compositeResponse&&Array.isArray(e.data.compositeResponse)){if(e.data.success)return e.data.compositeResponse;for(let t of e.data.compositeResponse){let e=t.status;if(V(e)&&!(e>=200&&e<=299)){u={name:"networkError",networkStatus:e,networkMessage:String(t.body)};break}}}else u={name:"networkError",networkStatus:null,networkMessage:"Invalid data in API response"};else u=e&&e.status?{name:"networkError",networkStatus:e.status,networkMessage:e.statusText}:{name:"networkError",networkStatus:null,networkMessage:null}}catch(e){u={name:"networkError",networkStatus:null,networkMessage:null}}if(null!==u)throw u;return[]})),Os=(e,t)=>({path:e.url,qs:e.params,body:e.data,ref:t,method:e.method}),Es={}.hasOwnProperty,Is=e=>{let t=Ur.getState();for(let r in t.user)Es.call(t.user,r)&&(e=B(e,`%${r}%`,t.user[r]));for(let r in t.default)Es.call(t.default,r)&&(e=B(e,`%${r}%`,t.default[r]));return e},Ps=e=>Array.isArray(e)?e.map((e=>({...e,title:e.need_placeholders?Is(e.title):e.title,slidesLoaded:!1,is_opened:vs(e)}))):[];vr({from:_s.doneData.filterMap((e=>{var t;return null===(t=e.find((e=>"session"===e.ref)))||void 0===t?void 0:t.body})),to:ts}),vr({from:_s.doneData.filterMap((e=>{var t,r;return null===(t=e.find((e=>"session"===e.ref)))||void 0===t||null===(r=t.body)||void 0===r?void 0:r.placeholders})),to:qr}),((...e)=>{let t,r,s,i,[[o,n,a],l]=dr(e);void 0===n&&rt(o)&&(e=>{let t=0;return((e,t)=>{Mr.forEach(t)})(0,(r=>{r in e&&(null==e[r]&&tt(`sample: ${r} should be defined`),t=1)})),t})(o)&&(n=o.clock,a=o.fn,i=o.greedy,t=o.target,r=o.name,s=o.sid,o=o.source);let d=1;void 0===o&&(v(n,'sample','clock'),Array.isArray(n)&&(n=E(n)),o=n,d=0),d&&!Je(o)&&(o=((...e)=>{let t,r,s;lr(e[0],((t,r)=>{s=t,e=r}));let i,o,n=e[e.length-1];if(st(n)?(r=e.slice(0,-1),t=n):r=e,1===r.length){let e=r[0];ze(e)||(i=e,o=1)}return o||(i=r,t&&(t=(e=>t=>e(...t))(t))),rt(i)||tt('shape should be an object'),Er(Array.isArray(i),i,s,t)})(o)),void 0===n&&(n=o),v(n,'sample','clock'),r=l||r||o.shortName;let c=Dt(),u=!!t;t||(ze(o)&&ze(n)?t=R(a?a(Ct(It(o)),Ct(It(n))):Ct(It(o)),{name:r,sid:s}):(t=b(r),c&&_t(t).seq.push(c.loader)));let h=u&&Je(t)&&_t(t).meta.nativeTemplate;if(ze(o)){let e=It(o);Ht(o,[yr(n,t,{scope:{fn:a,targetTemplate:h},node:[c&&c.loader,!i&&ft({priority:"sampler"}),gt({store:e,to:a?"a":"stack"}),a&&yt({fn:Rt}),c&&u&&c.upward],meta:{op:"sample",sample:qe}})]),c&&(cr(c.plain,e)||cr(c.closure,e)||c.closure.push(e))}else{let e=Lt(0),r=Lt(),s=Lt();c&&c.plain.push(e,r,s),S({parent:o,node:[wt({store:r}),gt({from:"value",store:1,target:e})],family:{owners:[o,t,n],links:t},meta:{op:"sample",sample:'source'},regional:1}),Ht(o,[yr(n,t,{scope:{fn:a,targetTemplate:h},node:[c&&c.loader,wt({store:s}),gt({store:e}),vt({fn:e=>e}),!i&&ft({priority:"sampler"}),gt({store:r}),gt({store:s,to:"a"}),a&&yt({fn:bt}),c&&u&&c.upward],meta:{op:"sample",sample:'clock'}})])}})({source:ds,clock:ts,fn:e=>{let t={};for(let r in e)Es.call(e,r)&&(t[r]=e[r].map((e=>({...e,is_opened:vs(e),title:e.need_placeholders?Is(e.title):e.title}))));return t},target:ds});const{storiesListItemsAdded:As}=_(ds,{storiesListItemsAdded:(e,t)=>{let{storyList:r}=t,s=ts.getState().user_key||"default",i=e[s]||[],o=i.map((e=>e.id));return{...e,[s]:[...i,...r.filter((e=>-1===o.indexOf(e.id)))]}}}),{storiesListIdsChanged:Ms}=_(hs,{storiesListIdsChanged:(e,t)=>{let{storiesIdsUserEntity:r,feedSlug:s,storyList:i}=t,o=ts.getState().user_key||"default",n=e[o]||{};return void 0===n[us.FAVORITE]&&(n[us.FAVORITE]=[]),void 0===n[us.FEEDS]&&(n[us.FEEDS]={}),r===us.FEEDS&&s&&(n[us.FEEDS][s]=i.map((e=>e.id))),r===us.FAVORITE&&(n[us.FAVORITE]=i.map((e=>e.id))),{...e,[o]:n}}});vr({from:_s.doneData.filterMap((e=>{let t=null;for(let s of e)if(s.ref&&j(s.ref)){let e=s.ref.match(/^storyList_(.+)/);if(e&&Array.isArray(e)&&e[1]){var r;let i=Ps(null===(r=s.body)||void 0===r?void 0:r.stories);t={storiesIdsUserEntity:us.FEEDS,feedSlug:e[1],storyList:i}}}if(t)return t})),to:[As,Ms]}),vr({from:_s.doneData.filterMap((e=>{let t=e.find((e=>"storyFavoriteList"===e.ref));if(void 0===t)return;let r=Ps(t.body);return{storiesIdsUserEntity:us.FAVORITE,feedSlug:null,storyList:r}})),to:[As,Ms]}),vr({from:_s.doneData.filterMap((e=>{let t=null;for(let s of e)if(s.ref&&j(s.ref)){let e=s.ref.match(/^storyOnboardingList_(.+)/);if(e&&Array.isArray(e)&&e[1]){var r;let i=Ps(null===(r=s.body)||void 0===r?void 0:r.stories);t={storiesIdsUserEntity:us.FEEDS,feedSlug:`onboarding_${e[1]}`,storyList:i}}}if(t)return t})),to:[As,Ms]});const Fs=k();Fs.use((async e=>{let t=e.ids.map((e=>Os(N(e),`storySlides_${e}`))),r=await es.post('composite',{compositeRequest:t});return r.data&&r.data.success&&r.data.compositeResponse&&Array.isArray(r.data.compositeResponse)?r.data.compositeResponse:[]}));const xs=e=>e&&P(e)&&"id"in e,Ts=k();Ts.use((async e=>{let{ids:t,id:r}=e,s=[Os(N(r),'storySlides'),Os(D(t),'storyContext')],i=await es.post('composite',{compositeRequest:s});return i.data&&i.data.success&&i.data.compositeResponse&&Array.isArray(i.data.compositeResponse)?i.data.compositeResponse:[]})),ds.on([Fs.doneData,Ts.doneData],((e,t)=>{if(Array.isArray(t)){let r=ts.getState().user_key||"default",s=(e[r]||[]).slice(0).map((e=>{for(let p=0;p<t.length;p++){var r,s,i,o,n,a,l,d,c,u,h;if(xs(null===(r=t[p])||void 0===r?void 0:r.body)&&(null===(s=t[p])||void 0===s||null===(i=s.body)||void 0===i?void 0:i.id)===e.id)return Object.assign({},e,{slides_html:e.need_placeholders?Array.from(null===(o=t[p])||void 0===o||null===(n=o.body)||void 0===n?void 0:n.slides_html).map((e=>Is(e))):Array.from(null===(a=t[p])||void 0===a||null===(l=a.body)||void 0===l?void 0:l.slides_html),slides_duration:null===(d=t[p])||void 0===d||null===(c=d.body)||void 0===c?void 0:c.slides_duration,slides_screenshot_share:null===(u=t[p])||void 0===u||null===(h=u.body)||void 0===h?void 0:h.slides_screenshot_share,slidesLoaded:!0,is_opened:vs(e)})}return e}));return{...e,[r]:s}}return e})),vr({from:Ts.done.filterMap((e=>{var t;let r=null===(t=e.result.find((e=>"storyContext"===e.ref)))||void 0===t?void 0:t.body;if(r&&P(r))return{...r,ids:e.params.ids}})),to:bs});const Hs=k((async e=>{var t,r;let{id:s}=e,i=[],o=null;W(null===(t=ts.getState())||void 0===t||null===(r=t.session)||void 0===r?void 0:r.id)&&(i.push(Os(await H(),"session")),o="@{session.session.id}"),i.push(Os(N(s,!0,o),"story")),i.push(Os(D([s],o),'storyContext'));let n=await es.post('composite',{compositeRequest:i});if(n.data&&n.data.success&&n.data.compositeResponse&&Array.isArray(n.data.compositeResponse))return n.data.compositeResponse;if(n.data&&!n.data.success)throw Error('composite request error:'+JSON.stringify(n.data.compositeResponse));return[]})),Ns=e=>!!e;vr({from:Hs.doneData.filterMap((e=>{var t;let r=null===(t=e.find((e=>"session"===e.ref)))||void 0===t?void 0:t.body;if(r&&P(r)&&Ns(r))return r})),to:ts}),vr({from:Hs.done.filterMap((e=>{var t;let r=null===(t=e.result.find((e=>"storyContext"===e.ref)))||void 0===t?void 0:t.body;if(r&&P(r))return{...r,ids:[e.params.id]}})),to:bs}),ds.on(Hs.doneData.filterMap((e=>{var t,r;let s=null,i=null===(t=e.find((e=>"session"===e.ref)))||void 0===t?void 0:t.body;i&&P(i)&&Ns(i)&&(s=i.user_key);let o=null===(r=e.find((e=>"story"===e.ref)))||void 0===r?void 0:r.body;if(o&&P(o))return{story:o,userKey:s}})),((e,t)=>{if(P(t)&&void 0!==t.story&&void 0!==t.userKey&&xs(t.story)){let r=t.userKey||ts.getState().user_key||"default",s=(e[r]||[]).slice(0),i=t.story,o=s.filter((e=>{var t;return e.id!==(null===(t=i)||void 0===t?void 0:t.id)})).slice(0);return i=Object.assign(i,{slides_html:i.need_placeholders?Array.from(i.slides_html).map((e=>Is(e))):Array.from(i.slides_html),slides_duration:i.slides_duration,slidesLoaded:!0,is_opened:vs(i)}),o.push(i),{...e,[r]:o}}}));let Ds=!1,Bs=null;const Ws=()=>(null!=Bs||(Bs=new Promise((e=>{ts.watch((t=>{let{session:r}=t;!Ds&&null!=r&&Boolean(r.id)&&(Ds=!0,e())}))}))),Bs);let js;(e=>{e.START_LOADING="startLoad",e.END_LOADING="endLoad",e.CLOSE_STORY_READER="closeStoryReader"})(js||(js={}));class Vs{}const Us=(e,t)=>{switch(e){case je.default:return t?fs.getState()[t]:[];case je.favorite:return ms.getState();case je.onboarding:return t?gs.getState()[t]:[]}return[]},$s=()=>ts.getState().cache.filter((e=>'font-face'===e.type)),qs=async(e,t,r)=>{let s=cs.getState().find((t=>t.id===e||t.string_id===e));if(void 0!==s){await Ws(),t.setFonts($s());let e={windowReferer:We.default,listType:je.default,id:s.id,storyContext:bs.getState(),storyList:[s],hasShare:ts.getState().share,platform:r};return t.openReader(e,{listType:je.direct,feed:null}),!0}return!1};class Gs extends n{constructor(e,t){return super(),this._callbacks={},this.StoriesList=class extends n{constructor(e,t,r){void 0===r&&(r='default'),super(),this.feedSlug=r,this.storyListWidget=void 0,this.appearanceManager=void 0,this._listLoadStatus={feed:"default",defaultListLength:0,favoriteListLength:0,success:!0,error:{name:"",networkStatus:200,networkMessage:""}}}async reload(e){var t;void 0===e&&(e={needLoader:!0});let r=!0;!1===(null===(t=e)||void 0===t?void 0:t.needLoader)&&(r=!1);try{return await Gs.instance._loadStoriesList(this.storyListWidget,this.appearanceManager,this,!1,r)}catch(e){throw Error(e)}}},this._appearanceManager=null,this.storyListInstance=null,this._storyReaderInstance=null,this.storyReaderInstancePromise=null,this.storyReaderInstancePromiseResolver=null,this._goodsWidgetInstance=null,this._storyReaderNeedFirstRender=null,this._storyReaderNeedLoaderRender=null,this._storyReaderDetachComponent=null,this._storyReaderWidgetLoaded=async e=>{await Ws(),this.completeInitStoryReader(e,$s()),null!=this.storyReaderInstancePromiseResolver&&this.storyReaderInstancePromiseResolver(e)},this._storyFavoriteReaderInstance=null,this.storyFavoriteReaderInstancePromise=null,this.storyFavoriteReaderInstancePromiseResolver=null,this._storyFavoriteReaderNeedFirstRender=null,this._storyFavoriteReaderNeedLoaderRender=null,this._storyFavoriteReaderDetachComponent=null,this._storyFavoriteReaderWidgetLoaded=async e=>{await Ws(),this.completeInitStoryFavoriteReader(e,$s()),null!=this.storyFavoriteReaderInstancePromiseResolver&&this.storyFavoriteReaderInstancePromiseResolver(e)},this._loadedStoriesLength={defaultListLength:0,favoriteListLength:0},this._listLoadStatus={feed:"default",defaultListLength:0,favoriteListLength:0,success:!0,error:{name:"",networkStatus:200,networkMessage:""}},this._loadStoriesList=async(e,t,r)=>{void 0===r&&(r=!0);let s=!0===t.commonOptions.hasFavorite&&r;try{await _s({defaultList:e.feedSlug,onboardingList:!1,favoriteList:s,testKey:e.testKey}),e.setListLoadStatusField("feed",e.feedSlug),e.setListLoadStatusField("success",!0),e.setListLoadStatusField("error",null)}catch(t){e.setListLoadStatusField("success",!1),e.setListLoadStatusField("error",{name:t.name,networkMessage:t.networkMessage,networkStatus:t.networkStatus})}return e.listLoadStatus},this._loadStoriesListData=async(e,t)=>{let r=await this._loadStoriesList(e,t,!0);e.forUnsubscribe.push(fs.watch((t=>{var r;let s=null!==(r=t[e.feedSlug])&&void 0!==r?r:[];e.setListLoadStatusField("defaultListLength",s.length)}))),t.commonOptions.hasFavorite&&e.forUnsubscribe.push(ms.watch((async t=>{e.setListLoadStatusField("favoriteListLength",t.length)}))),setTimeout((()=>{e.emit(exports.StoriesListEvents.END_LOADER,r)}))},this._checkIsWebPSupportedPromise=null,this._checkIsWebPSupportedPromiseResolver=null,this.waitCheckIsWebPSupported=async()=>(null!=this._checkIsWebPSupportedPromise||(this._checkIsWebPSupportedPromise=new Promise((e=>{this._checkIsWebPSupportedPromiseResolver=e,setTimeout((()=>e(!1)),5e3)}))),this._checkIsWebPSupportedPromise),this._storiesListWidgetLoaded=async(e,t)=>{null!=this._checkIsWebPSupportedPromiseResolver&&this._checkIsWebPSupportedPromiseResolver(await e.checkWebPSupport());let s=t.storiesListOptions;e.forUnsubscribe.push(fs.watch((t=>{var r;let s=null!==(r=t[e.feedSlug])&&void 0!==r?r:[];e.setStories({listType:je.default,storyList:s})}))),t.commonOptions.hasFavorite&&e.forUnsubscribe.push(ms.watch((async t=>{e.setStories({listType:je.favorite,storyList:t}),this._storyFavoriteReaderInstance&&this._storyFavoriteReaderInstance.setStories({listType:je.favorite,storyList:t})}))),await Ws();let i=$s();return e.setFonts(i),Fr.getState(),e.setCallbacks({handleClickOnStoryDeepLink:e=>{((e,t,r)=>{if("sendBeacon"in navigator){var s,i;let n=`${o=es.baseURL,o.replace(/\/$/,"")}${T(e)}?access_token=${Fr.getState().apiKey}&session_id=${null===(s=ts.getState())||void 0===s||null===(i=s.session)||void 0===i?void 0:i.id}`,a=new FormData;Object.keys(t).forEach((e=>{Yr.convertModelToFormData(a,t[e],e)})),navigator.sendBeacon(n,a),r()}else es.post(e,t).then((()=>r()),(()=>r()));var o})('session/update',{data:[[1,0,e.id,0,0]]},Yr.createFunctionWithTimeout((()=>{e.isDeeplink&&e.url&&(null!=s&&s.handleStoryLinkClick&&r(null==s?void 0:s.handleStoryLinkClick)?null==s||s.handleStoryLinkClick(e):window.open(e.url,'_self'))})))},handleClickOnStory:t=>{if(0===t.id)this.emit("clickOnFavoriteCell",{feed:e.feedSlug});else{let r={title:null,tags:[],slidesCount:null,feed:null,source:null},s=cs.getState().find((e=>e.id===t.id));s&&(r.title=s.title,r.tags=s.tags,r.slidesCount=s.slides_count),r.feed=e.feedSlug,r.source=Be.list,this.emit("clickOnStory",{...t,...r})}},handleFlushThumbViews:e=>{os(e)},handleClickOnStoryInternal:t=>this.handleClickOnStoryInternal(t,e.feedSlug)}),e.on('clickOnFavoriteCellInternal',(async t=>{let r;try{this.emit("openStoryFavoriteReader",t),r=await this.getStoryFavoriteReaderInstance(),r.emit("openStoryFavoriteReader",t),this.showStoryFavoriteReaderLoader(!0);let s={...t,storyList:Us(je.favorite)};r.openReader(s,{listType:t.listType,feed:e.feedSlug})}catch(e){this.showStoryFavoriteReaderLoader(!1),r&&r.closeReader(),console.log(e)}})),this.storyListInstance=e,{storyListWidget:e,appearanceManager:t}},this._androidDefaultWindowSoftInputMode=null,this._innerAndroidDefaultWindowSoftInputIntegerMode=null,this.SharePage=class extends n{constructor(e,t,r,s){return super(),this.storyReaderWidget=void 0,this.appearanceManager=void 0,this.options={},r&&(this.options=r),Gs.instance._showSharePage(e,t,this.options,this).then((e=>{let{storyReaderInstance:t,appearanceManager:r}=e;this.storyReaderWidget=t,this.appearanceManager=r})),this}async closeStoryReader(){this.storyReaderWidget&&(Gs.instance.closeGoodsWidget(),this.storyReaderWidget.closeReader())}},this._showSharePage=async(e,t,s,i)=>{setTimeout((()=>{i.emit(js.START_LOADING),r(s.handleStartLoad)&&s.handleStartLoad()}));let o=!1,n=null;try{await Ws(),n=await this.initStoryReader(t,$s(),{closeOnLastSlideByTimer:!1,recycleStoriesList:!1}),n.on('closeStoryReader',(()=>{if(r(s.handleStoryReaderClose)||i.listenerCount(js.CLOSE_STORY_READER)>0)try{r(s.handleStoryReaderClose)&&s.handleStoryReaderClose(),i.emit(js.CLOSE_STORY_READER)}catch(e){console.error(e)}else{let e=window.location!=window.parent.location?window.parent.location:window.location;window.open(`${e.protocol}//${e.host}`,'_parent')}})),o=await qs(e,n,this.getDevicePlatform())}catch(e){}return i.emit(js.END_LOADING,{result:o}),r(s.handleStopLoad)&&s.handleStopLoad(o),{storyReaderInstance:n,appearanceManager:t,result:o}},Gs.instance||(xr(e),e.placeholders&&$r(e.placeholders),t&&P(t)&&(this._callbacks=t),es.deviceInfoPromise=new Promise((e=>(async(e,t,r)=>{let s=await e();t.baseHeaders={"X-Sdk-Version":s.sdkVersion,"X-App-Package-Id":s.applicationBundleId,"X-User-Agent":s.userAgent,"X-Device-Id":s.deviceId},r(!0)})(this.getDeviceInformation,es,e))),(e=>{let t=(e=>{if(e.length>32)try{let t=(e=>{e=e.replace(new RegExp('-','g'),'+').replace(new RegExp('_','g'),'/'),e=((e,t)=>void 0===t?e:t.length>=e.length?t:(t+e).substring(0,e.length))(new Array(e.length%4).fill("=").join(""),e);try{return(e=>{void 0===e&&(e='');let t=e.replace(/=+$/,''),r='';if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let e,s=0,i=0,o=0;e=t.charAt(o++);~e&&(i=s%4?64*i+e:e,s++%4)?r+=String.fromCharCode(255&i>>(-2*s&6)):0)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e);return r})(e)}catch(e){return""}})(e),r=t.charCodeAt(13);if(r>0){let e=t.substr(14,r);e=e.replace(/\0+$/,'');let s="{QQN{xuV?1Dv16j3",i=s,o=0;for(;i.length<r;)i+=s[o],o++,o===s.length&&(o=0);let n="";for(let t=0;t<r;t++)n+=String.fromCharCode(e.charCodeAt(t)^i.charCodeAt(t));return n}}catch(e){console.error(e)}return null})(e);if(null!=t){let e=t.split(".").slice(1);Qr.baseUrl=`https://${["sdk",...e].join(".")}`,Qr.faviconApiUrl=`https://${["favicon",...e].join(".")}`,Qr.apiUrl=`https://${t}`}})(e.apiKey),Gs.instance=this),Gs.instance}destructor(){delete Gs.instance}set storyLinkClickHandler(e){r(e)&&(this._callbacks.storyLinkClickHandler=e)}set openGoodsWidgetHandler(e){r(e)&&(this._callbacks.openGoodsWidgetHandler=e)}get openGoodsWidgetHandler(){return this._callbacks.openGoodsWidgetHandler}static getInstance(){if(!Gs.instance)throw new Error("Error - use new IAS.StoryManager(). For first init - with config");return Gs.instance}setTags(e){I(e)&&Tr({tags:e})}getTags(){var e;return null!==(e=Fr.getState().tags)&&void 0!==e?e:[]}setUserId(e){(j(e)||V(e))&&Hr({userId:e})}getUserId(){return Fr.getState().userId}setLang(e){j(e)&&Dr({lang:e})}getLang(){return Fr.getState().lang}setPlaceholders(e){P(e)&&Nr({placeholders:e})}getPlaceholders(){return Fr.getState().placeholders}setIsSandbox(e){Br({isSandbox:e})}setApiKey(e){Wr({apiKey:e}),ss()}get appearanceManager(){return this._appearanceManager}set appearanceManager(e){this._appearanceManager=e}set storyReaderNeedFirstRender(e){this._storyReaderNeedFirstRender=e}set storyReaderNeedLoaderRender(e){this._storyReaderNeedLoaderRender=e}set storyReaderDetachComponent(e){this._storyReaderDetachComponent=e}get storyReaderInstance(){return this._storyReaderInstance}async getStoryReaderInstance(){return new Promise((e=>{null==this._storyReaderInstance?(null==this.storyReaderInstancePromise&&(null!=this._storyReaderNeedFirstRender&&this._storyReaderNeedFirstRender(!0),this.storyReaderInstancePromise=new Promise((e=>this.storyReaderInstancePromiseResolver=e))),this.storyReaderInstancePromise.then((t=>{this._storyReaderInstance=t,e(t)}))):e(this._storyReaderInstance)}))}showStoryReaderLoader(e){null!=this._storyReaderNeedLoaderRender&&this._storyReaderNeedLoaderRender(e)}set storyFavoriteReaderNeedFirstRender(e){this._storyFavoriteReaderNeedFirstRender=e}set storyFavoriteReaderNeedLoaderRender(e){this._storyFavoriteReaderNeedLoaderRender=e}set storyFavoriteReaderDetachComponent(e){this._storyFavoriteReaderDetachComponent=e}get storyFavoriteReaderInstance(){return this._storyFavoriteReaderInstance}async getStoryFavoriteReaderInstance(){return new Promise((e=>{null==this._storyFavoriteReaderInstance?(null==this.storyFavoriteReaderInstancePromise&&(null!=this._storyFavoriteReaderNeedFirstRender&&this._storyFavoriteReaderNeedFirstRender(!0),this.storyFavoriteReaderInstancePromise=new Promise((e=>this.storyFavoriteReaderInstancePromiseResolver=e))),this.storyFavoriteReaderInstancePromise.then((t=>{this._storyFavoriteReaderInstance=t,e(t)}))):e(this._storyFavoriteReaderInstance)}))}showStoryFavoriteReaderLoader(e){null!=this._storyFavoriteReaderNeedLoaderRender&&this._storyFavoriteReaderNeedLoaderRender(e)}async handleClickOnStoryInternal(e,t){let r;try{this.emit("openStoryReader",e),r=await this.getStoryReaderInstance(),r.emit("openStoryReader",e),this.showStoryReaderLoader(!0);let s=bs.getState(),i=null!==s;s&&Ss.getState().length>0&&s.ids!==Ss.getState()&&(i=!1),i=!1,cs.getState().find((t=>t.id===e.id));let o=Us(e.listType,t).map((e=>e.id));await Ts({ids:o,id:e.id});let n={...e,storyContext:bs.getState(),storyList:Us(e.listType,t),hasShare:ts.getState().share,platform:this.getDevicePlatform()};r.openReader(n,{listType:e.listType,feed:t});let a=Ss.getState();a.length>0&&await Fs({ids:a}),r.setStories({listType:e.listType,storyList:Us(e.listType,t)})}catch(e){this.showStoryReaderLoader(!1),r&&r.closeStoryReaderOrLoader(),console.log(e)}}completeInitStoryReader(e,t,s){return e.setFonts(t),e.setCallbacks({}),e.on('storyOpenedInternal',(e=>{var t;return null===(t=this.storyListInstance)||void 0===t?void 0:t.onStoryOpened(e)})),e.on('setStoryOpened',(async t=>{if(!W(ts.getState().user_key)){let e=`u/${ts.getState().user_key}/s_opened`,r=await this.localStorageGetArray(e);I(r)||(r=[]),r.push(t.id),r=[...new Set(r)],this.localStorageSetArray(e,r)}Ls({id:t.id}),e.rpcCb({requestId:t.__cb.id,success:!0,data:t,err:''})})),e.on('updateStoryFavorite',(async t=>{let r=!1,s={favorite:void 0},i='';try{let e=await es.post(`story-favorite/${t.id}`,{value:t.favorite});void 0!==e.data.favorite?(r=!0,s.favorite=Boolean(e.data.favorite),ws({id:t.id,favorite:s.favorite}),Ms(!1===s.favorite?{storiesIdsUserEntity:us.FAVORITE,storyList:ms.getState().filter((e=>e.id!==t.id))}:{storiesIdsUserEntity:us.FAVORITE,storyList:[...ms.getState(),...cs.getState().filter((e=>e.id===t.id))]})):i='response.data.favorite is undefined'}catch(e){i=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:s,err:i})})),e.on('updateStoryLike',(async t=>{let r=!1,s={like:void 0},i='';try{let e=await es.post(`story-like/${t.id}`,{value:t.like});void 0!==e.data.like?(r=!0,s.like=e.data.like):i='response.data.like is undefined'}catch(e){i=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:s,err:i})})),e.on('getStorySharePath',(async t=>{let r=!1,s={url:void 0},i='';try{let e=await es.get(`story-share/${t.id}`);void 0!==e.data.url?(r=!0,s.url=e.data.url,storyItemLikeChanged({id:t.id,url:s.url})):i='response.data.url is undefined'}catch(e){i=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:s,err:i})})),e.on('apiRequest',(async t=>{let r=!1,s='',i={url:t.url,method:t.method};-1!==['post','put','path'].indexOf(t.method)?t.data&&(i.data=t.data):i.params=t.params;let o={};try{let e=await es.request(i);o.data=e.data,o.status=e.status,o.headers=e.headers,r=!0}catch(e){o.data=e,o.status=400,o.headers=[{}],s=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:o,err:s})})),e.on('updateStoriesStat',(async t=>{let r=!1,s={},i='';try{let e=await es.post("session/update",t.data);void 0!==e.data?(r=!0,s=e.data):i='response.data is undefined'}catch(e){i=e.toString()}e.rpcCb({requestId:t.__cb.id,success:r,data:s,err:i})})),0===e.listenerCount('clickOnButton')&&e.on('clickOnButton',(e=>{if(r(this._callbacks.storyLinkClickHandler)||this.listenerCount(Ue.CLICK_ON_STORY)>0){let t={src:'storyReader',srcRef:'default',data:e};try{r(this._callbacks.storyLinkClickHandler)&&this._callbacks.storyLinkClickHandler(t),this.emit(Ue.CLICK_ON_STORY,t)}catch(e){console.error(e)}}else window.open(e.url,'_self')})),e.on('clickOnSwipeUpGoods',(t=>{e&&(this._goodsWidgetInstance=new Vs(this,appearanceManager,e,t),this._goodsWidgetInstance.once('close',(t=>{this._goodsWidgetInstance=null,e&&e.closeGoodsWidget(t)})))})),e.on('openedStoryReader',(()=>{this.showStoryReaderLoader(!1)})),e.on('openStoryReader',(()=>{})),e.on('closeStoryReader',(()=>{var t;null===(t=Gs.instance)||void 0===t||t.closeGoodsWidget(),null!=this._storyReaderDetachComponent&&this._storyReaderDetachComponent(e),this.storyReaderInstancePromise=null,this._storyReaderInstance=null,this.showStoryReaderLoader(!1),e.emit("modalClosed")})),['showSlide','showStory','closeStory','clickOnButton','likeStory','dislikeStory','favoriteStory','shareStory','shareStoryWithPath'].forEach((t=>e.on(t,(r=>{let s=e.sourceInfo.listType,i=e.sourceInfo.feed,o={title:null,tags:[],slidesCount:null,feed:null,source:null},n=cs.getState().find((e=>e.id===r.id));n&&(o.title=n.title,o.tags=n.tags,o.slidesCount=n.slides_count),o.feed=i,s===je.direct?o.source=Be.direct:s===je.default?o.source=Be.list:s===je.onboarding?o.source=Be.onboarding:s===je.favorite&&(o.source=Be.favorite),this.emit(t,{...r,...o})})))),e}completeInitStoryFavoriteReader(e,t){return e.setFonts(t),e.setCallbacks({}),e.on('openedStoryFavoriteReader',(()=>{this.showStoryFavoriteReaderLoader(!1)})),e.on('clickOnStoryInternal',(t=>{let r={title:null,tags:[],slidesCount:null,feed:null,source:null},s=cs.getState().find((e=>e.id===t.id));s&&(r.title=s.title,r.tags=s.tags,r.slidesCount=s.slides_count),r.feed=e.sourceInfo.feed,r.source=Be.favorite,this.emit("clickOnStory",{id:t.id,index:t.index,isDeeplink:t.isDeeplink,...r}),this.handleClickOnStoryInternal(t,e.sourceInfo.feed)})),e.on('closeStoryFavoriteReader',(()=>{null!=this._storyFavoriteReaderDetachComponent&&this._storyFavoriteReaderDetachComponent(e),this.storyFavoriteReaderInstancePromise=null,this._storyFavoriteReaderInstance=null,this.showStoryFavoriteReaderLoader(!1),e.emit("modalClosed")})),e}async showOnboardingStories(e,t){let r="onboarding";t&&t.feed&&j(t.feed)&&(r=t.feed);let s={feed:r,defaultListLength:0,favoriteListLength:0,success:!0,error:{name:"",networkStatus:200,networkMessage:""}};try{await _s({defaultList:!1,onboardingList:r,favoriteList:!1,onboardingTags:t?t.customTags:void 0,limit:t?t.limit:void 0}),s.feed=r,s.success=!0,s.error=null,s.defaultListLength=Us(je.onboarding,r).length}catch(e){s.feed=r,s.success=!1,s.error={name:e.name,networkMessage:e.networkMessage,networkStatus:e.networkStatus}}let i=Us(je.onboarding,r);if(i.length>0){let e={windowReferer:We.default,listType:je.onboarding,id:i[0].id};return await this.handleClickOnStoryInternal(e,r),s}return s}async showStory(e,t,r){let s,i=!1;try{this.emit("openStoryReader",{}),this.showStoryReaderLoader(!0),await Hs({id:e}),s=await this.getStoryReaderInstance(),s.emit("openStoryReader",{}),i=await qs(e,s,this.getDevicePlatform())}catch(e){i=!1}return i||(this.showStoryReaderLoader(!1),s&&s.closeStoryReaderOrLoader()),{loaded:i}}async closeStoryReader(){if(null===this.storyReaderInstancePromise)return!1;let e=await this.getStoryReaderInstance();this.closeGoodsWidget(),e.closeStoryReaderOrLoader()}closeGoodsWidget(){this._goodsWidgetInstance&&(this._goodsWidgetInstance.close(),this._goodsWidgetInstance=null)}set androidDefaultWindowSoftInputMode(e){this._androidDefaultWindowSoftInputMode=e}}let Ks;var Js;Gs.instance=void 0,(e=>{e.CSS="text/css",e.JS="text/javascript",e.HTML="text/html"})(Ks||(Ks={})),(e=>{e.START_LOADER="startLoader",e.END_LOADER="endLoader"})(Js||(Js={}));class Zs extends n{get loaderContainer(){return this._loaderContainer}setCallbacks(e){this.callbacks=e}constructor(){super(),this.widgetId=void 0,this.callbacks={},this.obj=void 0,this._loaderContainer=null}async init(e,t){}loading(e,t){}startLoader(){let e=(e=>{let t=window.isSecureContext;return void 0===t&&'https:'===window.location.protocol&&(t=!0),t?e:e.replace(/^https:\/\//,'http://')})(`${process.env.BASE_URL}/v0.2.27/dist/images/loader.gif`);this.loaderContainer.style.background=`url("${e}") center center no-repeat transparent`}stopLoader(){this.loaderContainer.style.background='none'}getGeneratedPageURL(e){let{html:t,css:r,js:s}=e,i='',o='';null!==r&&(i=`<link rel="stylesheet" type="text/css" href="${U(r,Ks.CSS)}" />`),null!==s&&(o=`<script >${U(s,Ks.JS)}</script>`);let n=`\n    <html>\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1">\n        ${i}\n        ${o}\n      </head>\n      <body>\n        ${t||''}\n      </body>\n    </html>\n  `;null!==r&&(i=`<style>${r}</style>`),null!==s&&(o=`<script>${s}</script>`);let a=`\n    <html>\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1">\n        ${i}\n        ${o}\n      </head>\n      <body>\n        ${t||''}\n      </body>\n    </html>\n        `;return{src:U(n,Ks.HTML),srcdoc:a}}getWidgetDocument(e){return''}destroy(e,t){var r=Zs.RPC[e];r||r.destroy(),obj.innerHTML=''}}Zs.count=0,Zs.RPC={};class zs{}zs.version='v1',zs.MD5=e=>{var t=(e,t)=>{var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r},r=(e,r,s,i,o,n)=>t(((e,t)=>e<<t|e>>>32-t)(t(t(r,e),t(i,n)),o),s),s=(e,t,s,i,o,n,a)=>r(t&s|~t&i,e,t,o,n,a),i=(e,t,s,i,o,n,a)=>r(t&i|s&~i,e,t,o,n,a),o=(e,t,s,i,o,n,a)=>r(t^s^i,e,t,o,n,a),n=(e,t,s,i,o,n,a)=>r(s^(t|~i),e,t,o,n,a);return(e=>{for(var t,r="0123456789abcdef",s="",i=0,o=e.length;i<o;i++)t=e.charCodeAt(i),s+=r.charAt(t>>>4&15)+r.charAt(15&t);return s})((e=>(e=>{for(var t="",r=0,s=32*e.length;r<s;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t})(((e,r)=>{var a,l,d,c,u=1732584193,h=-271733879,p=-1732584194,f=271733878;e[r>>5]|=128<<r%32,e[14+(r+64>>>9<<4)]=r;for(var g=0,m=e.length;g<m;g+=16)a=u,l=h,d=p,c=f,u=s(u,h,p,f,e[g+0],7,-680876936),f=s(f,u,h,p,e[g+1],12,-389564586),p=s(p,f,u,h,e[g+2],17,606105819),h=s(h,p,f,u,e[g+3],22,-1044525330),u=s(u,h,p,f,e[g+4],7,-176418897),f=s(f,u,h,p,e[g+5],12,1200080426),p=s(p,f,u,h,e[g+6],17,-1473231341),h=s(h,p,f,u,e[g+7],22,-45705983),u=s(u,h,p,f,e[g+8],7,1770035416),f=s(f,u,h,p,e[g+9],12,-1958414417),p=s(p,f,u,h,e[g+10],17,-42063),h=s(h,p,f,u,e[g+11],22,-1990404162),u=s(u,h,p,f,e[g+12],7,1804603682),f=s(f,u,h,p,e[g+13],12,-40341101),p=s(p,f,u,h,e[g+14],17,-1502002290),h=s(h,p,f,u,e[g+15],22,1236535329),u=i(u,h,p,f,e[g+1],5,-165796510),f=i(f,u,h,p,e[g+6],9,-1069501632),p=i(p,f,u,h,e[g+11],14,643717713),h=i(h,p,f,u,e[g+0],20,-373897302),u=i(u,h,p,f,e[g+5],5,-701558691),f=i(f,u,h,p,e[g+10],9,38016083),p=i(p,f,u,h,e[g+15],14,-660478335),h=i(h,p,f,u,e[g+4],20,-405537848),u=i(u,h,p,f,e[g+9],5,568446438),f=i(f,u,h,p,e[g+14],9,-1019803690),p=i(p,f,u,h,e[g+3],14,-187363961),h=i(h,p,f,u,e[g+8],20,1163531501),u=i(u,h,p,f,e[g+13],5,-1444681467),f=i(f,u,h,p,e[g+2],9,-51403784),p=i(p,f,u,h,e[g+7],14,1735328473),h=i(h,p,f,u,e[g+12],20,-1926607734),u=o(u,h,p,f,e[g+5],4,-378558),f=o(f,u,h,p,e[g+8],11,-2022574463),p=o(p,f,u,h,e[g+11],16,1839030562),h=o(h,p,f,u,e[g+14],23,-35309556),u=o(u,h,p,f,e[g+1],4,-1530992060),f=o(f,u,h,p,e[g+4],11,1272893353),p=o(p,f,u,h,e[g+7],16,-155497632),h=o(h,p,f,u,e[g+10],23,-1094730640),u=o(u,h,p,f,e[g+13],4,681279174),f=o(f,u,h,p,e[g+0],11,-358537222),p=o(p,f,u,h,e[g+3],16,-722521979),h=o(h,p,f,u,e[g+6],23,76029189),u=o(u,h,p,f,e[g+9],4,-640364487),f=o(f,u,h,p,e[g+12],11,-421815835),p=o(p,f,u,h,e[g+15],16,530742520),h=o(h,p,f,u,e[g+2],23,-995338651),u=n(u,h,p,f,e[g+0],6,-198630844),f=n(f,u,h,p,e[g+7],10,1126891415),p=n(p,f,u,h,e[g+14],15,-1416354905),h=n(h,p,f,u,e[g+5],21,-57434055),u=n(u,h,p,f,e[g+12],6,1700485571),f=n(f,u,h,p,e[g+3],10,-1894986606),p=n(p,f,u,h,e[g+10],15,-1051523),h=n(h,p,f,u,e[g+1],21,-2054922799),u=n(u,h,p,f,e[g+8],6,1873313359),f=n(f,u,h,p,e[g+15],10,-30611744),p=n(p,f,u,h,e[g+6],15,-1560198380),h=n(h,p,f,u,e[g+13],21,1309151649),u=n(u,h,p,f,e[g+4],6,-145523070),f=n(f,u,h,p,e[g+11],10,-1120210379),p=n(p,f,u,h,e[g+2],15,718787259),h=n(h,p,f,u,e[g+9],21,-343485551),u=t(u,a),h=t(h,l),p=t(p,d),f=t(f,c);return[u,h,p,f]})((e=>{var t,r,s=Array(e.length>>2);for(t=0,r=s.length;t<r;t++)s[t]=0;for(t=0,r=8*e.length;t<r;t+=8)s[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return s})(e),8*e.length)))((e=>{for(var t,r,s="",i=-1,o=e.length;++i<o;)t=e.charCodeAt(i),r=i+1<o?e.charCodeAt(i+1):0,55296<=t&&t<=56319&&56320<=r&&r<=57343&&(t=65536+((1023&t)<<10)+(1023&r),i++),t<=127?s+=String.fromCharCode(t):t<=2047?s+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?s+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(s+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return s})(e)))},zs.extend=(e,t,r)=>{for(let s in t)t.hasOwnProperty(s)&&(r||void 0===e[s])&&(e[s]=t[s]);return e},zs._protocol='https:',zs._base_domain='',zs.Widget=Zs,zs.xdConnectionCallbacks=void 0,zs.init=void 0,zs._apiKey=void 0,zs.userId=void 0,zs.XDM=void 0,zs._domain=void 0,zs._path=void 0,zs.xdReady=void 0,zs.Observer=void 0,zs._rootId=void 0,zs.Util=void 0,zs.xdConnectionCallbacks?setTimeout((()=>{for(var e;e=zs.xdConnectionCallbacks.pop();)e()}),0):(zs.extend(zs,{version:1,_apiKey:null,_session:null,_domain:{main:zs._protocol+'//sdk-narrator.kiozk.ru/',api:zs._protocol+'//api-narrator.kiozk.ru/'},_path:{login:'authorize',proxy:'fxdm_oauth_proxy.html'},_rootId:'ias_api_transport',_nameTransportPath:'',xdReady:!1}),zs.init=e=>{if(zs._apiKey=null,!e.apiKey)throw Error('IAS_OLD.init() called without an apiKey');return zs._apiKey=e.apiKey,zs.userId=e.userId,!0});const Xs="FxDomainWidgetStoriesList",Ys=O(`server${Xs}`),Qs=O(`client${Xs}`);let ei,ti,ri={serverFxDomain:Ys,clientFxDomain:Qs},si=Qs.effect(Xs+"setStories"),ii=Qs.effect(Xs+"setFonts"),oi=Qs.effect(Xs+"checkWebPSupport"),ni=Ys.effect(Xs+"widgetLoaded"),ai=Ys.effect(Xs+"clickOnStoryInternalEvent"),li=Ys.effect(Xs+"clickOnFavoriteCellInternalEvent"),di=Ys.effect(Xs+"flushThumbViewsEvent"),ci=Ys.effect(Xs+"clickOnStoryEvent"),ui=Ys.effect(Xs+"clickOnStoryDeepLinkEvent"),hi=Ys.effect(Xs+"debug");(e=>{e[e.REQUEST=0]="REQUEST",e[e.RESPONSE=1]="RESPONSE"})(ei||(ei={})),(e=>{e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR"})(ti||(ti={}));let pi=0;class fi{constructor(){this.id=++pi,this.rs=()=>{},this.rj=()=>{},this.req=void 0,gi.set(this.id,this);let e=new Promise(((e,t)=>{this.rs=e,this.rj=t}));e.finally((()=>{gi.delete(this.id)})).catch((()=>{})),this.req=e}}const gi=new Map,mi=new Map;class yi{constructor(e,t){this.receiverEffects=[],this.senderEffects=[];let r=b();t.onmessage=r,r.watch((e=>{Object(e)===e&&e.sid&&e.id&&((e=>{if(e.type!==ei.RESPONSE)return;let t=gi.get(e.id);if(t)if(e.status===ti.SUCCESS)t.rs(e.result);else{if('raw'in e.error)return void t.rj(e.error.raw);let r=Error('');'name'in e.error&&(r.name=e.error.name),'message'in e.error&&(r.message=e.error.message),'stack'in e.error&&(r.stack=e.error.stack),'code'in e.error&&(r.code=e.error.code),t.rj(r)}})(e),(async(e,t)=>{if(e.type!==ei.REQUEST)return;let r=mi.get(e.sid);r?await r(e.params).then((r=>{t.sendMessage({id:e.id,sid:e.sid,type:ei.RESPONSE,status:ti.SUCCESS,result:r})})).catch((r=>{let s={};r instanceof Error?(s.name=r.name,'code'in r&&(s.code=r.code),'message'in r&&(s.message=r.message),'stack'in r&&(s.stack=r.stack)):s.raw=r,t.sendMessage({id:e.id,sid:e.sid,type:ei.RESPONSE,status:ti.ERROR,error:s})})):t.sendMessage({id:e.id,sid:e.sid,type:ei.RESPONSE,status:ti.ERROR,error:{name:'RemoteFXError',message:`Unknown sid "${e.sid}"`}})})(e,t))})),e.fxReceiverDomain.onCreateEffect((e=>{let t=e.sid||e.shortName;mi.set(t,e),this.receiverEffects.push(t)})),e.fxSenderDomain.onCreateEffect((e=>{e.use((r=>{let s=new fi;return t.sendMessage({id:s.id,sid:e.sid||e.shortName,type:ei.REQUEST,params:r}),s.req})),this.senderEffects.push(e)}))}destructor(){this.receiverEffects.forEach((e=>mi.delete(e))),this.receiverEffects=[],this.senderEffects.forEach((e=>e.use((e=>e)))),this.senderEffects=[]}}class vi{constructor(e){this.webview=e,this._destructor=void 0,this.onMessageCb=null,this._destructor=()=>{}}createOnMessage(){return e=>{this.messageListener(e)}}destructor(){this._destructor()}messageListener(e){let t={};try{t=JSON.parse(e.nativeEvent.data)}catch(e){console.error(e)}r(this.onMessageCb)&&this.onMessageCb(t)}sendMessage(e){try{this.webview.postMessage(JSON.stringify(e))}catch(e){console.log(e)}}set onmessage(e){this.onMessageCb=e}}class Si extends Zs{get feedSlug(){return this._feedSlug}get testKey(){return this._testKey}get listLoadStatus(){return this._listLoadStatus}setListLoadStatusField(e,t){this._listLoadStatus[e]=t}constructor(e,t,s){super(),this.appearanceManager=e,this.storiesListOptions=void 0,this._listLoadStatus={feed:"default",defaultListLength:0,favoriteListLength:0,success:!0,error:{name:"",networkStatus:200,networkMessage:""}},this._feedSlug=void 0,this._testKey=void 0,this.rpc=void 0,this.frameName='',this.rpcOnMessage=e=>{this.rpcBridge&&this.rpcBridge(e)},this.rpcBridge=null,this.forUnsubscribe=[],this._feedSlug=null!=t?t:"default",this._testKey=s,this.storiesListOptions={...e.storiesListOptions,hasFavorite:e.commonOptions.hasFavorite},this.widgetId=++Zs.count,ni.use((()=>{this.emit("widgetLoaded")})),ai.use((e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryInternal)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryInternal(e))})),li.use((e=>{this.emit("clickOnFavoriteCellInternal",e)})),di.use((e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleFlushThumbViews)&&(null===(s=this.callbacks)||void 0===s||s.handleFlushThumbViews(e))})),ci.use((e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStory)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStory(e))})),ui.use((e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryDeepLink)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryDeepLink(e))})),hi.use((e=>{console.log(e)}))}get widgetSrcFile(){return we}get widgetEntrypoint(){return`\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, shrink-to-fit=no">\n        <style type="text/css">${Le}</style>\n      </head>\n      <div id="app"><div id="_app"></div></div>\n      <script type="text/javascript">${we}</script>\n      <script type="text/javascript">\n        window.storiesList = (function () {\n          var self = window.storiesList || {};\n          self._e = self._e || [];\n          self.ready = self.ready || function (f) {self._e.push(f);};\n          return self;\n        }());\n\n        window.storiesList.ready(function () {\n          window.storiesList.init(${JSON.stringify(this.storiesListOptions)});\n        });\n\n      </script>`}async mount(e,t){let r={allowTransparency:!0,overflowTouch:!1,backgroundColor:t.layout.backgroundColor,width:'auto',height:0,pageUrl:'',startHeight:0};r.startHeight=t.layout.height?t.layout.height:t.title?50+t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin:t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin,this.createView(e,r)}createView(e,t){'body'===e||document.querySelector(e)}extend(e,t){for(var r in t)e[r]&&'object'==typeof e[r]?this.extend(e[r],t[r]):e[r]=t[r]}genKey(){for(var e='',t=0;t<5;t++)e+=Math.ceil(15*Math.random()).toString(16);return e}mountView(e,t,r){this.frameName='fXD'+this.genKey();let s=document.createElement('div');s.innerHTML='<iframe name="'+this.frameName+'" '+(r||'')+'></iframe>';let i=s.firstChild,o=this;return setTimeout((()=>{i.frameBorder='0',t&&o.extend(i,t),e.insertBefore(i,e.firstChild)}),0),i}get containerOptions(){var e,t,r,s;let i={storiesHeight:(null===(e=this.storiesListOptions.card)||void 0===e?void 0:e.height)||70,storiesLayoutHeight:(null===(t=this.storiesListOptions.layout)||void 0===t?void 0:t.height)||0,storiesBackgroundColor:(null===(r=this.storiesListOptions.layout)||void 0===r?void 0:r.backgroundColor)||'transparent',storiesListTopPadding:null!=this.storiesListOptions.topPadding?this.storiesListOptions.topPadding:20,storiesListBottomPadding:null!=this.storiesListOptions.bottomPadding?this.storiesListOptions.bottomPadding:20,storiesListBottomMargin:null!=this.storiesListOptions.bottomMargin?this.storiesListOptions.bottomMargin:20,storiesTitle:(null===(s=this.storiesListOptions.title)||void 0===s?void 0:s.content)||'',extraCss:this.storiesListOptions.extraCss||null,extraJs:null},o={maxWidth:0,startHeight:70,minWidth:150,storiesHeight:70,scrolling:!1,hidden:!1};o.startHeight=i.storiesLayoutHeight?parseFloat(i.storiesLayoutHeight):i.storiesTitle?50+parseFloat(i.storiesHeight||o.storiesHeight)+parseFloat(i.storiesListTopPadding)+parseFloat(i.storiesListBottomPadding)+parseFloat(i.storiesListBottomMargin):parseFloat(i.storiesHeight||o.storiesHeight)+parseFloat(i.storiesListTopPadding)+parseFloat(i.storiesListBottomPadding)+parseFloat(i.storiesListBottomMargin);let n=parseInt(0,10),a=n?Math.max(o.minWidth,Math.min(1e4,n))+'px':'100%',l={style:{}};return l.style.width=a,l.style.overflow='hidden',l.style.height=(o.startHeight||200)+'px',{style:{position:'relative',height:parseInt(l.style.height),width:"100%",backgroundColor:"transparent",overflow:"hidden"}}}get viewOptions(){var e,t,r,s;this.frameName||(this.frameName='fXD'+this.genKey());let i={allowTransparency:!0,overflowTouch:!1,backgroundColor:this.storiesListOptions.layout.backgroundColor,width:0,height:0,pageUrl:'',startHeight:0},o={storiesHeight:(null===(e=this.storiesListOptions.card)||void 0===e?void 0:e.height)||70,storiesLayoutHeight:(null===(t=this.storiesListOptions.layout)||void 0===t?void 0:t.height)||0,storiesBackgroundColor:(null===(r=this.storiesListOptions.layout)||void 0===r?void 0:r.backgroundColor)||'transparent',storiesListTopPadding:null!=this.storiesListOptions.topPadding?this.storiesListOptions.topPadding:20,storiesListBottomPadding:null!=this.storiesListOptions.bottomPadding?this.storiesListOptions.bottomPadding:20,storiesListBottomMargin:null!=this.storiesListOptions.bottomMargin?this.storiesListOptions.bottomMargin:20,storiesTitle:(null===(s=this.storiesListOptions.title)||void 0===s?void 0:s.content)||'',extraCss:this.storiesListOptions.extraCss||null,extraJs:null},n={maxWidth:0,startHeight:70,storiesHeight:70,minWidth:150,scrolling:!1,hidden:!1};n.startHeight=o.storiesLayoutHeight?parseFloat(o.storiesLayoutHeight):o.storiesTitle?50+parseFloat(o.storiesHeight||n.storiesHeight)+parseFloat(o.storiesListTopPadding)+parseFloat(o.storiesListBottomPadding)+parseFloat(o.storiesListBottomMargin):parseFloat(o.storiesHeight||n.storiesHeight)+parseFloat(o.storiesListTopPadding)+parseFloat(o.storiesListBottomPadding)+parseFloat(o.storiesListBottomMargin);let a=parseInt(0,10),l=a?Math.max(n.minWidth,Math.min(1e4,a))+'px':'100%',d={src:'',id:'iaswidget'+this.widgetId,allowtransparency:Boolean(i.allowTransparency).toString(),style:{backgroundColor:i.backgroundColor||'transparent'}};return d.width=-1!=l.indexOf('%')?l:parseInt(l)||l,d.height=n.startHeight||'100%',d.style.width='1px',d.style.minWidth='100%',d.style["*width"]='100%',d.scrolling='no',d.style.overflow='hidden',{style:{width:'100%',height:d.height,backgroundColor:"transparent"},source:{html:this.widgetEntrypoint,baseUrl:'https://sdk.inappstory.com'},onMessage:this.rpcOnMessage}}createRpcServer(e){let t=new vi(e);this.rpcBridge=t.createOnMessage(),$(ri,t)}async init(e,t){var r,s,i,o;let n={storiesHeight:(null===(r=t.card)||void 0===r?void 0:r.height)||70,storiesLayoutHeight:(null===(s=t.layout)||void 0===s?void 0:s.height)||0,storiesBackgroundColor:(null===(i=t.layout)||void 0===i?void 0:i.backgroundColor)||'transparent',storiesListTopPadding:t.topPadding||20,storiesListBottomPadding:t.bottomPadding||20,storiesListBottomMargin:t.bottomMargin||20,storiesTitle:(null===(o=t.title)||void 0===o?void 0:o.content)||'',extraCss:t.extraCss||null,extraJs:null},a={allowTransparency:!0,overflowTouch:!1};a.backgroundColor=n.storiesBackgroundColor;var l={startHeight:70,minWidth:150,storiesHeight:70};l.startHeight=n.storiesLayoutHeight?parseFloat(n.storiesLayoutHeight):n.storiesTitle?50+parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin):parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin),document.querySelector('body'),document.querySelector('html');let d=this,c={event:(e,t)=>{d.emit(e,t)}};return n.extraJs=null,a.no_finish_loading=!0,this._init(e,a,n,t,c,l,(()=>{}),null,null)}getWidgetDocument(e){let t=`${process.env.BASE_URL}/v0.2.27/dist/js/storiesList.js`;return t=we,`\n        <script type="text/javascript" src="${t}"></script>\n        <div id="app"><div id="_app"></div></div>\n        <script type="text/javascript">\n          window.storiesList.init(${JSON.stringify(e)});\n        </script>\n`}async _init(e,t,s,i,o,n,a,l,d){o.event=(e,t)=>this.emit(e,t);let c=super._init(e,t,s,i,o,n,((e,t,r)=>{this.rpc=r}),l,d);return this.on('clickOnStoryInternal',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryInternal)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryInternal(e))})),this.on('flushThumbViews',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleFlushThumbViews)&&(null===(s=this.callbacks)||void 0===s||s.handleFlushThumbViews(e))})),this.on('clickOnStory',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStory)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStory(e))})),this.on('clickOnStoryDeepLink',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryDeepLink)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryDeepLink(e))})),this.on('syncStore',(()=>{})),c}onStoryOpened(e){this.rpc.callMethod('onStoryOpened',e)}syncStoreHandle(e){this.rpc.callMethod('onSyncStore',e)}setStories(e){si(e)}setFonts(e){ii(e)}checkWebPSupport(){return oi()}destructor(){this.forUnsubscribe.map((e=>e())),this.forUnsubscribe=[]}}exports.StoryReaderCloseButtonPosition=void 0,(e=>{e.LEFT="left",e.RIGHT="right"})(exports.StoryReaderCloseButtonPosition||(exports.StoryReaderCloseButtonPosition={})),exports.StoryReaderSwipeStyle=void 0,(e=>{e.FLAT="flat",e.COVER="cover",e.CUBE="cube"})(exports.StoryReaderSwipeStyle||(exports.StoryReaderSwipeStyle={}));const wi={closeButtonPosition:exports.StoryReaderCloseButtonPosition.RIGHT,scrollStyle:exports.StoryReaderSwipeStyle.FLAT,loader:{default:{color:null,accentColor:null},custom:null},recycleStoriesList:!1,closeOnLastSlideByTimer:!0,faviconApiUrl:""},Li={hasFavorite:!1,hasLike:!1,hasShare:!1},Ci="FxDomainWidgetStory",bi=O(`server${Ci}`),Ri=O(`client${Ci}`);let ki={serverFxDomain:bi,clientFxDomain:Ri},_i=Ri.effect(Ci+"setStories"),Oi=Ri.effect(Ci+"setFonts"),Ei=Ri.effect(Ci+"onOpenReader"),Ii=Ri.effect(Ci+"onCloseReader"),Pi=Ri.effect(Ci+"onPauseUI"),Ai=Ri.effect(Ci+"onResumeUI"),Mi=bi.effect(Ci+"widgetLoaded"),Fi=bi.effect(Ci+"onReaderOpened"),xi=bi.effect(Ci+"onReaderClosed"),Ti=bi.effect(Ci+"widgetEvent"),Hi=Ri.effect(Ci+"widgetEventCb"),Ni=bi.effect(Ci+"shareStoryInternal"),Di=bi.effect(Ci+"debug");const Bi=le.StyleSheet.create({emptyOverlay:{backgroundColor:'transparent',height:0,position:'absolute',width:0},fullOverlay:{backgroundColor:'transparent',bottom:0,left:0,position:'absolute',right:0,top:0}});class Wi extends Se.Component{constructor(...e){super(...e),((e,t,r)=>{t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})(this,"state",{fadeAnim:new le.Animated.Value(0),overlayStyle:Bi.emptyOverlay})}UNSAFE_componentWillReceiveProps(e){return e.visible&&this.setState({overlayStyle:Bi.fullOverlay}),le.Animated.timing(this.state.fadeAnim,{toValue:e.visible?1:0,duration:300,useNativeDriver:!1}).start(this.onAnimatedEnd.bind(this))}onAnimatedEnd(){this.props.visible||this.setState({overlayStyle:Bi.emptyOverlay})}render(){return Se.createElement(le.Animated.View,{style:[this.state.overlayStyle,{opacity:this.state.fadeAnim}]},this.props.children)}}class ji extends Se.Component{constructor(...e){super(...e),((e,t,r)=>{t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})(this,"state",{bottom:new le.Animated.Value(-300)})}UNSAFE_componentWillReceiveProps(e){return le.Animated.timing(this.state.bottom,{toValue:e.visible?0:-300,duration:300,useNativeDriver:!1}).start()}render(){return Se.createElement(le.Animated.View,{style:{bottom:this.state.bottom}},this.props.children)}}const Vi=le.StyleSheet.create({button:{backgroundColor:'white',flexDirection:'row',height:50,padding:10},buttonText:{color:'#2c2c2c',fontSize:16,fontWeight:'bold',textAlign:'left',textAlignVertical:'center'},icon:{height:28,marginLeft:10,marginRight:30,width:28}}),Ui=le.StyleSheet.create({actionSheetContainer:{backgroundColor:'rgba(0, 0, 0, 0.5)',flex:1,justifyContent:'flex-end',paddingBottom:0,paddingTop:10},buttonContainer:{backgroundColor:'white',overflow:'hidden',paddingBottom:5,paddingTop:5},button:{flex:1}}),$i=('string'==typeof le.Platform.Version?parseInt(le.Platform.Version,10):le.Platform.Version)<19,qi=async e=>{if((e.url||e.urls)&&'android'===le.Platform.OS){const t=e.urls||(e.url?[e.url]:[]);try{if(!(await Promise.all(t.map((e=>new Promise(((t,r)=>{le.NativeModules.RNShare.isBase64File(e,(e=>{r(e)}),(e=>{t(e)}))})))))).includes(!0))return Promise.resolve(!0);if(await le.PermissionsAndroid.check(le.PermissionsAndroid.PERMISSIONS.WRITE_EXTERNAL_STORAGE))return Promise.resolve(!0);if($i){if(await le.PermissionsAndroid.request(le.PermissionsAndroid.PERMISSIONS.WRITE_EXTERNAL_STORAGE)===le.PermissionsAndroid.RESULTS.GRANTED)return Promise.resolve(!0);throw new Error('Write Permission not available')}}catch(e){return Promise.reject(e)}}return Promise.resolve(!0)};let Gi,Ki;(e=>{e.Facebook="facebook",e.FacebookStories="facebookstories",e.Pagesmanager="pagesmanager",e.Twitter="twitter",e.Whatsapp="whatsapp",e.Whatsappbusiness="whatsappbusiness",e.Instagram="instagram",e.InstagramStories="instagramstories",e.Googleplus="googleplus",e.Email="email",e.Pinterest="pinterest",e.Linkedin="linkedin",e.Sms="sms",e.Telegram="telegram",e.Snapchat="snapchat",e.Messenger="messenger"})(Gi||(Gi={})),(e=>{e.BackgroundImage="shareBackgroundImage",e.BackgroundVideo="shareBackgroundVideo",e.StickerImage="shareStickerImage",e.BackgroundAndStickerImage="shareBackgroundAndStickerImage"})(Ki||(Ki={}));const Ji={Button:({buttonStyle:e,onPress:t,iconSrc:r,textStyle:s,children:i})=>Se.createElement(le.TouchableOpacity,{activeOpacity:.5,style:[Vi.button,e],onPress:t},Se.createElement(le.Image,{style:Vi.icon,source:r}),Se.createElement(le.Text,{style:[Vi.buttonText,s]},i)),ShareSheet:class extends Se.Component{componentDidMount(){this.backButtonHandler=this.backButtonHandler.bind(this),le.BackHandler.addEventListener('hardwareBackPress',this.backButtonHandler)}componentWillUnmount(){le.BackHandler.removeEventListener('hardwareBackPress',this.backButtonHandler)}backButtonHandler(){return!!this.props.visible&&(this.props.onCancel(),!0)}render(){const{style:e={},overlayStyle:t={},...r}=this.props;return Se.createElement(Wi,r,Se.createElement(le.View,{style:[Ui.actionSheetContainer,t]},Se.createElement(le.TouchableOpacity,{style:Ui.button,onPress:this.props.onCancel}),Se.createElement(ji,{visible:this.props.visible},Se.createElement(le.View,{style:[Ui.buttonContainer,e]},this.props.children))))}},Overlay:Wi,Sheet:ji,Social:{FACEBOOK:le.NativeModules.RNShare.FACEBOOK||Gi.Facebook,FACEBOOK_STORIES:le.NativeModules.RNShare.FACEBOOKSTORIES||Gi.FacebookStories,PAGESMANAGER:le.NativeModules.RNShare.PAGESMANAGER||Gi.Pagesmanager,TWITTER:le.NativeModules.RNShare.TWITTER||Gi.Twitter,WHATSAPP:le.NativeModules.RNShare.WHATSAPP||Gi.Whatsapp,WHATSAPPBUSINESS:le.NativeModules.RNShare.WHATSAPPBUSINESS||Gi.Whatsappbusiness,INSTAGRAM:le.NativeModules.RNShare.INSTAGRAM||Gi.Instagram,INSTAGRAM_STORIES:le.NativeModules.RNShare.INSTAGRAMSTORIES||Gi.InstagramStories,GOOGLEPLUS:le.NativeModules.RNShare.GOOGLEPLUS||Gi.Googleplus,EMAIL:le.NativeModules.RNShare.EMAIL||Gi.Email,PINTEREST:le.NativeModules.RNShare.PINTEREST||Gi.Pinterest,LINKEDIN:le.NativeModules.RNShare.LINKEDIN||Gi.Linkedin,SMS:le.NativeModules.RNShare.SMS||Gi.Sms,TELEGRAM:le.NativeModules.RNShare.TELEGRAM||Gi.Telegram,MESSENGER:le.NativeModules.RNShare.MESSENGER||Gi.Messenger,SNAPCHAT:le.NativeModules.RNShare.SNAPCHAT||Gi.Snapchat},open:e=>new Promise(((t,r)=>{qi(e).then((()=>{if('ios'===le.Platform.OS&&e.url&&!e.urls){const t=e.url;delete e.url,e.urls=[t],e.filename&&!e.filenames&&(e.filenames=[e.filename],delete e.filename)}le.NativeModules.RNShare.open(e,(e=>r({error:e})),((s,i)=>s?t({success:s,message:i}):!1===e.failOnCancel?t({dismissedAction:!0,success:s,message:i}):void r(new Error('User did not share'))))})).catch((e=>r(e)))})),shareSingle(e){if('ios'===le.Platform.OS||'android'===le.Platform.OS)return new Promise(((t,r)=>{qi(e).then((()=>{le.NativeModules.RNShare.shareSingle(e,(e=>r({error:e})),((e,r)=>t({success:e,message:r})))})).catch((e=>r(e)))}));throw new Error('Not implemented')},isPackageInstalled(e){if('android'===le.Platform.OS)return new Promise(((t,r)=>{le.NativeModules.RNShare.isPackageInstalled(e,(e=>r({error:e})),(e=>t({isInstalled:e,message:'Package is Installed'})))}));throw new Error('Not implemented')}};class Zi{constructor(){this._isOpen=!1,this._isWidgetConnected=!1}set isOpen(e){this._isOpen=e}get isOpen(){return this._isOpen}set isWidgetConnected(e){this._isWidgetConnected=e}get isWidgetConnected(){return this._isWidgetConnected}modalClosed(){this.isWidgetConnected=!1,this.isOpen=!1}}class zi extends Zs{constructor(e,t){void 0===t&&(t={}),super(),this.appearanceManagerGetter=e,this.overrideStoryReaderOptions=t,this.modalPresentation=void 0,this.openStoryReaderWithOptions={},this.rpc=void 0,this.frameName='',this.rpcOnMessage=e=>{this.rpcBridge&&this.rpcBridge(e)},this.rpcBridge=null,this.rpcServerInstance=null,this._sourceInfo={listType:je.default,feed:null},this.modalPresentation=new Zi,this.widgetId=++Zs.count,Mi.use((()=>{this.emit("widgetLoaded")})),Ti.use((e=>{let{name:t,payload:r}=e;this.emit(t,r)})),Fi.use((e=>{this.emit('openedStoryReader',e)})),xi.use((e=>{this.emit('closeStoryReader',e)})),Ni.use((async e=>{let t=!1,r={};Pi(),e.url?r={message:e.text,url:e.url}:e.files&&Array.isArray(e.files)&&(r={urls:e.files});try{let e=await Ji.open(r);P(e)&&(!0===(s=e.success)||!1===s)&&(t=e.success)}catch(e){t=!1}finally{Ai()}var s})),Ti.use((e=>{let{name:t,payload:r}=e;this.emit(t,r)})),Di.use((e=>{console.log(e)}));let r=()=>this.closeStoryReaderOrLoader();this.on('openStoryReader',(e=>{this.modalPresentation.isOpen=!0,this.openStoryReaderWithOptions=e,le.BackHandler.addEventListener("hardwareBackPress",r)})),this.on('openedStoryReader',(()=>{this.modalPresentation.isWidgetConnected=!0})),this.on('modalClosed',(()=>{le.BackHandler.removeEventListener("hardwareBackPress",r),this.modalPresentation.modalClosed()}))}closeStoryReaderOrLoader(){return this.modalPresentation.isWidgetConnected?(this.closeConnectedReaderWidget(),this.modalPresentation.modalClosed(),!0):!!this.modalPresentation.isOpen&&(this.emit("closeStoryReader",this.openStoryReaderWithOptions),!0)}get storyReaderOptions(){let e=this.appearanceManagerGetter();return null!=e?{...e.storyReaderOptions,appearanceCommon:e.commonOptions,...this.overrideStoryReaderOptions,faviconApiUrl:Qr.faviconApiUrl}:{...wi,appearanceCommon:Li,...this.overrideStoryReaderOptions,faviconApiUrl:Qr.faviconApiUrl}}get widgetSrcFile(){return Re}get widgetEntrypoint(){return`\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, shrink-to-fit=no">\n        <style type="text/css">${ke}</style>\n      </head>\n      <div id="app"><div id="_app"></div></div>\n      <script type="text/javascript">${Re}</script>\n      <script type="text/javascript">\n        window.storiesList = (function () {\n          var self = window.storiesList || {};\n          self._e = self._e || [];\n          self.ready = self.ready || function (f) {self._e.push(f);};\n          return self;\n        }());\n\n        window.storyReader.ready(function () {\n          window.storyReader.init(${JSON.stringify(this.storyReaderOptions)});\n        });\n\n      </script>`}async mount(e,t){let r={allowTransparency:!0,overflowTouch:!1,backgroundColor:t.layout.backgroundColor,width:'auto',height:0,pageUrl:'',startHeight:0};r.startHeight=t.layout.height?t.layout.height:t.title?50+t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin:t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin,this.createView(e,r)}createView(e,t){'body'===e||document.querySelector(e)}extend(e,t){for(var r in t)e[r]&&'object'==typeof e[r]?this.extend(e[r],t[r]):e[r]=t[r]}genKey(){for(var e='',t=0;t<5;t++)e+=Math.ceil(15*Math.random()).toString(16);return e}mountView(e,t,r){this.frameName='fXD'+this.genKey();let s=document.createElement('div');s.innerHTML='<iframe name="'+this.frameName+'" '+(r||'')+'></iframe>';let i=s.firstChild,o=this;return setTimeout((()=>{i.frameBorder='0',t&&o.extend(i,t),e.insertBefore(i,e.firstChild)}),0),i}get containerOptions(){return{style:{backgroundColor:'transparent',position:'relative',height:'100%',width:'100%'}}}get viewOptions(){this.frameName||(this.frameName='fXD'+this.genKey());let e={extraCss:null,extraJs:null},t={maxWidth:0,startHeight:70,storiesHeight:70,minWidth:150,scrolling:!1,hidden:!1};t.startHeight=e.storiesLayoutHeight?parseFloat(e.storiesLayoutHeight):e.storiesTitle?50+parseFloat(e.storiesHeight||t.storiesHeight)+parseFloat(e.storiesListTopPadding)+parseFloat(e.storiesListBottomPadding)+parseFloat(e.storiesListBottomMargin):parseFloat(e.storiesHeight||t.storiesHeight)+parseFloat(e.storiesListTopPadding)+parseFloat(e.storiesListBottomPadding)+parseFloat(e.storiesListBottomMargin);let r=parseInt('100%',10),s=r?Math.max(t.minWidth,Math.min(1e4,r))+'px':'100%';return Boolean(!0).toString(),-1!=s.indexOf('%')||parseInt(s),{style:{backgroundColor:'transparent',position:'absolute',left:0,right:0,top:0,height:"100%",width:'100%'},source:{html:this.widgetEntrypoint,baseUrl:'https://sdk.inappstory.com'},onMessage:this.rpcOnMessage}}createRpcServer(e){let t=new vi(e);this.rpcBridge=t.createOnMessage(),this.rpcServerInstance=$(ki,t)}destroyRpcServer(){this.rpcServerInstance&&this.rpcServerInstance.destructor()}async init(e,t){var r,s,i,o;let n={storiesHeight:(null===(r=t.card)||void 0===r?void 0:r.height)||70,storiesLayoutHeight:(null===(s=t.layout)||void 0===s?void 0:s.height)||0,storiesBackgroundColor:(null===(i=t.layout)||void 0===i?void 0:i.backgroundColor)||'transparent',storiesListTopPadding:t.topPadding||20,storiesListBottomPadding:t.bottomPadding||20,storiesListBottomMargin:t.bottomMargin||20,storiesTitle:(null===(o=t.title)||void 0===o?void 0:o.content)||'',extraCss:t.extraCss||null,extraJs:null},a={allowTransparency:!0,overflowTouch:!1};a.backgroundColor=n.storiesBackgroundColor;var l={startHeight:70,minWidth:150,storiesHeight:70};l.startHeight=n.storiesLayoutHeight?parseFloat(n.storiesLayoutHeight):n.storiesTitle?50+parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin):parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin),document.querySelector('body'),document.querySelector('html');let d=this,c={event:(e,t)=>{d.emit(e,t)}};return n.extraJs=null,a.no_finish_loading=!0,this._init(e,a,n,t,c,l,(()=>{}),null,null)}getWidgetDocument(e){let t=`${process.env.BASE_URL}/v0.2.27/dist/js/storiesList.js`;return t=Re,`\n        <script type="text/javascript" src="${t}"></script>\n        <div id="app"><div id="_app"></div></div>\n        <script type="text/javascript">\n          window.storyReader.init(${JSON.stringify(e)});\n        </script>\n`}async _init(e,t,s,i,o,n,a,l,d){o.event=(e,t)=>this.emit(e,t);let c=super._init(e,t,s,i,o,n,((e,t,r)=>{this.rpc=r}),l,d);return this.on('clickOnStory',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStory)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStory(e))})),this.on('clickOnStoryDeepLink',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryDeepLink)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryDeepLink(e))})),this.on('syncStore',(()=>{})),c}onStoryOpened(e){this.rpc.callMethod('onStoryOpened',e)}syncStoreHandle(e){this.rpc.callMethod('onSyncStore',e)}get sourceInfo(){return this._sourceInfo}openReader(e,t){this._sourceInfo=t,Ei(e)}closeConnectedReaderWidget(){Ii()}setStories(e){_i(e)}setFonts(e){Oi(e)}rpcCb(e){Hi(e)}destructor(){}}const Xi={title:{content:'Favorite',font:'1.4rem/1.2 InternalPrimaryFont',color:"white"}},Yi="FxDomainWidgetStoryFavorite",Qi=O(`server${Yi}`),eo=O(`client${Yi}`);let to={serverFxDomain:Qi,clientFxDomain:eo},ro=eo.effect(Yi+"setStories"),so=eo.effect(Yi+"setFonts"),io=eo.effect(Yi+"onOpenReader"),oo=eo.effect(Yi+"onCloseReader"),no=Qi.effect(Yi+"widgetLoaded"),ao=Qi.effect(Yi+"onReaderOpened"),lo=Qi.effect(Yi+"onReaderClosed"),co=Qi.effect(Yi+"widgetEvent"),uo=eo.effect(Yi+"widgetEventCb"),ho=Qi.effect(Yi+"clickOnStoryInternalEvent"),po=Qi.effect(Yi+"debug");class fo extends Zs{constructor(e){super(),this.appearanceManagerGetter=e,this.modalPresentation=void 0,this.openStoryFavoriteReaderWithOptions={},this.rpc=void 0,this.frameName='',this.rpcOnMessage=e=>{this.rpcBridge&&this.rpcBridge(e)},this.rpcBridge=null,this.rpcServerInstance=null,this._sourceInfo={listType:je.default,feed:null},this.modalPresentation=new Zi,this.widgetId=++Zs.count,no.use((()=>{this.emit("widgetLoaded")})),co.use((e=>{let{name:t,payload:r}=e;this.emit(t,r)})),ao.use((e=>{this.emit('openedStoryFavoriteReader',e)})),lo.use((e=>{this.emit('closeStoryFavoriteReader',e)})),ho.use((e=>{this.emit('clickOnStoryInternal',e)})),co.use((e=>{let{name:t,payload:r}=e;this.emit(t,r)})),po.use((e=>{console.log(e)}));let t=()=>this.modalPresentation.isWidgetConnected?(this.closeConnectedReaderWidget(),this.modalPresentation.modalClosed(),!0):!!this.modalPresentation.isOpen&&(this.emit("closeStoryFavoriteReader",this.openStoryFavoriteReaderWithOptions),!0);this.on('openStoryFavoriteReader',(e=>{this.modalPresentation.isOpen=!0,le.BackHandler.addEventListener("hardwareBackPress",t),this.openStoryFavoriteReaderWithOptions=e})),this.on('openedStoryFavoriteReader',(()=>{this.modalPresentation.isWidgetConnected=!0})),this.on('modalClosed',(()=>{le.BackHandler.removeEventListener("hardwareBackPress",t),this.modalPresentation.modalClosed()}))}get storyFavoriteReaderOptions(){let e=this.appearanceManagerGetter();return null!=e?{options:e.storyFavoriteReaderOptions,storiesListOptions:e.storiesListOptions}:{options:Xi,storiesListOptions:He}}get widgetSrcFile(){return _e}get widgetEntrypoint(){return`\n      <head>\n        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, shrink-to-fit=no">\n        <style type="text/css">${Oe}</style>\n      </head>\n      <div id="app"><div id="_app"></div></div>\n      <script type="text/javascript">${_e}</script>\n      <script type="text/javascript">\n        window.storiesList = (function () {\n          var self = window.storiesList || {};\n          self._e = self._e || [];\n          self.ready = self.ready || function (f) {self._e.push(f);};\n          return self;\n        }());\n\n        window.storyFavoriteReader.ready(function () {\n          window.storyFavoriteReader.init(${JSON.stringify(this.storyFavoriteReaderOptions)});\n          // options\n        });\n\n      </script>`}async mount(e,t){let r={allowTransparency:!0,overflowTouch:!1,backgroundColor:t.layout.backgroundColor,width:'auto',height:0,pageUrl:'',startHeight:0};r.startHeight=t.layout.height?t.layout.height:t.title?50+t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin:t.card.height+t.topPadding+t.bottomPadding+t.bottomMargin,this.createView(e,r)}createView(e,t){'body'===e||document.querySelector(e)}extend(e,t){for(var r in t)e[r]&&'object'==typeof e[r]?this.extend(e[r],t[r]):e[r]=t[r]}genKey(){for(var e='',t=0;t<5;t++)e+=Math.ceil(15*Math.random()).toString(16);return e}mountView(e,t,r){this.frameName='fXD'+this.genKey();let s=document.createElement('div');s.innerHTML='<iframe name="'+this.frameName+'" '+(r||'')+'></iframe>';let i=s.firstChild,o=this;return setTimeout((()=>{i.frameBorder='0',t&&o.extend(i,t),e.insertBefore(i,e.firstChild)}),0),i}get containerOptions(){return{style:{backgroundColor:'transparent',position:'relative',height:'100%',width:'100%'}}}get viewOptions(){this.frameName||(this.frameName='fXD'+this.genKey());let e={extraCss:null,extraJs:null},t={maxWidth:0,startHeight:70,storiesHeight:70,minWidth:150,scrolling:!1,hidden:!1};t.startHeight=e.storiesLayoutHeight?parseFloat(e.storiesLayoutHeight):e.storiesTitle?50+parseFloat(e.storiesHeight||t.storiesHeight)+parseFloat(e.storiesListTopPadding)+parseFloat(e.storiesListBottomPadding)+parseFloat(e.storiesListBottomMargin):parseFloat(e.storiesHeight||t.storiesHeight)+parseFloat(e.storiesListTopPadding)+parseFloat(e.storiesListBottomPadding)+parseFloat(e.storiesListBottomMargin);let r=parseInt('100%',10),s=r?Math.max(t.minWidth,Math.min(1e4,r))+'px':'100%';return Boolean(!0).toString(),-1!=s.indexOf('%')||parseInt(s),{style:{backgroundColor:'transparent',position:'absolute',left:0,right:0,top:0,height:"100%",width:'100%'},source:{html:this.widgetEntrypoint,baseUrl:'https://sdk.inappstory.com'},onMessage:this.rpcOnMessage}}createRpcServer(e){let t=new vi(e);this.rpcBridge=t.createOnMessage(),this.rpcServerInstance=$(to,t)}destroyRpcServer(){this.rpcServerInstance&&this.rpcServerInstance.destructor()}async init(e,t){var r,s,i,o;let n={storiesHeight:(null===(r=t.card)||void 0===r?void 0:r.height)||70,storiesLayoutHeight:(null===(s=t.layout)||void 0===s?void 0:s.height)||0,storiesBackgroundColor:(null===(i=t.layout)||void 0===i?void 0:i.backgroundColor)||'transparent',storiesListTopPadding:t.topPadding||20,storiesListBottomPadding:t.bottomPadding||20,storiesListBottomMargin:t.bottomMargin||20,storiesTitle:(null===(o=t.title)||void 0===o?void 0:o.content)||'',extraCss:t.extraCss||null,extraJs:null},a={allowTransparency:!0,overflowTouch:!1};a.backgroundColor=n.storiesBackgroundColor;var l={startHeight:70,minWidth:150,storiesHeight:70};l.startHeight=n.storiesLayoutHeight?parseFloat(n.storiesLayoutHeight):n.storiesTitle?50+parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin):parseFloat(n.storiesHeight||l.storiesHeight)+parseFloat(n.storiesListTopPadding)+parseFloat(n.storiesListBottomPadding)+parseFloat(n.storiesListBottomMargin),document.querySelector('body'),document.querySelector('html');let d=this,c={event:(e,t)=>{d.emit(e,t)}};return n.extraJs=null,a.no_finish_loading=!0,this._init(e,a,n,t,c,l,(()=>{}),null,null)}getWidgetDocument(e){let t=`${process.env.BASE_URL}/v0.2.27/dist/js/storiesList.js`;return t=_e,`\n        <script type="text/javascript" src="${t}"></script>\n        <div id="app"><div id="_app"></div></div>\n        <script type="text/javascript">\n          window.storyFavoriteReader.init(${JSON.stringify(e)});\n        </script>\n`}async _init(e,t,s,i,o,n,a,l,d){o.event=(e,t)=>this.emit(e,t);let c=super._init(e,t,s,i,o,n,((e,t,r)=>{this.rpc=r}),l,d);return this.on('clickOnStory',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStory)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStory(e))})),this.on('clickOnStoryDeepLink',(e=>{var t,s;r(null===(t=this.callbacks)||void 0===t?void 0:t.handleClickOnStoryDeepLink)&&(null===(s=this.callbacks)||void 0===s||s.handleClickOnStoryDeepLink(e))})),this.on('syncStore',(()=>{})),c}onStoryOpened(e){this.rpc.callMethod('onStoryOpened',e)}syncStoreHandle(e){this.rpc.callMethod('onSyncStore',e)}get sourceInfo(){return this._sourceInfo}openReader(e,t){this._sourceInfo=t,io(e)}closeConnectedReaderWidget(){oo()}setStories(e){ro(e)}setFonts(e){so(e)}rpcCb(e){uo(e)}destructor(){}}const go='android'===le.Platform.OS,mo="The package 'rn-android-keyboard-adjust' doesn't seem to be linked. Make sure: \n\n"+le.Platform.select({default:''})+"- You rebuilt the app after installing the package\n- You are not using Expo Go\n",yo=le.NativeModules.RnAndroidKeyboardAdjust?le.NativeModules.RnAndroidKeyboardAdjust:new Proxy({},{get(){throw new Error(mo)}});var vo={__proto__:null,setAdjustNothing:q,setAdjustPan:G,setAdjustResize:K,setAdjustUnspecified:J,setAlwaysHidden:Z,setAlwaysVisible:z,setVisible:X,setHidden:Y,setUnchanged:Q,getSoftInputMode:ee,setSoftInputMode:te,default:{setAdjustNothing:q,setAdjustPan:G,setAdjustResize:K,setAdjustUnspecified:J,setAlwaysHidden:Z,setAlwaysVisible:z,setVisible:X,setHidden:Y,setUnchanged:Q,getSoftInputMode:ee,setSoftInputMode:te}};let So,wo;(e=>{e.LEFT="left",e.RIGHT="right"})(So||(So={})),(e=>{e.FLAT="flat",e.COVER="cover",e.CUBE="cube"})(wo||(wo={}));const Lo={closeButtonPosition:So.RIGHT,scrollStyle:wo.FLAT,loader:{default:{color:"transparent",accentColor:"white"},custom:null},recycleStoriesList:!1,closeOnLastSlideByTimer:!0,faviconApiUrl:"",closeButton:{svgSrc:{baseState:"<svg width=\"15\" height=\"15\" viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M6.96425 7.4645L0.142822 0.650209L0.649965 0.143066L7.46425 6.9645L14.2857 0.143066L14.7928 0.650209L7.97139 7.4645L14.7928 14.2859L14.2857 14.7931L7.46425 7.97164L0.649965 14.7931L0.142822 14.2859L6.96425 7.4645Z\" fill=\"white\"/>\n</svg>"}},likeButton:{svgSrc:{baseState:"<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M24.6527 13.0592C24.4045 13.5792 24.109 13.8392 23.7427 13.851C23.9402 14.0899 24.085 14.3678 24.1681 14.6664C24.2754 14.9702 24.3315 15.2897 24.3336 15.6119C24.3348 15.9936 24.2566 16.3714 24.1041 16.7214C23.9515 17.0713 23.7278 17.3858 23.4472 17.6446C23.6473 18.006 23.7492 18.4135 23.7427 18.8264C23.742 19.2612 23.6408 19.6899 23.4472 20.0792C23.2852 20.4586 23.0029 20.7743 22.6436 20.9773C22.6984 21.2896 22.7261 21.6058 22.7263 21.9228C22.7263 23.8255 21.6509 24.771 19.4763 24.771H17.4318C15.451 24.6867 13.4962 24.2878 11.6409 23.5892L11.1563 23.4001L10.5536 23.1873L9.96267 22.9864L9.31267 22.7973L8.75722 22.691C8.58024 22.6764 8.40238 22.6764 8.2254 22.691H7.68176V11.6764H8.27267C8.46193 11.6776 8.64992 11.6456 8.82813 11.5819C9.05683 11.4341 9.2671 11.2595 9.45449 11.0619C9.69085 10.861 9.90358 10.6483 10.1045 10.4592C10.3422 10.2191 10.5671 9.9666 10.7781 9.7028L11.369 8.98189L11.9009 8.28462L12.2909 7.76462C12.9054 6.99644 13.3427 6.47644 13.5909 6.21644C14.0779 5.68876 14.4234 5.04639 14.5954 4.34917C14.8081 3.5928 14.9854 2.88371 15.1154 2.21008C15.1935 1.67828 15.4185 1.17889 15.7654 0.768253C16.1631 0.714621 16.5679 0.758694 16.9447 0.896661C17.3215 1.03463 17.659 1.26233 17.9281 1.56008C18.3401 2.31941 18.5286 3.17988 18.4718 4.04189C18.4115 4.993 18.1581 5.92186 17.7272 6.77189C17.272 7.61247 16.9944 8.5377 16.9118 9.49008H22.8209C23.3921 9.51353 23.9334 9.75175 24.3365 10.1571C24.7398 10.5625 24.9751 11.1051 24.9954 11.6764C24.9759 12.1558 24.8593 12.6261 24.6527 13.0592Z\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n<path d=\"M5.90904 11.8184H1.18176V22.4547H5.90904V11.8184Z\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n</svg>",activeState:"<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M24.6527 13.0592C24.4045 13.5792 24.109 13.8392 23.7427 13.851C23.9402 14.0899 24.085 14.3678 24.1681 14.6664C24.2754 14.9702 24.3315 15.2897 24.3336 15.6119C24.3348 15.9936 24.2566 16.3714 24.1041 16.7214C23.9515 17.0713 23.7278 17.3858 23.4472 17.6446C23.6473 18.006 23.7492 18.4135 23.7427 18.8264C23.742 19.2612 23.6408 19.6899 23.4472 20.0792C23.2852 20.4586 23.0029 20.7743 22.6436 20.9773C22.6984 21.2896 22.7261 21.6058 22.7263 21.9228C22.7263 23.8255 21.6509 24.771 19.4763 24.771H17.4318C15.451 24.6867 13.4962 24.2878 11.6409 23.5892L11.1563 23.4001L10.5536 23.1873L9.96267 22.9864L9.31267 22.7973L8.75722 22.691C8.58024 22.6764 8.40238 22.6764 8.2254 22.691H7.68176V11.6764H8.27267C8.46193 11.6776 8.64992 11.6456 8.82813 11.5819C9.05683 11.4341 9.2671 11.2595 9.45449 11.0619C9.69085 10.861 9.90358 10.6483 10.1045 10.4592C10.3422 10.2191 10.5671 9.9666 10.7781 9.7028L11.369 8.98189L11.9009 8.28462L12.2909 7.76462C12.9054 6.99644 13.3427 6.47644 13.5909 6.21644C14.0779 5.68876 14.4234 5.04639 14.5954 4.34917C14.8081 3.5928 14.9854 2.88371 15.1154 2.21008C15.1935 1.67828 15.4185 1.17889 15.7654 0.768253C16.1631 0.714621 16.5679 0.758694 16.9447 0.896661C17.3215 1.03463 17.659 1.26233 17.9281 1.56008C18.3401 2.31941 18.5286 3.17988 18.4718 4.04189C18.4115 4.993 18.1581 5.92186 17.7272 6.77189C17.272 7.61247 16.9944 8.5377 16.9118 9.49008H22.8209C23.3921 9.51353 23.9334 9.75175 24.3365 10.1571C24.7398 10.5625 24.9751 11.1051 24.9954 11.6764C24.9759 12.1558 24.8593 12.6261 24.6527 13.0592Z\" fill=\"white\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n<path d=\"M5.90904 11.8184H1.18176V22.4547H5.90904V11.8184Z\" fill=\"white\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n</svg>"}},dislikeButton:{svgSrc:{baseState:"<svg width=\"27\" height=\"26\" viewBox=\"0 0 27 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M1.95728 12.9407C2.20547 12.4207 2.50092 12.1607 2.86728 12.1489C2.67612 11.9058 2.53186 11.6293 2.44183 11.3334C2.34019 11.0282 2.28443 10.7096 2.27637 10.388C2.27385 10.0067 2.35266 9.62916 2.50754 9.28068C2.66242 8.9322 2.88981 8.62075 3.17456 8.36709C2.96718 8.00817 2.86098 7.59974 2.86728 7.18527C2.86805 6.75051 2.96916 6.32181 3.16274 5.93254C3.31795 5.55004 3.59121 5.22709 3.94274 5.01072C3.91641 4.70402 3.91641 4.39561 3.94274 4.0889C3.94274 2.18618 5.01819 1.24072 7.19274 1.24072H9.17819C11.159 1.32494 13.1138 1.72386 14.9691 2.42254L15.4655 2.59981L16.0564 2.81254L16.6591 3.01345L17.2973 3.20254L17.8527 3.3089C18.0297 3.32349 18.2075 3.32349 18.3846 3.3089H18.9282V14.2171H18.3846C18.1756 14.2289 17.9709 14.281 17.7818 14.3707C17.5397 14.497 17.3136 14.6517 17.1082 14.8316L16.4582 15.4344C16.2205 15.6744 15.9956 15.927 15.7846 16.1907L15.1937 16.9116L14.6618 17.6089L14.2718 18.1289C13.6573 18.8971 13.22 19.4171 12.9718 19.6771C12.4848 20.2048 12.1392 20.8471 11.9673 21.5444C11.7546 22.3007 11.5773 23.0098 11.4473 23.6835C11.3757 24.2149 11.1544 24.715 10.8091 25.1253C10.4238 25.1872 10.0292 25.1575 9.65757 25.0384C9.28589 24.9193 8.94755 24.7142 8.67001 24.4398C8.25902 23.6844 8.07052 22.8279 8.12637 21.9698C8.19097 21 8.4566 20.0542 8.90637 19.1926C9.36165 18.3519 9.63922 17.4267 9.72183 16.4744H3.81274C3.5291 16.4711 3.24901 16.4108 2.98914 16.2971C2.72926 16.1834 2.4949 16.0187 2.30001 15.8126C2.08491 15.6264 1.91004 15.3983 1.78609 15.1423C1.66213 14.8862 1.5917 14.6076 1.5791 14.3235C1.6097 13.8416 1.73839 13.371 1.95728 12.9407Z\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n<path d=\"M25.4282 3.54541H20.7009V14.1818H25.4282V3.54541Z\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n</svg>",activeState:"<svg width=\"27\" height=\"26\" viewBox=\"0 0 27 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M1.95728 12.9407C2.20547 12.4207 2.50092 12.1607 2.86728 12.1489C2.67612 11.9058 2.53186 11.6293 2.44183 11.3334C2.34019 11.0282 2.28443 10.7096 2.27637 10.388C2.27385 10.0067 2.35266 9.62916 2.50754 9.28068C2.66242 8.9322 2.88981 8.62075 3.17456 8.36709C2.96718 8.00817 2.86098 7.59974 2.86728 7.18527C2.86805 6.75051 2.96916 6.32181 3.16274 5.93254C3.31795 5.55004 3.59121 5.22709 3.94274 5.01072C3.91641 4.70402 3.91641 4.39561 3.94274 4.0889C3.94274 2.18618 5.01819 1.24072 7.19274 1.24072H9.17819C11.159 1.32494 13.1138 1.72386 14.9691 2.42254L15.4655 2.59981L16.0564 2.81254L16.6591 3.01345L17.2973 3.20254L17.8527 3.3089C18.0297 3.32349 18.2075 3.32349 18.3846 3.3089H18.9282V14.2171H18.3846C18.1756 14.2289 17.9709 14.281 17.7818 14.3707C17.5397 14.497 17.3136 14.6517 17.1082 14.8316L16.4582 15.4344C16.2205 15.6744 15.9956 15.927 15.7846 16.1907L15.1937 16.9116L14.6618 17.6089L14.2718 18.1289C13.6573 18.8971 13.22 19.4171 12.9718 19.6771C12.4848 20.2048 12.1392 20.8471 11.9673 21.5444C11.7546 22.3007 11.5773 23.0098 11.4473 23.6835C11.3757 24.2149 11.1544 24.715 10.8091 25.1253C10.4238 25.1872 10.0292 25.1575 9.65757 25.0384C9.28589 24.9193 8.94755 24.7142 8.67001 24.4398C8.25902 23.6844 8.07052 22.8279 8.12637 21.9698C8.19097 21 8.4566 20.0542 8.90637 19.1926C9.36165 18.3519 9.63922 17.4267 9.72183 16.4744H3.81274C3.5291 16.4711 3.24901 16.4108 2.98914 16.2971C2.72926 16.1834 2.4949 16.0187 2.30001 15.8126C2.08491 15.6264 1.91004 15.3983 1.78609 15.1423C1.66213 14.8862 1.5917 14.6076 1.5791 14.3235C1.6097 13.8416 1.73839 13.371 1.95728 12.9407Z\" fill=\"white\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n<path d=\"M25.4282 3.54541H20.7009V14.1818H25.4282V3.54541Z\" fill=\"white\" stroke=\"white\" stroke-width=\"1.18182\" stroke-miterlimit=\"10\"/>\n</svg>"}},favoriteButton:{svgSrc:{baseState:"<svg width=\"22\" height=\"26\" viewBox=\"0 0 22 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M17.66 3.81982H4.81116C4.25887 3.81982 3.81116 4.26754 3.81116 4.81982V21.2171C3.81116 22.062 4.83134 22.4865 5.4307 21.8911L11.24 16.1198L17.0401 21.8888C17.6393 22.4847 18.66 22.0603 18.66 21.2152L18.66 4.81983C18.66 4.26754 18.2123 3.81982 17.66 3.81982Z\" stroke=\"white\"/></svg>",activeState:"<svg width=\"22\" height=\"26\" viewBox=\"0 0 22 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M17.66 3.81982H4.81116C4.25887 3.81982 3.81116 4.26754 3.81116 4.81982V21.2171C3.81116 22.062 4.83134 22.4865 5.4307 21.8911L11.24 16.1198L17.0401 21.8888C17.6393 22.4847 18.66 22.0603 18.66 21.2152L18.66 4.81983C18.66 4.26754 18.2123 3.81982 17.66 3.81982Z\" fill=\"white\" stroke=\"white\"/></svg>"}},muteButton:{svgSrc:{baseState:"<svg width=\"22\" height=\"26\" viewBox=\"0 0 22 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M14.2206 22.3918C14.0256 22.3451 12.4651 21.4429 10.7096 20.3773L7.54973 18.456H5.50554H3.46136L3.2429 18.2693L3.02444 18.0827L3.00883 12.8401C2.98543 7.36426 2.98542 7.35648 3.31312 7.14646C3.43015 7.07646 3.55499 7.16202 4.09334 7.7065C4.69411 8.29764 4.72532 8.34431 4.52246 8.34431H4.3118V12.739V17.1337H5.67719H7.04258V13.8902V10.6389L11.8878 15.4614L16.733 20.2839L16.6939 20.6806C16.5769 21.8707 15.3598 22.7107 14.2206 22.3918Z\" fill=\"white\"/>\n<path d=\"M11.1933 13.3847C5.39627 7.59765 3.89824 6.07312 3.82802 5.83977C3.65637 5.2564 4.24934 4.60303 4.86571 4.7197C5.09198 4.75859 6.23891 5.87088 12.4495 12.0624L19.7602 19.3506V19.7317C19.7602 20.0507 19.7212 20.144 19.4949 20.3696C19.2686 20.5951 19.175 20.634 18.8551 20.634H18.4728L11.1933 13.3847Z\" fill=\"white\"/>\n<path d=\"M12.5196 10.6545L8.35327 6.50095L9.00866 6.11204C9.36756 5.90203 10.6471 5.1242 11.8564 4.40083C13.6587 3.30409 14.1191 3.06297 14.4468 3.0163C15.2894 2.89962 16.2101 3.42077 16.5534 4.21415C16.7172 4.60306 16.7172 4.63417 16.7016 9.70559L16.6782 14.8003L12.5196 10.6545Z\" fill=\"white\"/>\n</svg>",activeState:"<svg width=\"22\" height=\"26\" viewBox=\"0 0 22 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M12.0512 22.4247C11.886 22.3646 10.1891 21.4561 8.28942 20.3974L4.83549 18.4677H2.59795H0.367918L0.187713 18.28L0 18.0998V12.7687V7.44518L0.232764 7.24996L0.465529 7.05474H2.67304H4.88805L8.13174 5.23767C9.91877 4.24655 11.5556 3.34552 11.7809 3.24041C12.8246 2.75986 14.1311 3.19535 14.6567 4.19399L14.8669 4.59194V12.7612C14.8669 21.8616 14.9044 21.1858 14.3338 21.809C13.8082 22.3796 12.772 22.6575 12.0512 22.4247ZM13.0874 21.0807C13.4478 20.893 13.4328 21.2233 13.4403 12.7762V4.78716L13.215 4.56191C12.8171 4.16395 12.7195 4.2015 9.07031 6.23631L5.78908 8.06839L5.78157 12.7687V17.4616L9.10034 19.3162C12.5242 21.2308 12.6819 21.2984 13.0874 21.0807ZM4.35495 12.7612V8.33119H2.89078H1.42662V12.7612V17.1912H2.89078H4.35495V12.7612Z\" fill=\"white\"/>\n<path d=\"M19.3045 16.5456C18.9516 16.2528 18.9891 15.9975 19.4471 15.4794C20.1304 14.7135 20.4683 13.9552 20.5434 13.0241C20.626 12.018 20.2355 10.9443 19.4847 10.1333C19.0116 9.61525 18.9591 9.36747 19.2519 9.02958C19.4021 8.85689 19.4922 8.81934 19.785 8.81934C20.1304 8.81934 20.1604 8.84187 20.626 9.33743C21.2041 9.96064 21.7222 10.9593 21.8949 11.7852C22.2328 13.3845 21.6321 15.2767 20.4382 16.3879C19.9727 16.8159 19.6724 16.8535 19.3045 16.5456Z\" fill=\"white\"/>\n<path d=\"M17.2246 14.6384C17.0218 14.5558 16.8191 14.278 16.8191 14.0753C16.8191 13.9927 16.9317 13.7599 17.0744 13.5647C17.5174 12.9415 17.5174 12.5285 17.0744 12.0029C16.9317 11.8377 16.8191 11.635 16.8191 11.5599C16.8191 11.0869 17.3071 10.734 17.7577 10.8841C18.0655 10.9817 18.4334 11.3872 18.6512 11.8527C18.8914 12.3859 18.8689 13.1968 18.5986 13.7524C18.2232 14.5108 17.7201 14.8411 17.2246 14.6384Z\" fill=\"white\"/>\n</svg>"}},shareButton:{svgSrc:{baseState:"<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M14.7727 4.84545C14.7727 5.43636 14.8909 6.02727 15.0091 6.5L8.98182 9.92727C8.03636 8.86364 6.61818 8.15455 5.08182 8.15455C2.36364 8.03636 0 10.2818 0 13C0 15.7182 2.24545 17.8455 5.08182 17.8455C6.61818 17.8455 8.03636 17.1364 8.98182 16.0727L15.0091 19.3818C14.7727 19.8545 14.7727 20.4455 14.7727 21.0364C14.7727 23.7545 17.0182 25.8818 19.8545 25.8818C22.6909 25.8818 24.9364 23.6364 24.9364 21.0364C24.9364 18.3182 22.6909 16.0727 19.8545 16.0727C18.3182 16.0727 16.9 16.7818 15.9545 17.8455L9.92727 14.5364C10.0455 14.1818 10.1636 13.5909 10.1636 13C10.1636 12.4091 10.0455 11.8182 9.92727 11.3455L15.9545 8.03636C16.9 9.1 18.3182 9.80909 19.8545 9.80909C22.6909 9.80909 24.9364 7.56364 24.9364 4.84545C24.9364 2.12727 22.6909 0 19.8545 0C17.0182 0 14.7727 2.24545 14.7727 4.84545ZM5.08182 16.1909C3.30909 16.1909 1.77273 14.7727 1.77273 13C1.77273 11.2273 3.30909 9.80909 5.08182 9.80909C6.85455 9.80909 8.39091 11.2273 8.39091 13C8.39091 14.7727 6.97273 16.1909 5.08182 16.1909ZM19.8545 17.8455C21.6273 17.8455 23.1636 19.2636 23.1636 21.0364C23.1636 22.8091 21.6273 24.2273 19.8545 24.2273C18.0818 24.2273 16.5455 22.8091 16.5455 21.0364C16.5455 19.3818 18.0818 17.8455 19.8545 17.8455ZM19.8545 1.77273C21.6273 1.77273 23.1636 3.19091 23.1636 4.96364C23.1636 6.73636 21.6273 8.15455 19.8545 8.15455C18.0818 8.15455 16.5455 6.73636 16.5455 4.96364C16.5455 3.19091 18.0818 1.77273 19.8545 1.77273Z\" fill=\"white\"/>\n</svg>"}}},Co={title:{content:'\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u0438'}};let bo;(e=>{e.DEFAULT="default",e.CUSTOM_CARD="customCard",e.CUSTOM_WIDGET="customWidget"})(bo||(bo={}));const Ro={goodsWidgetRenderingType:bo.DEFAULT,loader:{default:{color:null,accentColor:null},custom:null}};var ko=e=>(e=>!!e&&'object'==typeof e)(e)&&!(e=>{var t={}.toString.call(e);return'[object RegExp]'===t||'[object Date]'===t||(e=>e.$$typeof===_o)(e)})(e),_o='function'==typeof Symbol&&Symbol.for?Symbol.for('react.element'):60103;ne.all=(e,t)=>{if(!Array.isArray(e))throw new Error('first argument should be an array');return e.reduce(((e,r)=>ne(e,r,t)),{})};var Oo=ne;let Eo='undefined'!=typeof window?ve.useLayoutEffect:ve.useEffect;const Io=b(),Po=R({storyManager:null,appearanceManager:null}).on(Io,((e,t)=>t));var Ao;exports.AndroidWindowSoftInputMode=void 0,(Ao=exports.AndroidWindowSoftInputMode||(exports.AndroidWindowSoftInputMode={})).AdjustNothing="AdjustNothing",Ao.AdjustPan="AdjustPan",Ao.AdjustResize="AdjustResize",Ao.AdjustUnspecified="AdjustUnspecified",Ao.AlwaysHidden="AlwaysHidden",Ao.AlwaysVisible="AlwaysVisible",Ao.Visible="Visible",Ao.Hidden="Hidden",Ao.Unchanged="Unchanged",exports.AppearanceManager=class{constructor(){this._commonOptions=Li,this._storiesListOptions=He,this._storyReaderOptions=Lo,this._storyFavoriteReaderOptions=Co,this._goodsWidgetOptions=Ro}setCommonOptions(e){return this._commonOptions=Oo(this._commonOptions,e),this}get commonOptions(){return this._commonOptions}setStoriesListOptions(e){return this._storiesListOptions=Oo(this._storiesListOptions,e),this}get storiesListOptions(){return this._storiesListOptions}setStoryReaderOptions(e){return this._storyReaderOptions=Oo(this._storyReaderOptions,e),this}get storyReaderOptions(){return this._storyReaderOptions}setStoryFavoriteReaderOptions(e){return this._storyFavoriteReaderOptions=Oo(this._storyFavoriteReaderOptions,e),this}get storyFavoriteReaderOptions(){return this._storyFavoriteReaderOptions}setGoodsWidgetOptions(e){return this._goodsWidgetOptions=Oo(this._goodsWidgetOptions,e),this}get goodsWidgetOptions(){return this._goodsWidgetOptions}},exports.StoriesList=e=>{let{storyManager:t,appearanceManager:s,feed:i,onLoadEnd:o,testKey:n}=e,[a,l]=ae.useState(null);ae.useEffect((()=>{if(null!=t&&null!=s){let e=t.createWidgetStoriesList(s,i,n);e.on(exports.StoriesListEvents.END_LOADER,(e=>{o&&r(o)&&o(e)})),l(e),t.loadStoriesListData(e,s)}return()=>{a&&a.destructor()}}),[]);let d=ae.useCallback((e=>{null!=e&&null!=a&&(null==a||a.createRpcServer(e))}),[a]),[c,u]=ae.useState(!1),h=ae.useRef({dx:0,dy:0}).current,p=ae.useRef(le.PanResponder.create({onPanResponderTerminationRequest:()=>!0,onPanResponderReject(){h.dx=h.dy=0},onPanResponderRelease(){h.dx=h.dy=0},onPanResponderTerminate(){h.dx=h.dy=0},onPanResponderEnd(){h.dx=h.dy=0},onMoveShouldSetPanResponder:(e,t)=>{if(Math.abs(t.dx)>Math.abs(t.dy)&&Math.abs(t.vx)>Math.abs(t.vy))return h.dx=h.dy=0,!0;h.dx=h.dx+Math.abs(t.dx),h.dy=h.dy+Math.abs(t.dy);let r=h.dx>=15||h.dy>=15,s=Math.abs(h.dx)>=Math.abs(h.dy)&&r;return!s&&r&&(h.dx=h.dy=0),s},onShouldBlockNativeResponder:()=>!0})).current;return ve.createElement(ve.Fragment,null,a&&ve.createElement(le.View,Object.assign({},null==a?void 0:a.containerOptions,{onLayout:e=>{var t;let{nativeEvent:r}=e;null!=r&&null!==(t=r.layout)&&void 0!==t&&t.width?u(!0):u(!1)}}),c&&ve.createElement(Ie,Object.assign({scrollEnabled:!1,bounces:!1,showsVerticalScrollIndicator:!1,showsHorizontalScrollIndicator:!1,overScrollMode:"never",nestedScrollEnabled:!1},null==a?void 0:a.viewOptions,{ref:d},'android'===le.Platform.OS?p.panHandlers:{}))))},exports.StoryManager=class extends Gs{constructor(e,t){super(e,t),this.on("openStoryReader",(()=>{le.StatusBar.setHidden(!0),"android"===this.getDevicePlatform()&&ee((e=>{this._innerAndroidDefaultWindowSoftInputIntegerMode=e,q()}))})),this.on("openStoryFavoriteReader",(()=>{le.StatusBar.setHidden(!0)}))}createWidgetStoriesList(e,t,r){let s=new Si(e,t,r);return this.appearanceManager=e,s.on("widgetLoaded",(()=>{this._storiesListWidgetLoaded(s,e)})),s}loadStoriesListData(e,t){this._loadStoriesListData(e,t)}createWidgetStoryReader(e,t,r){let s=new zi((()=>this.appearanceManager));return this.storyReaderNeedFirstRender=e,this.storyReaderNeedLoaderRender=t,this.storyReaderDetachComponent=r,s.on("widgetLoaded",(()=>{this._storyReaderWidgetLoaded(s)})),s}createWidgetStoryFavoriteReader(e,t,r){let s=new fo((()=>this.appearanceManager));return this.storyFavoriteReaderNeedFirstRender=e,this.storyFavoriteReaderNeedLoaderRender=t,this.storyFavoriteReaderDetachComponent=r,s.on("widgetLoaded",(()=>{this._storyFavoriteReaderWidgetLoaded(s)})),s}getDeviceInfo(e){return new Promise((async e=>{let t=Promise.resolve(Ce.getUniqueId());e({device_id:await t,platform:this.getDevicePlatform()})}))}getDevicePlatform(){return"Android"===Ce.getSystemName()?"android":"ios"}getDeviceInformation(){return new Promise((async e=>{let t={sdkVersion:"",applicationBundleId:"",deviceId:"",applicationVersion:"",applicationVersionCode:"",userAgent:""},r=Promise.resolve(Ce.getUniqueId());t.sdkVersion="0.2.27",t.applicationBundleId=Ce.getBundleId(),t.deviceId=await r,t.applicationVersion=Ce.getVersion(),t.applicationVersionCode=Ce.getBuildNumber(),Ce.getUserAgent().then((r=>{t.userAgent=`InAppStoryRNSDK/227 ${r} Application/${t.applicationVersionCode} (${t.applicationBundleId} ${t.applicationVersion})`,e(t)}))}))}async localStorageGet(e){try{let t=await be.getItem(e);return null!=t?JSON.parse(t):null}catch(e){return console.error(e),null}}async localStorageSet(e,t){try{return void await be.setItem(e,JSON.stringify(t))}catch(e){return void console.error(e)}}async localStorageGetArray(e){return this.localStorageGet(e)}async localStorageSetArray(e,t){return this.localStorageSet(e,t)}completeInitStoryReader(e,t,s){return void 0===s&&(s={}),e.on('clickOnButton',(e=>{if(r(this._callbacks.storyLinkClickHandler)||this.listenerCount(Ue.CLICK_ON_STORY)>0){let t={src:'storyReader',srcRef:'default',data:e};try{r(this._callbacks.storyLinkClickHandler)&&this._callbacks.storyLinkClickHandler(t),this.emit(Ue.CLICK_ON_STORY,t)}catch(e){console.error(e)}}else le.Linking.openURL(e.url)})),e.on('closeStoryReader',(e=>{le.InteractionManager.runAfterInteractions((()=>{"android"===this.getDevicePlatform()&&(null!=this._androidDefaultWindowSoftInputMode&&null!=vo[`set${this._androidDefaultWindowSoftInputMode}`]?vo[`set${this._androidDefaultWindowSoftInputMode}`]():null!=this._innerAndroidDefaultWindowSoftInputIntegerMode&&te(this._innerAndroidDefaultWindowSoftInputIntegerMode))})),e.windowReferer!==We.favorite&&le.InteractionManager.runAfterInteractions((()=>{le.StatusBar.setHidden(!1)}))})),super.completeInitStoryReader(e,t,s)}completeInitStoryFavoriteReader(e,t){return e.on('closeStoryFavoriteReader',(()=>{le.InteractionManager.runAfterInteractions((()=>{le.StatusBar.setHidden(!1)}))})),super.completeInitStoryFavoriteReader(e,t)}},exports.StoryReader=e=>{let{storyManager:t}=e;return ve.createElement(ve.Fragment,null,ve.createElement(i,{storyManager:t}),ve.createElement(s,{storyManager:t}))},exports.useIas=(e,t)=>{let r=(e=>{et.store(e)||(()=>{throw Error('expect useStore argument to be a store')})();let t=e.getState(),r=ve.useReducer((e=>e+1),0)[1],s=ve.useRef({store:e,value:t,pending:0});return Eo((()=>{let t=e.updates.watch((e=>{let t=s.current;t.pending||(t.value=e,t.pending=1,r(),t.pending=0)})),i=e.getState(),o=s.current;return o.store===e&&o.value!==i&&(o.value=i,o.pending=1,r(),o.pending=0),o.store=e,t}),[e]),t})(Po);return(()=>{let s=ae.useRef(!0);s.current&&(null!=r.storyManager&&null!=r.appearanceManager||Io({storyManager:e(),appearanceManager:t()}),s.current=!1)})(),r};
//# sourceMappingURL=react-native-ias.cjs.js.map
